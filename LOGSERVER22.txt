 * Serving Flask app 'server'
 * Debug mode: on
Recuperati 20 tenant dalla tabella TAG.tenants
Recuperati 20 tenant dalla tabella TAG.tenants
Connesso a MongoDB database: classificazioni
🎯 TRAINING SUPERVISIONATO - Cliente: alleanza
📋 Parametri utente semplificati:
  � Max sessioni review: 500
  🎯 Soglia confidenza: 0.7
  🔄 Forza review: False
  ⚖️  Soglia disagreement: 0.3
🔧 Inizializzazione pipeline per cliente: alleanza (con lock)
🔧 Inizializzazione embedder condiviso (con lock)...
🚀 Inizializzazione LaBSE embedder su device: cuda
📥 Caricamento modello sentence-transformers/LaBSE...
🚀 Caricamento diretto su GPU...
✅ Modello caricato con successo!
📊 Dimensione embedding: 768
🔧 Device: cuda
🎮 GPU: NVIDIA A10G
💾 GPU Memory: 23.7 GB
📈 GPU Memory utilizzata: 1.89 GB
� Primo parametro su device: cuda:0
🧪 Test del modello LaBSE...
🔍 Encoding 3 testi su device cuda...
✅ Embedding generati: shape (3, 768)
✅ Test modello completato con successo!
   Shape: (3, 768)
   Norme: [0.99999994 1.         1.        ]
   Device: cuda
🎯 Modello pronto per l'uso!
✅ Embedder condiviso inizializzato
🚀 Inizializzazione pipeline...
   🎯 Confidence threshold: 0.7
   🤖 Auto mode: True
   🔄 Auto retrain: False
🔄 Utilizzo embedder condiviso per evitare CUDA out of memory
🔧 HDBSCANClusterer inizializzato con parametri:
   min_cluster_size: 3
   min_samples: 2
   metric: cosine
   cluster_selection_epsilon: 0.05
🧠 Inizializzazione memoria semantica...
🧠 SemanticMemoryManager inizializzato
  🎯 Soglia riutilizzo etichette: 0.8
  🔍 Soglia similarità semantica: 0.8
  💾 Cache path: semantic_cache/alleanza_a0fd7600_memory
🔗 Inizializzazione ensemble classifier avanzato...
🔍 ML Ensemble Debugger inizializzato e ATTIVO
   📝 Debug file: ./debug_logs/ml_debug.log
🔍 ML Ensemble Debugger attivato
🔧 Tentativo di inizializzazione IntelligentClassifier...
🧠 GPU Memory prima di LLM: 1.8GB/22.1GB (free: 20.3GB)
✅ Memoria GPU sufficiente, inizializzazione LLM...
🎯 Uso modello default: mistral:7b
🔍 LLM Debugger inizializzato e ATTIVO
   📝 Debug file: ./debug_logs/llm_debug.log
   🎨 Visual formatting: True
🔍 LLM Debugger attivato per IntelligentClassifier
🗄️ MySQL connector inizializzato per TAG.tags
🗄️ MongoDB connector inizializzato
🎯 BERTopic provider inizializzato per sistema di fallback intelligente
⚠️ Nessuna etichetta trovata in TAG.tags - Prima esecuzione
🤖 LLM classifier creato automaticamente nell'ensemble
💡 Possibile fine-tuning per alleanza
🔗 Advanced Ensemble Classifier inizializzato
   🧠 LLM weight: 0.60
   🤖 ML weight: 0.40
   🎯 Confidence threshold: 0.7
   🔄 Adaptive weights: True
   👤 Disaccordi gestiti da QualityGateEngine
📥 Caricamento ultimo modello per alleanza: alleanza_a0fd7600_classifier_20250822_232108
📥 Caricamento ensemble model...
✅ ML ensemble caricato
✅ Configurazione caricata
🔗 Ensemble model caricato da models/alleanza_a0fd7600_classifier_20250822_232108
✅ Modello caricato con successo

🔍 VERIFICA BERTOPIC LOADING:
   📋 BERTopic enabled: True
   📋 BERTopic available: True
   📁 Provider directory: models/alleanza_a0fd7600_classifier_20250822_232108_bertopic
   📁 Directory exists: False
⚠️ Directory BERTopic provider non trovata: models/alleanza_a0fd7600_classifier_20250822_232108_bertopic
⏸️ Riaddestramento automatico disabilitato (modalità supervisione/API)
   💡 Per abilitare, usare auto_retrain=True nell'inizializzazione
✅ Classificatore LLM disponibile nell'ensemble
👤 Inizializzazione trainer interattivo...
🚀 Inizializzazione LaBSE embedder su device: cuda
📥 Caricamento modello sentence-transformers/LaBSE...
🚀 Caricamento diretto su GPU...
✅ Modello caricato con successo!
📊 Dimensione embedding: 768
🔧 Device: cuda
🎮 GPU: NVIDIA A10G
💾 GPU Memory: 23.7 GB
📈 GPU Memory utilizzata: 3.78 GB
� Primo parametro su device: cuda:0
🧪 Test del modello LaBSE...
🔍 Encoding 3 testi su device cuda...
✅ Embedding generati: shape (3, 768)
✅ Test modello completato con successo!
   Shape: (3, 768)
   Norme: [0.99999994 1.         1.        ]
   Device: cuda
🎯 Modello pronto per l'uso!
🧠 Inizializzazione dedupplicatore intelligente...
🔄 Caricamento memoria semantica dal database...
Connessione al database TAG stabilita con successo
📭 Nessuna classificazione trovata nel database
📭 Inizializzata memoria semantica vuota
Connessione al database TAG chiusa
✅ Memoria semantica caricata: 0 campioni, 0 tag
✅ Pipeline inizializzata!
✅ Pipeline alleanza inizializzata
🚀 TRAINING SUPERVISIONATO CON DATASET COMPLETO
  📊 Estrazione: TUTTE le discussioni dal database
  🧩 Clustering: Su tutto il dataset disponibile
  👤 Review umana: Max 500 sessioni rappresentative
🎓 TRAINING SUPERVISIONATO AVANZATO
� NUOVA LOGICA:
  🔄 Estrazione: TUTTE le discussioni dal database
  🧩 Clustering: Su tutto il dataset completo
  👤 Review umana: Massimo 500 sessioni rappresentative
--------------------------------------------------
📊 FASE 1: ESTRAZIONE COMPLETA DATASET
📊 Estrazione sessioni per alleanza...
🔄 MODALITÀ ESTRAZIONE COMPLETA ATTIVATA
� Ignorando limite sessioni - estrazione di TUTTO il dataset
�🔍 Parametri: giorni_indietro=7, limit_originale=None, limit_effettivo=None
📊 Modalità estrazione: COMPLETA
🔄 Chiamata aggregator.estrai_sessioni_aggregate...
📊 Estrazione sessioni aggregate dal schema 'alleanza'...
🔍 Esecuzione query per leggere conversazioni dal schema 'alleanza'...
Connessione al database MySQL stabilita con successo
✅ Query eseguita con successo! Trovate 239 righe
✅ Trovate 239 righe da aggregare
✅ Aggregate 34 sessioni uniche
🔄 Saltati 68 messaggi di benvenuto (primi 2 per sessione)
🔄 Sessioni vuote (solo benvenuto): 16
📥 Sessioni grezze estratte: 34
🔍 Filtraggio sessioni vuote/irrilevanti...
🔍 Filtraggio sessioni vuote/irrilevanti...
✅ Filtro completato:
  📊 Sessioni originali: 34
  ❌ Sessioni scartate: 16
  ✅ Sessioni valide: 18
✅ ESTRAZIONE COMPLETA: 18 sessioni totali dal database
🎯 Tutte le discussioni disponibili sono state estratte per clustering completo
✅ Dataset completo: 18 sessioni totali

📊 FASE 2: CLUSTERING COMPLETO
🧩 Clustering intelligente di 18 sessioni...
🔍 Encoding 18 testi...
🔍 Encoding 18 testi su device cuda...
✅ Embedding generati: shape (18, 768)
✅ Embedding generati: shape (18, 768)

📊 FASE 2A: TRAINING BERTOPIC ANTICIPATO

🚀 TRAINING BERTOPIC ANTICIPATO (NUOVO FLUSSO OTTIMIZZATO):
   📊 Dataset completo: 18 sessioni
   📊 Embeddings shape: (18, 768)
   🎯 Addestramento su TUTTO il dataset per features ottimali
   🔥 Esecuzione bertopic_provider.fit() su dataset completo...
⚠️ Errore training SVD: k must be less than or equal to the number of training points. Procedo senza SVD.
   ✅ BERTopic FIT completato in 5.99 secondi
   🔄 Esecuzione bertopic_provider.transform() per features extraction...
❌ ERRORE Training BERTopic anticipato: k must be less than or equal to the number of training points
   🔍 Traceback: Traceback (most recent call last):
  File "/home/ubuntu/classificazione_discussioni/Pipeline/end_to_end_pipeline.py", line 353, in _addestra_bertopic_anticipato
    tr = bertopic_provider.transform(
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/classificazione_discussioni/Pipeline/../TopicModeling/bertopic_feature_provider.py", line 197, in transform
    topic_ids, probs = self.model.transform(texts, embeddings=embeddings)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/classificazione_discussioni/.venv/lib/python3.12/site-packages/bertopic/_bertopic.py", line 632, in transform
    probabilities = hdbscan_delegator(self.hdbscan_model, "membership_vector", umap_embeddings)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/classificazione_discussioni/.venv/lib/python3.12/site-packages/bertopic/cluster/_utils.py", line 54, in hdbscan_delegator
    probabilities = hdbscan.membership_vector(model, embeddings)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/classificazione_discussioni/.venv/lib/python3.12/site-packages/hdbscan/prediction.py", line 575, in membership_vector
    clusterer.prediction_data_.tree.query(points_to_predict,
  File "sklearn/neighbors/_binary_tree.pxi", line 1180, in sklearn.neighbors._kd_tree.BinaryTree64.query
ValueError: k must be less than or equal to the number of training points

   ⚠️ BERTopic provider non disponibile, proseguo con sole embeddings

📊 FASE 2B: CLUSTERING HDBSCAN
🧠 Usando clustering INTELLIGENTE (LLM + ML senza pattern)
🧠 Clustering intelligente configurato:
   🎯 Categorie intent suggerite: 12
   🤖 LLM primario: True
   📊 Min confidence: 0.8
   📈 Min conversations per intent: 2
   👥 Rappresentanti diversificati: True
   🔢 Max rappresentanti per cluster: 5
   🤝 Strategia consenso: majority
🧠 Avvio clustering intelligente OTTIMIZZATO di 18 conversazioni...
📊 Fase 1: Clustering semantico con HDBSCAN...
   📈 Cluster HDBSCAN trovati: 3
   🔍 Outliers: 2
👥 Fase 2: Selezione rappresentanti per cluster...
   � Cluster 0: 3 sessioni, 3 rappresentanti selezionati
   � Cluster 1: 7 sessioni, 3 rappresentanti selezionati
   � Cluster 2: 6 sessioni, 3 rappresentanti selezionati
🤖 Fase 3: Analisi LLM di 9 rappresentanti...
🤖 Analisi LLM di 9 conversazioni...
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-23T03:50:58.197060
====================================================================================================
📋 Session ID: classify_1755921058
⏱️  Processing Time: 1.097s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (620 chars):
   [UTENTE] sono le 09.30 cosa devo fare ? [ASSISTENTE] Va bene, controllo. [ASSISTENTE] Alle 09:30, devi controllare lo stato dei cassonetti e dei cestini, pulire eventuali reflui e fare una prima pu...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (230 chars):
    {"predicted_label": "altro", "confidence": 0.3, "motivation": "L'utente non ha espresso una richiesta operativa o informativa specifica, ma sembra aver fornito un suggerimento generale sull'ordine e la pulizia dell'area tecnica"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.5
   motivation: L'utente non ha espresso una richiesta operativa o informativa specifica, ma sembra aver fornito un suggerimento generale sull'ordine e la pulizia dell'area tecnica
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.500
   [██████████░░░░░░░░░░] 50.0%

🧠 Reasoning/Motivation:
   L'utente non ha espresso una richiesta operativa o informativa specifica, ma sembra aver fornito un suggerimento generale sull'ordine e la pulizia dell'area tecnica
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-23T03:50:59.239751
====================================================================================================
📋 Session ID: classify_1755921059
⏱️  Processing Time: 1.040s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1336 chars):
   [UTENTE] posso fare cannottaggio in porto [ASSISTENTE] Va bene, controllo. [ASSISTENTE] Nel porto è vietato effettuare il canottaggio. [UTENTE] dove posso smaltire l'olio esausto?  [ASSISTENTE] Un ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (238 chars):
    {"predicted_label": "altro", "confidence": 0.3, "motivation": "Domanda riguardante il cannotaggio non è tra le etichette comuni e la risposta del sistema non sembra essere direttamente correlata a un'operazione o informazioni richieste"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.5
   motivation: Domanda riguardante il cannotaggio non è tra le etichette comuni e la risposta del sistema non sembra essere direttamente correlata a un'operazione o informazioni richieste
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.500
   [██████████░░░░░░░░░░] 50.0%

🧠 Reasoning/Motivation:
   Domanda riguardante il cannotaggio non è tra le etichette comuni e la risposta del sistema non sembra essere direttamente correlata a un'operazione o informazioni richieste
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-23T03:50:59.966539
====================================================================================================
📋 Session ID: classify_1755921059
⏱️  Processing Time: 0.725s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1766 chars):
   [UTENTE] ho un blackout su una colonnina [ASSISTENTE] Verifico. [ASSISTENTE] Per gestire un blackout su una colonnina, controlla che le colonnine dello stesso pontile siano in funzione. Verifica i ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (124 chars):
    {"predicted_label": "prenotazione_esami", "confidence": 0.7, "motivation": "Richiesta di verifica per un esame di colonna"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.49999999999999994
   motivation: Richiesta di verifica per un esame di colonna
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.500
   [█████████░░░░░░░░░░░] 50.0%

🧠 Reasoning/Motivation:
   Richiesta di verifica per un esame di colonna
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:00.932369
====================================================================================================
📋 Session ID: classify_1755921060
⏱️  Processing Time: 0.964s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (552 chars):
   [UTENTE] se l'Eucreas è mancante devo farlo pagare  fuori dpc? [ASSISTENTE] Verifico. [ASSISTENTE] Se l'Eucreas è mancante nel canale DPC, il farmacista deve proporre un farmaco equivalente vincito...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (188 chars):
    {"predicted_label": "altro", "confidence": 0.3, "motivation": "L'utente chiede se dovrà pagare il farmaco Eucreas fuori dal DPC, richiesta non riconducibile a una delle etichette comuni"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.5
   motivation: L'utente chiede se dovrà pagare il farmaco Eucreas fuori dal DPC, richiesta non riconducibile a una delle etichette comuni
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.500
   [██████████░░░░░░░░░░] 50.0%

🧠 Reasoning/Motivation:
   L'utente chiede se dovrà pagare il farmaco Eucreas fuori dal DPC, richiesta non riconducibile a una delle etichette comuni
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:01.715039
====================================================================================================
📋 Session ID: classify_1755921061
⏱️  Processing Time: 0.781s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1035 chars):
   [UTENTE] Controllo piani terapeutici online [ASSISTENTE] Mmmh, ho capito. [ASSISTENTE] Per il controllo dei piani terapeutici online, le farmacie devono utilizzare il sistema SIPSO Web per accedere...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (148 chars):
    {"predicted_label": "info_contatti", "confidence": 0.7, "motivation": "Richiesta di informazioni sui costi e remunerazione per le attività online"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.49999999999999994
   motivation: Richiesta di informazioni sui costi e remunerazione per le attività online
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.500
   [█████████░░░░░░░░░░░] 50.0%

🧠 Reasoning/Motivation:
   Richiesta di informazioni sui costi e remunerazione per le attività online
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:02.437102
====================================================================================================
📋 Session ID: classify_1755921062
⏱️  Processing Time: 0.720s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (265 chars):
   [UTENTE] Il seroquel è uscito dalla dpc? [ASSISTENTE] Un attimo. [ASSISTENTE] Sì, il Seroquel è stato escluso dalla Distribuzione per Conto (DPC) e riclassificato come Classe C nella Regione Lazio....

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [58 more lines] ...
     Line 62: 

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (116 chars):
    {"predicted_label": "info_medicinali", "confidence": 0.9, "motivation": "Domanda sulle informazioni su un farmaco"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.7
   motivation: Domanda sulle informazioni su un farmaco
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.700
   [██████████████░░░░░░] 70.0%

🧠 Reasoning/Motivation:
   Domanda sulle informazioni su un farmaco
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:03.560528
====================================================================================================
📋 Session ID: classify_1755921063
⏱️  Processing Time: 1.122s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (262 chars):
   [UTENTE] di cosa puoi parlarmi? [ASSISTENTE] Posso aiutarti con informazioni e domande relative ai documenti che hai caricato, rispondere a domande sui servizi di Alleanza, e fornire supporto su qu...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (243 chars):
    {"predicted_label": "info_contatti", "confidence": 0.9, "motivation": "L'utente chiede come possa essere assistito e l'assistente fornisce informazioni sui documenti caricati, servizi di Alleanza e supporto su questioni legate alla farmacia"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.7
   motivation: L'utente chiede come possa essere assistito e l'assistente fornisce informazioni sui documenti caricati, servizi di Alleanza e supporto su questioni legate alla farmacia
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.700
   [██████████████░░░░░░] 70.0%

🧠 Reasoning/Motivation:
   L'utente chiede come possa essere assistito e l'assistente fornisce informazioni sui documenti caricati, servizi di Alleanza e supporto su questioni legate alla farmacia
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:05.323934
====================================================================================================
📋 Session ID: classify_1755921065
⏱️  Processing Time: 1.762s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (260 chars):
   [UTENTE] furosemide fa interazione con il warfarin sodico  [ASSISTENTE] Non ho trovato informazioni specifiche sull'interazione tra furosemide e warfarin sodico nei documenti forniti. Ti consiglio ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [58 more lines] ...
     Line 62: 

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (451 chars):
    {"predicted_label": "altro", "confidence": 0.3, "motivation": "L'utente ha chiesto informazioni su un interazione farmacologica specifica tra furosemide e warfarin sodico, richiesta che non rientra nelle etichette comuni di ritiro cartella clinica, prenotazione esami o contatti. Tuttavia, la ris...

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.5
   motivation: L'utente ha chiesto informazioni su un interazione farmacologica specifica tra furosemide e warfarin sodico, richiesta che non rientra nelle etichette comuni di ritiro cartella clinica, prenotazione esami o contatti. Tuttavia, la risposta dell'assistente indica una domanda più generale su interazioni farmacologiche, quindi è possibile che l'utente abbia anche intenzioni informative.
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.500
   [██████████░░░░░░░░░░] 50.0%

🧠 Reasoning/Motivation:
   L'utente ha chiesto informazioni su un interazione farmacologica specifica tra furosemide e warfarin sodico, richiesta che non rientra nelle etichette comuni di ritiro cartella clinica, prenotazione esami o contatti. Tuttavia, la risposta dell'assistente indica una domanda più generale su interazioni farmacologiche, quindi è possibile che l'utente abbia anche intenzioni informative.
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:06.154294
====================================================================================================
📋 Session ID: classify_1755921066
⏱️  Processing Time: 0.828s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (571 chars):
   [UTENTE] cosa dice la distirbuzioen per conto sul seroquel [ASSISTENTE] Non ho trovato informazioni specifiche sulla distribuzione per conto del Seroquel nei documenti forniti. Se hai altre domande...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (156 chars):
    {"predicted_label": "info_dati_farmaci", "confidence": 0.6, "motivation": "Domanda sulle informazioni specifiche sulla distribuzione del farmaco Seroquel"}

📊 Parsed Response:
   predicted_label: info_dati_farmaci
   confidence: 0.5
   motivation: Domanda sulle informazioni specifiche sulla distribuzione del farmaco Seroquel
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.500
   [██████████░░░░░░░░░░] 50.0%

🧠 Reasoning/Motivation:
   Domanda sulle informazioni specifiche sulla distribuzione del farmaco Seroquel
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

   📈 Progresso LLM: 9/9
🔄 Fase 4: Analisi consenso e propagazione etichette...
   ✅ Cluster 0: 'altro' (3 sessioni, 3 reps, conf: 0.600, consenso: 1.00)
   ✅ Cluster 1: 'altro' (7 sessioni, 3 reps, conf: 0.667, consenso: 1.00)
   ✅ Cluster 2: 'altro' (6 sessioni, 3 reps, conf: 0.617, consenso: 0.67)
🔍 Fase 5: Analisi individuale di 2 outliers...
🤖 Analisi LLM di 2 conversazioni...
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:07.034746
====================================================================================================
📋 Session ID: classify_1755921067
⏱️  Processing Time: 0.878s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (668 chars):
   [UTENTE] quali moduli sono correlati alla procedura  [ASSISTENTE] Un attimo. [ASSISTENTE] I moduli correlati alla procedura di gestione delle non conformità includono il Modulo Non Conformità (M/MN...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [58 more lines] ...
     Line 62: 

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (171 chars):
    {"predicted_label": "procedura_non_conformita", "confidence": 0.9, "motivation": "Domanda riguardante i moduli correlati alla procedura di gestione delle non conformità"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.7
   motivation: Domanda riguardante i moduli correlati alla procedura di gestione delle non conformità
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.700
   [██████████████░░░░░░] 70.0%

🧠 Reasoning/Motivation:
   Domanda riguardante i moduli correlati alla procedura di gestione delle non conformità
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:07.756874
====================================================================================================
📋 Session ID: classify_1755921067
⏱️  Processing Time: 0.720s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (458 chars):
   [UTENTE] la donna incinta può assumere aciclovir ? [ASSISTENTE] L'uso di aciclovir in gravidanza deve essere considerato solo quando i potenziali benefici superano i rischi non noti. Studi non hann...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [58 more lines] ...
     Line 62: 

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (129 chars):
    {"predicted_label": "info_contatti", "confidence": 0.7, "motivation": "Domanda sulle prescrizioni farmacologiche in gravidanza"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.49999999999999994
   motivation: Domanda sulle prescrizioni farmacologiche in gravidanza
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.500
   [█████████░░░░░░░░░░░] 50.0%

🧠 Reasoning/Motivation:
   Domanda sulle prescrizioni farmacologiche in gravidanza
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

   📈 Progresso LLM: 2/2
✅ Clustering intelligente OTTIMIZZATO completato:
   📊 Cluster finali: 3
   🔍 Outliers rimanenti: 2
   🤖 Chiamate LLM totali: 11 (vs 18 dell'approccio naive)
   ⚡ Efficienza: 38.9% di riduzione chiamate LLM
   🎯 Confidenza media: 0.628
✅ Clustering intelligente completato!
  📊 Cluster trovati: 3
  🔍 Outliers: 2
  🏷️  Etichette suggerite: 3
  🎯 Confidenza media: 0.00
  🌟 Cluster alta confidenza: 0/3
    - Cluster 0: altro (3 conv., conf: 0.00, metodo: llm_ensemble_consensus)
    - Cluster 1: altro (7 conv., conf: 0.00, metodo: llm_ensemble_consensus)
    - Cluster 2: altro (6 conv., conf: 0.00, metodo: llm_ensemble_consensus)
🧠 Avvio dedupplicazione intelligente delle etichette...
📊 Analizzando 3 nuove etichette vs 0 esistenti
🔍 Fase 1: Analisi semantica con embeddings...
  📋 Cluster 0: nessuna etichetta esistente per confronto
  📋 Cluster 1: nessuna etichetta esistente per confronto
  📋 Cluster 2: nessuna etichetta esistente per confronto
🌳 Fase 2: Clustering gerarchico delle etichette esistenti...
  📭 Nessuna etichetta esistente per clustering
🤖 Fase 3: Validazione LLM per casi ambigui...
⚖️  Fase 4: Decisione finale con confidence scoring...
📊 Statistiche finali: 0 riusate, 3 nuove
✅ Dedupplicazione completata: 3 etichette processate
✅ Clustering completo: 3 cluster, 2 outlier

📊 FASE 3: SELEZIONE RAPPRESENTANTI PER REVIEW UMANA
🔍 Selezione intelligente rappresentanti per review umana...
📊 Analisi cluster:
  📋 Cluster totali: 3
  ✅ Cluster eleggibili: 3
  🚫 Cluster troppo piccoli (< 2): 0
📊 Calcolo sessioni:
  🎯 Limite massimo: 500
  📝 Con 3 reps/cluster: 9
✅ Possiamo usare configurazione standard (3 reps/cluster)
✅ Selezione completata:
  📋 Cluster originali: 3
  👤 Cluster per review: 3
  📝 Sessioni per review: 9
  🚫 Cluster esclusi: 0

📊 FASE 4: TRAINING SUPERVISIONATO
🎓 Training del classificatore...
📊 Sessioni da processare: 18
🏷️  Etichette suggerite: 3
👤 Modalità interattiva: True
📈 Cluster validi trovati: 3

👤 MODALITÀ INTERATTIVA ABILITATA
📊 Trovati 3 cluster da revieware
⏭️ Procedendo automaticamente con review interattiva abilitata
🔍 Labels dopo review: 3

🔍 INIZIO REVIEW INTERATTIVO

================================================================================
📋 REVIEW CLUSTER 0
🏷️  Etichetta suggerita: 'altro'
================================================================================

📝 CONVERSAZIONI RAPPRESENTATIVE (3 esempi):
------------------------------------------------------------

[1] Sessione: 935e2349-0f2f-4ffc-a520-dbec4d0daf1b
    Conversazione:
    [UTENTE] posso fare cannottaggio in porto [ASSISTENTE] Va bene, controllo. [ASSISTENTE] Nel porto è vietato effettuare il canottaggio. [UTENTE] dove posso smaltire l'olio esausto?  [ASSISTENTE] Un secondo che recupero le info. [ASSISTENTE] Nel porto, le miscele di idrocarburi di sentine possono essere smaltite a terra, recapitandole negli appositi luoghi di raccolta. [UTENTE] e in mare non posso buttarli ? [ASSISTENTE] Va bene, controllo. [ASSISTENTE] No, è vietato smaltire olio esausto in mare....
------------------------------------------------------------

[2] Sessione: 9741423f-b080-405f-937d-5bd8b8b523a1
    Conversazione:
    [UTENTE] sono le 09.30 cosa devo fare ? [ASSISTENTE] Va bene, controllo. [ASSISTENTE] Alle 09:30, devi controllare lo stato dei cassonetti e dei cestini, pulire eventuali reflui e fare una prima pulizia dello specchio acqueo. [UTENTE] riassumi quali sono i compiti [ASSISTENTE] Mmmh, capisco. [ASSISTENTE] I compiti giornalieri degli ormeggiatori includono: spegnere le luci, controllare le aree comuni, aggiornare il registro transiti, sistemare gli arredi, pulire lo specchio acqueo, eseguire lavor...
------------------------------------------------------------

[3] Sessione: afb89af4-4d1d-46a6-b39e-407013c5cc08
    Conversazione:
    [UTENTE] ho un blackout su una colonnina [ASSISTENTE] Verifico. [ASSISTENTE] Per gestire un blackout su una colonnina, controlla che le colonnine dello stesso pontile siano in funzione. Verifica i magnetotermici all'interno della colonnina e usa il bottone test per controllare la presenza di energia elettrica. Assicurati che tutte le prese siano accese. Se il problema persiste, segnala il guasto nel rapporto di fine turno. [UTENTE] ho verificato tutto ma continua a non funzionare [ASSISTENTE] Ca...
------------------------------------------------------------

🤖 PROPOSTA LLM:
   Etichetta: 'altro' (confidenza: 0.500)
   Motivazione: Domanda riguardante il cannotaggio non è tra le etichette comuni e la risposta del sistema non sembra essere direttamente correlata a un'operazione o informazioni richieste

👤 DECISIONE:
🤖 MODALITÀ AUTOMATICA ATTIVA
✅ Usata etichetta clustering: 'altro' (confidenza di default: 0.800)

================================================================================
📋 REVIEW CLUSTER 1
🏷️  Etichetta suggerita: 'altro'
================================================================================

📝 CONVERSAZIONI RAPPRESENTATIVE (3 esempi):
------------------------------------------------------------

[1] Sessione: 1b8c6808-a49d-49de-84f0-746566dff39f
    Conversazione:
    [UTENTE] Il seroquel è uscito dalla dpc? [ASSISTENTE] Un attimo. [ASSISTENTE] Sì, il Seroquel è stato escluso dalla Distribuzione per Conto (DPC) e riclassificato come Classe C nella Regione Lazio. Ora è sostituibile con l'equivalente vincitore di gara, Quetiapina.
------------------------------------------------------------

[2] Sessione: e9362e7f-302a-4227-992e-282f7ab73cd3
    Conversazione:
    [UTENTE] Controllo piani terapeutici online [ASSISTENTE] Mmmh, ho capito. [ASSISTENTE] Per il controllo dei piani terapeutici online, le farmacie devono utilizzare il sistema SIPSO Web per accedere e gestire i piani terapeutici dei pazienti. È importante seguire le procedure stabilite per garantire la corretta gestione e aggiornamento dei dati. [UTENTE] Fatturazione DPC differita al 6 febbraio [ASSISTENTE] Verifico. [ASSISTENTE] La fatturazione DPC per il mese di gennaio è stata differita al 6 f...
------------------------------------------------------------

[3] Sessione: cf51db81-a7c0-47b0-a027-a24ed2183389
    Conversazione:
    [UTENTE] vorre i sapere come gestire in DPC l'inderal [ASSISTENTE] Mmmh, capisco. [ASSISTENTE] Per gestire l'Inderal in DPC, è necessario utilizzare il farmaco alternativo Sumial 40mg, poiché l'Inderal è carente. Le due specialità sono messe in equivalenza sul portale WEBDPC. È consentita l'erogazione di una sola confezione di Sumial per ricetta, e il codice identificativo deve essere apposto sulla ricetta. [UTENTE] ucreas mancante, fuori DPC devo farlo pagare? [ASSISTENTE] Va bene, controllo. [...
------------------------------------------------------------

🤖 PROPOSTA LLM:
   Etichetta: 'altro' (confidenza: 0.700)
   Motivazione: Domanda sulle informazioni su un farmaco

👤 DECISIONE:
🤖 MODALITÀ AUTOMATICA ATTIVA
✅ Usata etichetta clustering: 'altro' (confidenza di default: 0.800)

================================================================================
📋 REVIEW CLUSTER 2
🏷️  Etichetta suggerita: 'altro'
================================================================================

📝 CONVERSAZIONI RAPPRESENTATIVE (3 esempi):
------------------------------------------------------------

[1] Sessione: 4dc6f6-e09-6b8-ea7-8607c6218
    Conversazione:
    [UTENTE] cosa sai fare [ASSISTENTE] Posso aiutarti a trovare informazioni nei documenti che hai caricato, rispondere a domande sui servizi di Alleanza e fornire supporto su vari argomenti legati alla tua attività di farmacista. Fammi sapere come posso assisterti!
------------------------------------------------------------

[2] Sessione: 5659921c-26c0-45e4-be5b-286191ef09cf
    Conversazione:
    [UTENTE] furosemide fa interazione con il warfarin sodico  [ASSISTENTE] Non ho trovato informazioni specifiche sull'interazione tra furosemide e warfarin sodico nei documenti forniti. Ti consiglio di consultare un medico o un farmacista per ulteriori dettagli.
------------------------------------------------------------

[3] Sessione: e81bead1-0663-4310-8ac8-47fcdbcf472b
    Conversazione:
    [UTENTE] cosa dice la distirbuzioen per conto sul seroquel [ASSISTENTE] Non ho trovato informazioni specifiche sulla distribuzione per conto del Seroquel nei documenti forniti. Se hai altre domande o hai bisogno di ulteriori dettagli, fammi sapere! [UTENTE] che informaizoni hai in base di conoscenza? [ASSISTENTE] Non ho informazioni specifiche sulla distribuzione per conto del Seroquel nella mia base di conoscenza. Ti consiglio di consultare documenti ufficiali o contattare direttamente il forni...
------------------------------------------------------------

🤖 PROPOSTA LLM:
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:08.878482
====================================================================================================
📋 Session ID: classify_1755921068
⏱️  Processing Time: 1.091s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (263 chars):
   [UTENTE] cosa sai fare [ASSISTENTE] Posso aiutarti a trovare informazioni nei documenti che hai caricato, rispondere a domande sui servizi di Alleanza e fornire supporto su vari argomenti legati al...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (234 chars):
    {"predicted_label": "info_contatti", "confidence": 0.9, "motivation": "L'utente chiede di essere aiutato a trovare informazioni e il sistema risponde che può fornire supporto su vari argomenti legati alla sua attività di farmacista"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.7
   motivation: L'utente chiede di essere aiutato a trovare informazioni e il sistema risponde che può fornire supporto su vari argomenti legati alla sua attività di farmacista
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.700
   [██████████████░░░░░░] 70.0%

🧠 Reasoning/Motivation:
   L'utente chiede di essere aiutato a trovare informazioni e il sistema risponde che può fornire supporto su vari argomenti legati alla sua attività di farmacista
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

   Etichetta: 'altro' (confidenza: 0.700)
   Motivazione: L'utente chiede di essere aiutato a trovare informazioni e il sistema risponde che può fornire supporto su vari argomenti legati alla sua attività di farmacista

👤 DECISIONE:
🤖 MODALITÀ AUTOMATICA ATTIVA
✅ Usata etichetta clustering: 'altro' (confidenza di default: 0.800)

✅ Review interattivo completato
🔍 Encoding 18 testi su device cuda...
✅ Embedding generati: shape (18, 768)
⚠️ Insufficienti dati per training ML: 18 campioni, 1 classi
🔄 Saltando training ML, usando solo LLM per classificazioni future
💾 Salvate informazioni cluster per ottimizzazione futura
--------------------------------------------------
✅ TRAINING SUPERVISIONATO COMPLETATO!
⏱️  Durata: 18.1 secondi
📊 Dataset: 18 sessioni totali
🧩 Clustering: 3 cluster su dataset completo
� Sessioni selezionate per review: 9
✅ Training supervisionato completato per alleanza
📊 STATISTICHE FINALI:
  📝 Sessioni riviste: 9/500
  🧩 Cluster inclusi: 3
  🚫 Cluster esclusi: 0
🧹 Sanitizzazione dati per JSON serialization...
✅ Dati sanitizzati per JSON
