ğŸš€ UMAP disponibile per riduzione dimensionale!
ğŸš€ cuML GPU clustering disponibile!
ğŸ’¥ EmbeddingDestroyer inizializzato - Ready to destroy and rebuild!
ğŸ¯ SimpleEmbeddingManager inizializzato
ğŸ›ï¸ Configurazioni AI saranno salvate su DATABASE MySQL
ğŸ›ï¸ AIConfigurationService inizializzato
   ï¿½ Backend: DATABASE MySQL
   ğŸ”‘ OpenAI API Key: âœ… Configurata
ğŸ­ EmbeddingEngineFactory inizializzata
ğŸ¯ EmbeddingManager inizializzato
âœ… Blueprint esempi inizializzato correttamente
ğŸš€ Avvio server Flask - Debug: True
 * Serving Flask app 'server'
 * Debug mode: on
ğŸ” [DEBUG] GET /api/tenants - Avvio richiesta tenant con oggetti Tenant
ğŸ” [DEBUG] Chiamo get_available_tenants() per oggetti Tenant...
ğŸ¢ Recuperati 22 oggetti Tenant dalla tabella TAG.tenants
ğŸ” [DEBUG] Recuperati 22 oggetti Tenant dal database
ğŸ” [DEBUG] Primi 3 tenant convertiti: [{'tenant_id': 'a0fd7600-f4f7-11ef-9315-96000228e7fe', 'tenant_name': 'Alleanza', 'tenant_slug': 'alleanza', 'is_active': True}, {'tenant_id': '6bc4f06f-742e-11f0-acb8-96000228e7fe', 'tenant_name': 'BluPantheon', 'tenant_slug': 'blupantheon', 'is_active': True}, {'tenant_id': '0f9d6e90-d319-11ef-86a5-96000228e7fe', 'tenant_name': 'Boots', 'tenant_slug': 'boots', 'is_active': True}]
ğŸ” [DEBUG] Invio risposta con 22 tenant
ğŸ” [DEBUG] GET /api/tenants - Avvio richiesta tenant con oggetti Tenant
ğŸ” [DEBUG] Chiamo get_available_tenants() per oggetti Tenant...
ğŸ” [DEBUG] GET /api/prompts/a0fd7600-f4f7-11ef-9315-96000228e7fe/status - Avvio richiesta
ğŸ” [DEBUG] API: Recupero status prompt per tenant: a0fd7600-f4f7-11ef-9315-96000228e7fe
âœ… [DEBUG] Riconosciuto come tenant_id UUID: a0fd7600-f4f7-11ef-9315-96000228e7fe
ğŸ” [DEBUG] Inizializzo PromptManager...
ğŸ” [DEBUG] Chiamo get_all_prompts_for_tenant(a0fd7600-f4f7-11ef-9315-96000228e7fe)...
ğŸ¢ Recuperati 22 oggetti Tenant dalla tabella TAG.tenants
ğŸ” [DEBUG] Recuperati 22 oggetti Tenant dal database
ğŸ” [DEBUG] Primi 3 tenant convertiti: [{'tenant_id': 'a0fd7600-f4f7-11ef-9315-96000228e7fe', 'tenant_name': 'Alleanza', 'tenant_slug': 'alleanza', 'is_active': True}, {'tenant_id': '6bc4f06f-742e-11f0-acb8-96000228e7fe', 'tenant_name': 'BluPantheon', 'tenant_slug': 'blupantheon', 'is_active': True}, {'tenant_id': '0f9d6e90-d319-11ef-86a5-96000228e7fe', 'tenant_name': 'Boots', 'tenant_slug': 'boots', 'is_active': True}]
ğŸ” [DEBUG] Invio risposta con 22 tenant
ğŸ” [DEBUG] Recuperati 5 prompt dal PromptManager
ğŸ” [DEBUG] Statistiche: 5/5 attivi, 0 inattivi
âœ… [DEBUG] Status calcolato: {'success': True, 'tenant_id': 'a0fd7600-f4f7-11ef-9315-96000228e7fe', 'tenant_name': 'Alleanza', 'total_prompts': 5, 'active_prompts': 5, 'inactive_prompts': 0, 'last_updated': '2025-08-25T08:54:43', 'status': 'ready', 'canOperate': True, 'requiredPrompts': [{'name': 'System Prompt', 'type': 'system', 'description': 'Prompt di sistema per la classificazione', 'exists': True}, {'name': 'User Template', 'type': 'user', 'description': 'Template per prompt utente', 'exists': True}, {'name': 'Classification Prompt', 'type': 'classification', 'description': 'Prompt per classificazione intelligente', 'exists': False}], 'missingCount': 1}
âœ… [DEBUG] Status prompt per tenant_id a0fd7600-f4f7-11ef-9315-96000228e7fe: 5/5 attivi
ğŸ” [DEBUG] Invio risposta JSON per status prompt
ğŸ” [DEBUG] GET /api/prompts/a0fd7600-f4f7-11ef-9315-96000228e7fe/status - Avvio richiesta
ğŸ” [DEBUG] API: Recupero status prompt per tenant: a0fd7600-f4f7-11ef-9315-96000228e7fe
âœ… [DEBUG] Riconosciuto come tenant_id UUID: a0fd7600-f4f7-11ef-9315-96000228e7fe
ğŸ” [DEBUG] Inizializzo PromptManager...
ğŸ” [DEBUG] Chiamo get_all_prompts_for_tenant(a0fd7600-f4f7-11ef-9315-96000228e7fe)...
ğŸ” [DEBUG] Recuperati 5 prompt dal PromptManager
ğŸ” [DEBUG] Statistiche: 5/5 attivi, 0 inattivi
âœ… [DEBUG] Status calcolato: {'success': True, 'tenant_id': 'a0fd7600-f4f7-11ef-9315-96000228e7fe', 'tenant_name': 'Alleanza', 'total_prompts': 5, 'active_prompts': 5, 'inactive_prompts': 0, 'last_updated': '2025-08-25T08:54:43', 'status': 'ready', 'canOperate': True, 'requiredPrompts': [{'name': 'System Prompt', 'type': 'system', 'description': 'Prompt di sistema per la classificazione', 'exists': True}, {'name': 'User Template', 'type': 'user', 'description': 'Template per prompt utente', 'exists': True}, {'name': 'Classification Prompt', 'type': 'classification', 'description': 'Prompt per classificazione intelligente', 'exists': False}], 'missingCount': 1}
âœ… [DEBUG] Status prompt per tenant_id a0fd7600-f4f7-11ef-9315-96000228e7fe: 5/5 attivi
ğŸ” [DEBUG] Invio risposta JSON per status prompt
ğŸ” [DEBUG] GET /api/prompts/015007d9-d413-11ef-86a5-96000228e7fe/status - Avvio richiesta
ğŸ” [DEBUG] API: Recupero status prompt per tenant: 015007d9-d413-11ef-86a5-96000228e7fe
âœ… [DEBUG] Riconosciuto come tenant_id UUID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” [DEBUG] Inizializzo PromptManager...
ğŸ” [DEBUG] Chiamo get_all_prompts_for_tenant(015007d9-d413-11ef-86a5-96000228e7fe)...
ğŸ” [DEBUG] Recuperati 5 prompt dal PromptManager
ğŸ” [DEBUG] Statistiche: 5/5 attivi, 0 inattivi
âœ… [DEBUG] Status calcolato: {'success': True, 'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'total_prompts': 5, 'active_prompts': 5, 'inactive_prompts': 0, 'last_updated': '2025-08-30T12:34:13', 'status': 'ready', 'canOperate': True, 'requiredPrompts': [{'name': 'System Prompt', 'type': 'system', 'description': 'Prompt di sistema per la classificazione', 'exists': True}, {'name': 'User Template', 'type': 'user', 'description': 'Template per prompt utente', 'exists': True}, {'name': 'Classification Prompt', 'type': 'classification', 'description': 'Prompt per classificazione intelligente', 'exists': False}], 'missingCount': 1}
âœ… [DEBUG] Status prompt per tenant_id 015007d9-d413-11ef-86a5-96000228e7fe: 5/5 attivi
ğŸ” [DEBUG] Invio risposta JSON per status prompt
ğŸ”§ Creazione MongoClassificationReader per cliente: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” Risoluzione tenant da UUID: 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
âœ… Tenant risolto (DB TAG locale): Humanitas (humanitas) UUID=015007d9-d413-11ef-86a5-96000228e7fe
âœ… Tenant risolto da UUID: Humanitas (015007d9-d413-11ef-86a5-96000228e7fe)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
âœ… MongoClassificationReader inizializzato per tenant: Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
   ğŸ¢ Database: classificazioni
âœ… MongoClassificationReader creato per tenant: Humanitas (humanitas)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
âœ… Connesso a MongoDB database: classificazioni
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
ğŸ” Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
ğŸ·ï¸ Recupero etichette per tenant: Humanitas
ğŸ“Š Calcolo statistiche per tenant: Humanitas
ğŸ”§ Creazione MongoClassificationReader per cliente: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” Risoluzione tenant da UUID: 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
âœ… Tenant risolto (DB TAG locale): Humanitas (humanitas) UUID=015007d9-d413-11ef-86a5-96000228e7fe
âœ… Tenant risolto da UUID: Humanitas (015007d9-d413-11ef-86a5-96000228e7fe)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
âœ… MongoClassificationReader inizializzato per tenant: Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
   ğŸ¢ Database: classificazioni
âœ… MongoClassificationReader creato per tenant: Humanitas (humanitas)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
âœ… Connesso a MongoDB database: classificazioni
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
ğŸ” Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
ğŸ·ï¸ Recupero etichette per tenant: Humanitas
ğŸ“Š Calcolo statistiche per tenant: Humanitas
ğŸ”§ Creazione MongoClassificationReader per cliente: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” Risoluzione tenant da UUID: 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
âœ… Tenant risolto (DB TAG locale): Humanitas (humanitas) UUID=015007d9-d413-11ef-86a5-96000228e7fe
âœ… Tenant risolto da UUID: Humanitas (015007d9-d413-11ef-86a5-96000228e7fe)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
âœ… MongoClassificationReader inizializzato per tenant: Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
   ğŸ¢ Database: classificazioni
âœ… MongoClassificationReader creato per tenant: Humanitas (humanitas)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
âœ… Connesso a MongoDB database: classificazioni
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
ğŸ” Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
ğŸ·ï¸ Recupero etichette per tenant: Humanitas
ğŸ“Š Calcolo statistiche per tenant: Humanitas
ğŸ¯ TRAINING SUPERVISIONATO - Cliente: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“‹ Parametri utente semplificati:
  ï¿½ Max sessioni review: 500
  ğŸ¯ Soglia confidenza: 0.95
  ğŸ”„ Forza review: False
  âš–ï¸  Soglia disagreement: 0.3
ğŸ”§ Inizializzazione pipeline per cliente: 015007d9-d413-11ef-86a5-96000228e7fe (con lock)
âš ï¸ [PIPELINE] DEPRECATO: uso di tenant_slug '015007d9-d413-11ef-86a5-96000228e7fe' - convertendo a oggetto Tenant
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
âœ… Tenant risolto (DB TAG locale): Humanitas (humanitas) UUID=015007d9-d413-11ef-86a5-96000228e7fe
ğŸ”„ [PIPELINE] Conversione completata: Humanitas (015007d9-d413-11ef-86a5-96000228e7fe)
âœ… [CONFIG] Configurazione base caricata da /home/ubuntu/classificatore/Utils/../config.yaml
ğŸ¯ [PIPELINE CLUSTERING CONFIG] Caricati parametri personalizzati per tenant 015007d9-d413-11ef-86a5-96000228e7fe:
   allow_single_cluster: non_definito -> False
   alpha: non_definito -> 0.7
   cluster_selection_epsilon: non_definito -> 0.13
   cluster_selection_method: non_definito -> leaf
   max_cluster_size: non_definito -> 0
   metric: non_definito -> euclidean
   min_cluster_size: 5 -> 21
   min_samples: 3 -> 14
   only_user: non_definito -> False
   umap_metric: non_definito -> cosine
   umap_min_dist: non_definito -> 0.05
   umap_n_components: non_definito -> 100
   umap_n_neighbors: non_definito -> 15
   umap_random_state: non_definito -> 42
   use_umap: non_definito -> True

ğŸš€ [FASE 1: INIZIALIZZAZIONE] Avvio pipeline...
ğŸ¥ [FASE 1: INIZIALIZZAZIONE] Tenant: humanitas
ğŸ¯ [FASE 1: INIZIALIZZAZIONE] Configurazione:
   ğŸ“Š Confidence threshold: 0.7
   ğŸ¤– Auto mode: True
   ğŸ”„ Auto retrain: False
ï¿½ [FASE 1: INIZIALIZZAZIONE] Inizializzazione lettore conversazioni...
âœ… [CONFIG] Configurazione base caricata da /home/ubuntu/classificatore/Utils/../config.yaml
âœ… [CONFIG] Config personalizzata tenant 015007d9-d413-11ef-86a5-96000228e7fe: 15 parametri
ğŸ¯ [ONLY_USER] Tenant 015007d9-d413-11ef-86a5-96000228e7fe: False (da config personalizzata)
ğŸ¯ [LETTORE] Tenant 015007d9-d413-11ef-86a5-96000228e7fe: only_user = False (da config tenant)
ï¿½ [FASE 1: INIZIALIZZAZIONE] Inizializzazione aggregator...
   ğŸ” Schema: 'humanitas'
   ğŸ†” Tenant ID: '015007d9-d413-11ef-86a5-96000228e7fe'
ğŸ¯ [SESSION AGGREGATOR] Inizializzazione con oggetto Tenant: Humanitas (015007d9-d413-11ef-86a5-96000228e7fe)
ğŸ¯ [ONLY_USER] Tenant 015007d9-d413-11ef-86a5-96000228e7fe: False (da config personalizzata)
ğŸ¯ [LETTORE] Tenant 015007d9-d413-11ef-86a5-96000228e7fe: only_user = False (da config tenant)
ï¿½ [ONLY_USER] Schema None: False (legacy - no tenant_id)
ğŸ§  [FASE 1: INIZIALIZZAZIONE] Sistema embedder dinamico (lazy loading)
ğŸ”§ [FASE 1: INIZIALIZZAZIONE] Parametri clustering:
   ğŸ“Š Min cluster size: 21
   ğŸ“Š Min samples: 14
ğŸ› DEBUG CLUSTER_ALPHA - PRIMA:
   ğŸ“‹ clustering_config.get('alpha', 1.0): 0.7
   ğŸ“‹ Type: <class 'float'>
ğŸ› DEBUG CLUSTER_ALPHA - DOPO CONVERSIONE:
   ğŸ“‹ cluster_alpha: 0.7
   ğŸ“‹ Type: <class 'float'>
ğŸ› DEBUG CLUSTER_ALPHA - FINALE:
   ğŸ“‹ cluster_alpha finale: 0.7
   ğŸ“‹ Type finale: <class 'float'>
   ğŸ“‹ Alpha > 0: True
âœ… [CONFIG] Config personalizzata tenant 015007d9-d413-11ef-86a5-96000228e7fe: 15 parametri
ğŸ—‚ï¸  [UMAP] Parametri per tenant 015007d9-d413-11ef-86a5-96000228e7fe:
   use_umap: True
   n_neighbors: 15
   min_dist: 0.05
   n_components: 100
   metric: cosine
ğŸ”§ [FIX DEBUG] Parametri tenant passati a HDBSCANClusterer:
   min_cluster_size: 21
   min_samples: 14
   alpha: 0.7
   cluster_selection_method: leaf
   cluster_selection_epsilon: 0.13
   metric: euclidean
   allow_single_cluster: False
   max_cluster_size: 0
   ğŸ—‚ï¸  use_umap: True
   ğŸ—‚ï¸  umap_n_neighbors: 15
   ğŸ—‚ï¸  umap_min_dist: 0.05
   ğŸ—‚ï¸  umap_n_components: 100
ğŸ¯ [BERTOPIC] Parametri consistenti configurati:
   ğŸ“Š HDBSCAN: 10 parametri
   ğŸ“Š UMAP: 5 parametri
ğŸ”§ HDBSCANClusterer inizializzato:
   min_cluster_size: 21
   min_samples: 14
   metric: euclidean
   cluster_selection_epsilon: 0.13
   ğŸ—‚ï¸  UMAP enabled: True
     ğŸ“ n_neighbors: 15
     ğŸ“ min_dist: 0.05
     ğŸ“Š n_components: 100
     ğŸ¯ metric: cosine
   ğŸš€ GPU enabled: True
   ğŸ’¾ GPU memory limit: 80%
   ğŸ”„ CPU fallback: True
   âš ï¸  [GPU MODE] Limitazioni cuML HDBSCAN:
     ğŸš« leaf_size=40 sarÃ  IGNORATO su GPU
     âœ… Parametri supportati: cluster_selection_method, alpha, allow_single_cluster
ğŸ¯ [DEBUG REACT] Parametri configurati:
   cluster_selection_method: leaf
   alpha: 0.7
   allow_single_cluster: False
ğŸ§  Inizializzazione memoria semantica...
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
âœ… MongoClassificationReader inizializzato per tenant: Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
   ğŸ¢ Database: classificazioni
ğŸ”§ TokenizationManager inizializzato:
   ğŸ“Š Modello tokenizer: cl100k_base
   ğŸ”¢ Limite massimo token: 8000
   âœ‚ï¸  Strategia troncamento: start
âœ… TokenizationManager integrato in LaBSE per gestione conversazioni lunghe
ğŸš€ Inizializzazione LaBSE embedder su device: cuda
ğŸ“¥ Caricamento modello sentence-transformers/LaBSE...
ğŸš€ Caricamento diretto su GPU...
âœ… Modello caricato con successo!
ğŸ“Š Dimensione embedding: 768
ğŸ”§ Device: cuda
ğŸ® GPU: NVIDIA A10G
ğŸ’¾ GPU Memory: 23.7 GB
ğŸ“ˆ GPU Memory utilizzata: 1.89 GB
ï¿½ Primo parametro su device: cuda:0
ğŸ§ª Test del modello LaBSE...
ğŸ” Encoding 3 testi con LaBSE su device cuda...

ğŸ” TOKENIZZAZIONE PREVENTIVA LABSE CLUSTERING
============================================================
ğŸ” ELABORAZIONE CONVERSAZIONI PER CLUSTERING
   ğŸ“Š Numero conversazioni: 3
   ğŸ†” Session IDs forniti: No

ğŸ“Š STATISTICHE ELABORAZIONE:
   ğŸ”¢ Conversazioni totali: 3
   âœ‚ï¸  Conversazioni troncate: 0
   ğŸ“ Token originali totali: 20
   ğŸ“ Token finali totali: 20
   ğŸ“Š Range token: 6 - 7
âœ… Tokenizzazione LaBSE completata:
   ğŸ“Š Conversazioni processate: 3
   ğŸ“Š Conversazioni troncate: 0
   ğŸ“Š Token limite configurato: 8000
   âœ… Tutte le conversazioni entro i limiti, nessun troncamento
============================================================
âœ… Embedding generati: shape (3, 768)
âœ… Test modello completato con successo!
   Shape: (3, 768)
   Norme: [0.99999994 1.         1.        ]
   Device: cuda
ğŸ¯ Modello pronto per l'uso!
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
âœ… MongoClassificationReader inizializzato per tenant: Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
   ğŸ¢ Database: classificazioni
ğŸ§  SemanticMemoryManager inizializzato
  ğŸ¯ Soglia riutilizzo etichette: 0.8
  ğŸ” Soglia similaritÃ  semantica: 0.8
  ğŸ’¾ Cache path: semantic_cache/humanitas_015007d9_memory
ğŸ”— Inizializzazione ensemble classifier avanzato...
ğŸ” ML Ensemble Debugger inizializzato e ATTIVO
   ğŸ“ Debug file: ./debug_logs/ml_debug.log
ğŸ” ML Ensemble Debugger attivato
ğŸ”§ Tentativo di inizializzazione IntelligentClassifier tramite LLMFactory...
ğŸ§  GPU Memory prima di LLM: 1.8GB/22.1GB (free: 20.3GB)
âœ… Memoria GPU sufficiente, inizializzazione LLM tramite Factory...
ğŸ›ï¸ Configurazioni AI saranno salvate su DATABASE MySQL
ğŸ›ï¸ AIConfigurationService inizializzato
   ï¿½ Backend: DATABASE MySQL
   ğŸ”‘ OpenAI API Key: âœ… Configurata
ğŸ­ LLM Factory inizializzato con cache invalidation intelligente
ğŸ” LLM FACTORY DEBUG: Chiamata ai_config_service.get_tenant_configuration(humanitas) normale...
ğŸ”„ DatabaseAI: ModalitÃ  legacy - risolvo tenant_id humanitas
ğŸ” [DEBUG] Query eseguita per tenant_id: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” [DEBUG] Risultato database: {'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'tenant_slug': 'humanitas', 'embedding_engine': 'labse', 'llm_engine': 'mistral:7b', 'embedding_config': None, 'llm_config': None, 'is_active': 1, 'updated_at': datetime.datetime(2025, 8, 28, 16, 51, 54)}
ğŸ” [DEBUG AIConfig] db_config ricevuto: {'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'tenant_slug': 'humanitas', 'embedding_engine': 'labse', 'llm_engine': 'mistral:7b', 'is_active': 1, 'updated_at': datetime.datetime(2025, 8, 28, 16, 51, 54), 'embedding_config': {}, 'llm_config': {}}
ğŸ” [DEBUG AIConfig] llm_engine nel db_config: mistral:7b
ğŸ¯ LLM FACTORY DEBUG: Modello normale = 'mistral:7b'
ğŸ”§ Creazione LLM classifier mistral:7b per tenant humanitas
ğŸš€ LLM FACTORY DEBUG: Avvio creazione nuovo classifier modello 'mistral:7b'
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
âœ… Tenant risolto da slug (DB TAG locale): Humanitas (humanitas) UUID=015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” LLM Debugger inizializzato e ATTIVO
   ğŸ“ Debug file: ./debug_logs/llm_debug.log
   ğŸ¨ Visual formatting: True
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
âœ… MongoClassificationReader inizializzato per tenant: Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
   ğŸ¢ Database: classificazioni
ğŸ—„ï¸ MongoClassificationReader inizializzato per tenant: Humanitas
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
âœ… MongoClassificationReader inizializzato per tenant: Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
   ğŸ¢ Database: classificazioni
Connessione al database TAG stabilita con successo
ğŸ“‹ Recuperati 265 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa
ğŸ”§ TokenizationManager inizializzato:
   ğŸ“Š Modello tokenizer: cl100k_base
   ğŸ”¢ Limite massimo token: 8000
   âœ‚ï¸  Strategia troncamento: start
âœ… LLM FACTORY DEBUG: Nuovo classifier creato: mistral:7b
âœ… LLM Classifier mistral:7b (mistral:7b) creato e cached per tenant humanitas
ğŸ­ LLM classifier ottenuto tramite Factory per tenant humanitas
ğŸ¤– LLM classifier creato automaticamente nell'ensemble: mistral:7b
ğŸ’¡ Possibile fine-tuning per humanitas
ğŸ”— Advanced Ensemble Classifier inizializzato
   ğŸ§  LLM weight: 0.60
   ğŸ¤– ML weight: 0.40
   ğŸ¯ Confidence threshold: 0.7
   ğŸ”„ Adaptive weights: True
   ğŸ‘¤ Disaccordi gestiti da QualityGateEngine
ğŸ“¥ Caricamento ultimo modello per humanitas: humanitas_015007d9_20250829_181313
ğŸ“¥ Caricamento ensemble model...
âœ… ML ensemble caricato
âœ… Configurazione caricata
ğŸ”— Ensemble model caricato da models/humanitas_015007d9_20250829_181313
âœ… Modello caricato con successo

ğŸ” VERIFICA BERTOPIC LOADING:
   ğŸ“‹ BERTopic enabled: True
   ğŸ“‹ BERTopic available: True
   ğŸ“ Provider directory: models/humanitas_015007d9_20250829_181313_bertopic
   ğŸ“ Directory exists: True
   ï¿½ File trovati: 3 -> ['metadata.json', 'bertopic_model', 'svd_model.pkl']

ğŸ”„ CARICAMENTO BERTOPIC:
   ğŸ“ Path completo: /home/ubuntu/classificatore/models/humanitas_015007d9_20250829_181313_bertopic
ğŸ”„ Caricamento BERTopic model da models/humanitas_015007d9_20250829_181313_bertopic/bertopic_model
âœ… BERTopic model caricato con successo
ğŸ“¥ SVD caricato (svd_model.pkl)
   â±ï¸ Caricamento completato in 0.20 secondi
   âœ… BERTopic provider caricato con successo
ğŸ”— BERTopic provider impostato (top_k=10, one_hot=False)
   âœ… BERTopic provider configurato nell'ensemble
â¸ï¸ Riaddestramento automatico disabilitato (modalitÃ  supervisione/API)
   ğŸ’¡ Per abilitare, usare auto_retrain=True nell'inizializzazione
âœ… Classificatore LLM disponibile nell'ensemble
ğŸ‘¤ Inizializzazione trainer interattivo...
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
âœ… MongoClassificationReader inizializzato per tenant: Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
   ğŸ¢ Database: classificazioni
ğŸ¯ SIMPLE MANAGER: Richiesta embedder per tenant 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“¥ Primo embedder - creazione per tenant 015007d9-d413-11ef-86a5-96000228e7fe
ğŸš€ CREATING FRESH EMBEDDER per tenant 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ›ï¸ Configurazioni AI saranno salvate su DATABASE MySQL
ğŸ›ï¸ AIConfigurationService inizializzato
   ï¿½ Backend: DATABASE MySQL
   ğŸ”‘ OpenAI API Key: âœ… Configurata
ğŸ”„ DatabaseAI: ModalitÃ  legacy - risolvo tenant_id 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ”§ FORCE NO CACHE: Bypass cache per tenant 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ”¥ FORCE NO CACHE: Bypasso cache e leggo DIRETTAMENTE dal database per tenant 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” [DEBUG] Query eseguita per tenant_id: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” [DEBUG] Risultato database: {'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'tenant_slug': 'humanitas', 'embedding_engine': 'labse', 'llm_engine': 'mistral:7b', 'embedding_config': None, 'llm_config': None, 'is_active': 1, 'updated_at': datetime.datetime(2025, 8, 28, 16, 51, 54)}
ğŸ” [DEBUG AIConfig] db_config ricevuto: {'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'tenant_slug': 'humanitas', 'embedding_engine': 'labse', 'llm_engine': 'mistral:7b', 'is_active': 1, 'updated_at': datetime.datetime(2025, 8, 28, 16, 51, 54), 'embedding_config': {}, 'llm_config': {}}
ğŸ” [DEBUG AIConfig] llm_engine nel db_config: mistral:7b
ğŸ” SIMPLE MANAGER: Engine da DB per 015007d9-d413-11ef-86a5-96000228e7fe = 'labse'
ğŸ¯ Engine configurato: labse
ğŸ”§ DIRECT CREATE: labse
ğŸ³ Tentativo connessione a servizio LaBSE dockerizzato...
ğŸ”— LaBSE Remote Client inizializzato
   ğŸ“¡ Service URL: http://localhost:8081
   â±ï¸  Timeout: 300s
   ğŸ”„ Max retries: 3
   ğŸ›¡ï¸ Fallback locale: True
ğŸ”§ Inizializzazione client remoto LaBSE...
âœ… Servizio embedding online e funzionante
âœ… Client remoto LaBSE inizializzato con successo
âœ… LaBSE Remote Client configurato con successo
âœ… FRESH EMBEDDER creato: LaBSERemoteClient per tenant 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ§  Inizializzazione dedupplicatore intelligente...
ğŸ’¾ [FASE 1: INIZIALIZZAZIONE] Caricamento memoria semantica...
ğŸ”„ Caricamento memoria semantica dal database...
ğŸ”„ Caricamento memoria semantica da MongoDB...
âœ… Connesso a MongoDB database: classificazioni
ğŸ“Š Recupero sessioni per tenant: Humanitas
   ğŸ“‚ Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“­ Nessuna classificazione trovata nel database MongoDB
ğŸ“­ Inizializzata memoria semantica vuota
   ğŸ“Š Campioni: 0
   ğŸ·ï¸ Tag: 0
âœ… [FASE 1: INIZIALIZZAZIONE] Completata in 4.93s
ğŸ¯ [FASE 1: INIZIALIZZAZIONE] Pipeline pronta per l'uso!
âœ… Pipeline 015007d9-d413-11ef-86a5-96000228e7fe inizializzata
ğŸš€ TRAINING SUPERVISIONATO CON DATASET COMPLETO
  ğŸ“Š Estrazione: TUTTE le discussioni dal database
  ğŸ§© Clustering: Su tutto il dataset disponibile
  ğŸ‘¤ Review umana: Max 500 sessioni rappresentative
ğŸ¯ Confidence threshold aggiornato a: 0.95
ğŸ“ TRAINING SUPERVISIONATO AVANZATO
ï¿½ NUOVA LOGICA:
  ğŸ”„ Estrazione: TUTTE le discussioni dal database
  ğŸ§© Clustering: Su tutto il dataset completo
  ğŸ‘¤ Review umana: Massimo 500 sessioni rappresentative
--------------------------------------------------
ğŸ“Š FASE 1: ESTRAZIONE COMPLETA DATASET

ï¿½ [FASE 2: ESTRAZIONE] Avvio estrazione sessioni...
ğŸ¥ [FASE 2: ESTRAZIONE] Tenant: humanitas
ğŸ“… [FASE 2: ESTRAZIONE] Giorni indietro: 7
ğŸ”„ [FASE 2: ESTRAZIONE] ModalitÃ  COMPLETA attivata
ğŸ¯ [FASE 2: ESTRAZIONE] Ignorando limite - estrazione totale dataset
ï¿½ [FASE 2: ESTRAZIONE] ModalitÃ : COMPLETA
ï¿½ [FASE 2: ESTRAZIONE] Connessione database...
ğŸ“Š [DEBUG ONLY_USER] Estrazione sessioni aggregate dal schema 'humanitas'...
ğŸ¯ [DEBUG ONLY_USER] Parametro only_user = False (tenant_id: 015007d9-d413-11ef-86a5-96000228e7fe)
ğŸ“„ [DEBUG ONLY_USER] Estrazione completa (senza limite)
ğŸ“„ [DEBUG ONLY_USER] Filtraggio standard: messaggi USER e AGENT
ğŸ” [DEBUG ONLY_USER] Esecuzione query per leggere conversazioni dal schema 'humanitas'...
ğŸ¯ [DEBUG ONLY_USER] Parametro only_user = False
ğŸ“‹ [DEBUG ONLY_USER] Filtro applicato: WHERE csm.said_by IN ('USER', 'AGENT')
Connessione al database MySQL stabilita con successo
âœ… [DEBUG ONLY_USER] Query eseguita con successo!
ğŸ“Š [DEBUG ONLY_USER] Totale righe: 21575
ğŸ‘¤ [DEBUG ONLY_USER] Messaggi USER: 10769
ğŸ¤– [DEBUG ONLY_USER] Messaggi AGENT: 10806
âœ… [DEBUG ONLY_USER] Filtro funziona correttamente!
âœ… Trovate 21575 righe da aggregare
ğŸ”„ [DEBUG ONLY_USER] Inizio generazione testo completo per 4303 sessioni
ğŸ” [DEBUG ONLY_USER] Sessione 0008ef4f-c2f4-4f5e-933e-646574f3638c: 3 USER, 3 AGENT
ğŸ“ [DEBUG ONLY_USER] Sessione 0008ef4f-c2f4-4f5e-933e-646574f3638c testo finale:
   [UTENTE] tags: 2
   [ASSISTENTE] tags: 2
   Lunghezza testo: 554 caratteri
ğŸ” [DEBUG ONLY_USER] Sessione 000b61d7-4431-40d2-b83c-9abbb70c98be: 4 USER, 4 AGENT
ğŸ“ [DEBUG ONLY_USER] Sessione 000b61d7-4431-40d2-b83c-9abbb70c98be testo finale:
   [UTENTE] tags: 3
   [ASSISTENTE] tags: 3
   Lunghezza testo: 1133 caratteri
ğŸ” [DEBUG ONLY_USER] Sessione 00160700-ac7f-463d-8fa0-fe57f74a73e6: 4 USER, 4 AGENT
âœ… Aggregate 4303 sessioni uniche
ğŸ”„ Saltati 8606 messaggi di benvenuto (primi 2 per sessione)
ğŸ”„ Sessioni vuote (solo benvenuto): 906
ğŸ“¥ [FASE 2: ESTRAZIONE] Sessioni grezze: 4303
ğŸ” [FASE 2: ESTRAZIONE] Filtraggio sessioni...
ğŸ” Filtraggio sessioni vuote/irrilevanti...
âœ… Filtro completato:
  ğŸ“Š Sessioni originali: 4303
  âŒ Sessioni scartate: 906
  âœ… Sessioni valide: 3397
âœ… [FASE 2: ESTRAZIONE] Completata in 0.67s
ğŸ“Š [FASE 2: ESTRAZIONE] Dataset completo: 3397 sessioni
ğŸ—‘ï¸ [FASE 2: ESTRAZIONE] Filtrate: 906 sessioni vuote/irrilevanti
ğŸ¯ [FASE 2: ESTRAZIONE] Pronte per clustering completo
âœ… Dataset completo: 3397 sessioni totali

ğŸ“Š FASE 2: CLUSTERING COMPLETO

ğŸš€ [FASE 4: CLUSTERING] Avvio clustering intelligente...
ğŸ“Š [FASE 4: CLUSTERING] Dataset: 3397 sessioni
ğŸ¯ [FASE 4: CLUSTERING] ModalitÃ : INTELLIGENTE
ğŸ§  [FASE 4: CLUSTERING] Clustering incrementale (se possibile)...

ğŸš€ [FASE 3: EMBEDDINGS] Avvio generazione embeddings...
ï¿½ [FASE 3: EMBEDDINGS] Dataset: 3397 sessioni
ğŸ“Š [FASE 3: EMBEDDINGS] Caratteristiche testo:
   ğŸ“ Lunghezza media: 1012 caratteri
   ğŸ“ Lunghezza massima: 29104 caratteri
   ğŸ“ Lunghezza minima: 75 caratteri
ğŸ§  [FASE 3: EMBEDDINGS] Generazione embeddings...
ğŸ”„ LAZY LOADING: Caricamento embedder dinamico per tenant 'humanitas'
ğŸ¯ SimpleEmbeddingManager inizializzato
ğŸ”„ SIMPLE MANAGER: Normalizzato 'humanitas' -> '015007d9-d413-11ef-86a5-96000228e7fe'
ğŸ¯ SIMPLE MANAGER: Richiesta embedder per tenant 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“¥ Primo embedder - creazione per tenant 015007d9-d413-11ef-86a5-96000228e7fe
ğŸš€ CREATING FRESH EMBEDDER per tenant 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ›ï¸ Configurazioni AI saranno salvate su DATABASE MySQL
ğŸ›ï¸ AIConfigurationService inizializzato
   ï¿½ Backend: DATABASE MySQL
   ğŸ”‘ OpenAI API Key: âœ… Configurata
ğŸ”„ DatabaseAI: ModalitÃ  legacy - risolvo tenant_id 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ”§ FORCE NO CACHE: Bypass cache per tenant 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ”¥ FORCE NO CACHE: Bypasso cache e leggo DIRETTAMENTE dal database per tenant 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” [DEBUG] Query eseguita per tenant_id: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” [DEBUG] Risultato database: {'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'tenant_slug': 'humanitas', 'embedding_engine': 'labse', 'llm_engine': 'mistral:7b', 'embedding_config': None, 'llm_config': None, 'is_active': 1, 'updated_at': datetime.datetime(2025, 8, 28, 16, 51, 54)}
ğŸ” [DEBUG AIConfig] db_config ricevuto: {'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'tenant_slug': 'humanitas', 'embedding_engine': 'labse', 'llm_engine': 'mistral:7b', 'is_active': 1, 'updated_at': datetime.datetime(2025, 8, 28, 16, 51, 54), 'embedding_config': {}, 'llm_config': {}}
ğŸ” [DEBUG AIConfig] llm_engine nel db_config: mistral:7b
ğŸ” SIMPLE MANAGER: Engine da DB per 015007d9-d413-11ef-86a5-96000228e7fe = 'labse'
ğŸ¯ Engine configurato: labse
ğŸ”§ DIRECT CREATE: labse
ğŸ³ Tentativo connessione a servizio LaBSE dockerizzato...
ğŸ”— LaBSE Remote Client inizializzato
   ğŸ“¡ Service URL: http://localhost:8081
   â±ï¸  Timeout: 300s
   ğŸ”„ Max retries: 3
   ğŸ›¡ï¸ Fallback locale: True
ğŸ”§ Inizializzazione client remoto LaBSE...
âœ… Servizio embedding online e funzionante
âœ… Client remoto LaBSE inizializzato con successo
âœ… LaBSE Remote Client configurato con successo
âœ… FRESH EMBEDDER creato: LaBSERemoteClient per tenant 015007d9-d413-11ef-86a5-96000228e7fe
âœ… Embedder caricato per tenant UUID 'humanitas': LaBSERemoteClient
ğŸ“¡ Richiesta embedding remoto per 3397 testi...
âœ… Embedding remoto completato in 6.915s
   ğŸ“Š Shape: (3397, 768)
   âš¡ Tempo servizio: 3.420s
âœ… [FASE 3: EMBEDDINGS] Completata in 7.08s
ğŸ“ˆ [FASE 3: EMBEDDINGS] Shape: (3397, 768)
âš¡ [FASE 3: EMBEDDINGS] Throughput: 480.1 testi/secondo

ğŸ“Š FASE 2A: TRAINING BERTOPIC ANTICIPATO

ğŸš€ TRAINING BERTOPIC ANTICIPATO (NUOVO FLUSSO OTTIMIZZATO):
   ğŸ“Š Dataset completo: 3397 sessioni
   ğŸ“Š Embeddings shape: (3397, 768)
   ğŸ¯ Addestramento su TUTTO il dataset per features ottimali
   ğŸ”¥ Esecuzione bertopic_provider.fit() su dataset completo...
ğŸ“Š BERTopic training su 3397 campioni
   ğŸ¯ Embedder configurato: LaBSERemoteClient
   ğŸ”§ STRATEGIA: BERTopic userÃ  embedder personalizzato via wrapper
   âœ… Wrapper embedder creato per BERTopic
   ğŸ”§ BERTopic userÃ  embedder personalizzato interno
âœ… BERTopic FIT completato su 3397 campioni
   ğŸ”§ SVD Training: Usando embedder personalizzato interno
âœ… SVD addestrato su full probas (k=20)
   âœ… BERTopic FIT completato in 40.77 secondi
   ğŸ”„ Esecuzione bertopic_provider.transform() per features extraction...
ğŸ”§ Transform: BERTopic userÃ  embedder personalizzato interno
   âœ… BERTopic TRANSFORM completato in 4.44 secondi
   ğŸ“Š Topic probabilities shape: (3397, 20)
   ğŸ“Š One-hot shape: None
   âœ… BERTopic provider addestrato con successo su 3397 sessioni
   âœ… BERTopic provider disponibile per augmentation features
   ğŸ”— BERTopic model assegnato al trainer per validazione ALTRO

ğŸ“Š FASE 2B: CLUSTERING HDBSCAN
ğŸ§  Usando clustering INTELLIGENTE (LLM + ML senza pattern)
ğŸ—‚ï¸  [DEBUG] Caricamento config tenant-specific: /home/ubuntu/classificatore/tenant_configs/015007d9-d413-11ef-86a5-96000228e7fe_clustering.yaml
ğŸ—‚ï¸  [DEBUG] Config tenant caricato: ['allow_single_cluster', 'alpha', 'cluster_selection_epsilon', 'cluster_selection_method', 'max_cluster_size', 'metric', 'min_cluster_size', 'min_samples', 'only_user', 'umap_metric', 'umap_min_dist', 'umap_n_components', 'umap_n_neighbors', 'umap_random_state', 'use_umap']
ğŸ—‚ï¸  [DEBUG] UMAP config finale: use_umap=True, n_components=100, min_dist=0.05
ğŸ§  Clustering intelligente configurato:
   ğŸ¯ Categorie intent suggerite: 12
   ğŸ¤– LLM primario: True
   ğŸ“Š Min confidence: 0.8
   ğŸ“ˆ Min conversations per intent: 2
   ğŸ‘¥ Rappresentanti diversificati: True
   ğŸ”¢ Max rappresentanti per cluster: 5
   ğŸ¤ Strategia consenso: majority
ğŸ§  Avvio clustering intelligente OTTIMIZZATO di 3397 conversazioni...
ğŸ“Š Fase 1: Clustering semantico con HDBSCAN...
ğŸ”§ HDBSCANClusterer inizializzato:
   min_cluster_size: 21
   min_samples: 14
   metric: euclidean
   cluster_selection_epsilon: 0.13
   ğŸ—‚ï¸  UMAP enabled: True
     ğŸ“ n_neighbors: 15
     ğŸ“ min_dist: 0.05
     ğŸ“Š n_components: 100
     ğŸ¯ metric: cosine
   ğŸš€ GPU enabled: True
   ğŸ’¾ GPU memory limit: 80%
   ğŸ”„ CPU fallback: True
   âš ï¸  [GPU MODE] Limitazioni cuML HDBSCAN:
     ğŸš« leaf_size=40 sarÃ  IGNORATO su GPU
     âœ… Parametri supportati: cluster_selection_method, alpha, allow_single_cluster
ğŸ¯ [DEBUG REACT] Parametri configurati:
   cluster_selection_method: eom
   alpha: 1.0
   allow_single_cluster: False
ğŸ” Clustering HDBSCAN su 3397 embedding (19.9MB)...
âš™ï¸  Parametri: min_cluster_size=21, min_samples=14, metric=euclidean
ğŸ“Š [DEBUG FIT_PREDICT] Embedding input:
   ğŸ“ Shape: (3397, 768)
   ğŸ”¢ Dtype: float64
   ğŸ“ˆ Range: [-0.1284, 0.0954]
   ğŸ’¾ Memory: 19.9MB

ğŸ—‚ï¸  [DEBUG FIT_PREDICT] STEP 1: Controllo applicazione UMAP...
ğŸ” [DEBUG UMAP] Controllo condizioni applicazione UMAP...
   âœ… self.use_umap = True
   âœ… UMAP_AVAILABLE = True
ï¿½ [DEBUG UMAP] UMAP ABILITATO - Iniziando riduzione dimensionale...
   ğŸ“ Dimensioni input: (3397, 768)
   ğŸ”¢ Tipo dati input: float64
   ğŸ“Š Range valori input: [-0.1284, 0.0954]
   ğŸ¯ Parametri UMAP configurati:
     ğŸ“ n_neighbors: 15
     ğŸ“ min_dist: 0.05
     ğŸ”¢ n_components: 100
     ğŸ“ˆ metric: cosine
     ğŸ² random_state: 42
ğŸ”§ [DEBUG UMAP] Inizializzazione riduttore UMAP...
ğŸ†• [DEBUG UMAP] ModalitÃ  TRAINING - fit nuovo reducer
âœ… [DEBUG UMAP] Riduttore UMAP inizializzato con successo
â³ [DEBUG UMAP] Applicazione fit_transform agli embeddings...
UMAP(angular_rp_forest=True, metric='cosine', min_dist=0.05, n_components=100, n_jobs=1, random_state=42, verbose=True)
Sun Aug 31 08:50:37 2025 Construct fuzzy simplicial set
Sun Aug 31 08:50:51 2025 Finding Nearest Neighbors
Sun Aug 31 08:50:52 2025 Finished Nearest Neighbor Search
Sun Aug 31 08:50:52 2025 Construct embedding
	completed  0  /  500 epochs
	completed  50  /  500 epochs
	completed  100  /  500 epochs
	completed  150  /  500 epochs
	completed  200  /  500 epochs
	completed  250  /  500 epochs
	completed  300  /  500 epochs
	completed  350  /  500 epochs
	completed  400  /  500 epochs
	completed  450  /  500 epochs
Sun Aug 31 08:51:02 2025 Finished embedding
âœ… [DEBUG UMAP] UMAP COMPLETATO con SUCCESSO in 25.68s
   ğŸ“ Dimensioni output: (3397, 100)
   ï¿½ Tipo dati output: float32
   ï¿½ğŸ“Š Range valori output: [-2.5495, 10.8164]
   ğŸ“ˆ Riduzione dimensionale: 768 â†’ 100 dimensioni
   ğŸ“‰ Fattore riduzione: 7.7x
âœ… [DEBUG UMAP] RIDUZIONE DIMENSIONALE CONFERMATA
âœ… [DEBUG UMAP] Nessun NaN nel risultato UMAP
âœ… [DEBUG UMAP] Nessun valore infinito nel risultato UMAP
ğŸ“Š [DEBUG UMAP] DiversitÃ  embeddings ridotti: 3397/3397 righe uniche
âœ… [DEBUG UMAP] Buona diversitÃ  negli embeddings ridotti
ğŸ“‹ [DEBUG UMAP] Info riduzione salvate nel clusterer
ğŸ“‹ [DEBUG FIT_PREDICT] Risultato UMAP:
   âœ… UMAP applicato: True
   ğŸ“ Shape post-UMAP: (3397, 100)
   ğŸ“ˆ Range post-UMAP: [-2.5495, 10.8164]
   â±ï¸  Tempo riduzione: 25.68s

ğŸ”§ [DEBUG FIT_PREDICT] STEP 2: Normalizzazione per metrica euclidean...
   ğŸ¯ Nessuna normalizzazione necessaria per metrica euclidean
   ğŸ“ Shape finale per clustering: (3397, 100)
   ğŸ“ˆ Range finale: [-2.5495, 10.8164]
   ğŸ¯ Metrica effettiva clustering: euclidean
ğŸ’¾ Memoria GPU: 17.7GB disponibili, 0.1GB necessari
ğŸš€ Utilizzo GPU per clustering accelerato

ğŸš€ [DEBUG FIT_PREDICT] STEP 3: Avvio clustering...
   ğŸ–¥ï¸  ModalitÃ : GPU
ï¿½ [GPU CLUSTERING] Inizializzazione cuML HDBSCAN con parametri supportati...

âœ… [DEBUG FIT_PREDICT] CLUSTERING COMPLETATO in 0.11s con ğŸš€ GPU!
ğŸ“Š Risultati finali:
   ğŸ¯ Cluster trovati: 39
   ğŸ” Outlier: 871 (25.6%)
   ğŸ“ˆ Silhouette score: 0.678

ğŸ“‹ [DEBUG FIT_PREDICT] RIEPILOGO TRASFORMAZIONI:
   ğŸ”¤ Input originale: (3397, 768)
   ğŸ—‚ï¸  Dopo UMAP: (3397, 100)
   ğŸ”§ Dopo normalizzazione: (3397, 100)
   ğŸ¯ Utilizzato per clustering: (3397, 100) con metrica euclidean
   ğŸ“ˆ Cluster HDBSCAN trovati: 39
   ğŸ” Outliers: 871
ğŸ‘¥ Fase 2: Selezione rappresentanti per cluster...
   ï¿½ Cluster 0: 134 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 1: 44 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 2: 34 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 3: 302 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 4: 96 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 5: 59 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 6: 24 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 7: 155 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 8: 38 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 9: 28 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 10: 49 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 11: 96 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 12: 63 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 13: 56 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 14: 40 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 15: 41 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 16: 97 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 17: 25 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 18: 21 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 19: 26 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 20: 51 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 21: 172 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 22: 33 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 23: 28 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 24: 102 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 25: 58 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 26: 35 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 27: 99 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 28: 32 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 29: 29 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 30: 29 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 31: 98 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 32: 71 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 33: 99 sessioni, 5 rappresentanti selezionati
   ï¿½ Cluster 34: 48 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 35: 39 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 36: 23 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 37: 30 sessioni, 4 rappresentanti selezionati
   ï¿½ Cluster 38: 22 sessioni, 4 rappresentanti selezionati
ğŸ¤– Fase 3: Analisi LLM di 173 rappresentanti...
ğŸ¤– Analisi LLM di 173 conversazioni...
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 274
   ğŸ“Š Token totali: 723
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 723 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 274
   ğŸ“Š Token conversazione finale: 274
   ğŸ“Š Token totali: 723
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 910 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno [ASSISTENTE] Buongiorno! Come posso esserti utile? [UTENTE] Dovrei prenotare un viaggio tramite Italo [UTENTE] come posso fare [ASSISTENTE] Per prenotare un viaggio tramite Italo, puoi contattare lâ€™ufficio viaggi di Humanitas utilizzando il form dedicato disponibile alla pagin..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2856 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 274
   ğŸ“Š Token totali stimati: 723
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno [ASSISTENTE] Buongiorno! Come posso esserti utile? [UTENTE] Dovrei prenotare un viaggio tramite Italo [UTENTE] come posso fare [ASSISTENTE] Per prenotare un viaggio tramite Italo, puoi contattare lâ€™ufficio viaggi di Humanitas utilizzando il form dedicato disponibile alla pagin..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 244
   ğŸ“Š Token totali: 693
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 693 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 244
   ğŸ“Š Token conversazione finale: 244
   ğŸ“Š Token totali: 693
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 757 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Devo venire al padiglione 2 cancer center. [...] it/info/come-raggiungere-humanitas/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2660 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 244
   ğŸ“Š Token totali stimati: 693
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Devo venire al padiglione 2 cancer center. [...] it/info/come-raggiungere-humanitas/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 85
   ğŸ“Š Token totali: 513
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 513 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 85
   ğŸ“Š Token conversazione finale: 85
   ğŸ“Š Token totali: 513
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 267 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] La linea 220 Ã¨ extraurbana? [ASSISTENTE] SÃ¬, la linea 220 Ã¨ una linea extraurbana che collega Humanitas con Pieve Emanuele, Opera e Locate, partendo da Rozzano, via della SolidarietÃ ã€6:0â€ scraped_https___www.humanitas.it_info_come-raggiungere-humanitas.jsonã€‘."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2737 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 85
   ğŸ“Š Token totali stimati: 513
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] La linea 220 Ã¨ extraurbana? [ASSISTENTE] SÃ¬, la linea 220 Ã¨ una linea extraurbana che collega Humanitas con Pieve Emanuele, Opera e Locate, partendo da Rozzano, via della SolidarietÃ ã€6:0â€ scraped_https___www.humanitas.it_info_come-raggiungere-humanitas.jsonã€‘."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Utente confuso - semplifica classificazione verso problemi tecnici

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 452
   ğŸ’¬ Token conversazione: 191
   ğŸ“Š Token totali: 643
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 643 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 452
   ğŸ“Š Token conversazione originale: 191
   ğŸ“Š Token conversazione finale: 191
   ğŸ“Š Token totali: 643
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 614 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] il parcheggio per 2 ore e 35 minuti mi Ã¨ stato fatto pagare 9,50 quando la tariffa massima risulta 8 euro [ASSISTENTE] Il costo massimo giornaliero per i parcheggi Humanitas (eccetto il Parcheggio 3) Ã¨ di 8 euro. [...]  Se hai bisogno di ulteriori dettagli, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2873 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 452
   ğŸ“Š Token conversazione: 191
   ğŸ“Š Token totali stimati: 643
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Utente confuso - semplifica classificazione verso problemi tecnici

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] il parcheggio per 2 ore e 35 minuti mi Ã¨ stato fatto pagare 9,50 quando la tariffa massima risulta 8 euro [ASSISTENTE] Il costo massimo giornaliero per i parcheggi Humanitas (eccetto il Parcheggio 3) Ã¨ di 8 euro. [...]  Se hai bisogno di ulteriori dettagli, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 582
   ğŸ“Š Token totali: 1030
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1030 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 582
   ğŸ“Š Token conversazione finale: 582
   ğŸ“Š Token totali: 1030
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1553 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] dove sono le vostre sedi? [ASSISTENTE] Le sedi di Humanitas sono distribuite in diverse regioni d'Italia. [...] 

Se hai bisogno di maggiori dettagli su una sede specifica, fammi sapere!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2696 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 582
   ğŸ“Š Token totali stimati: 1030
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] dove sono le vostre sedi? [ASSISTENTE] Le sedi di Humanitas sono distribuite in diverse regioni d'Italia. [...] 

Se hai bisogno di maggiori dettagli su una sede specifica, fammi sapere!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 338
   ğŸ“Š Token totali: 786
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 786 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 338
   ğŸ“Š Token conversazione finale: 338
   ğŸ“Š Token totali: 786
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1089 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao, vorrei prenotare un intervento in regime privato, come devo fare? [ASSISTENTE] Per prenotare un ricovero privato presso Humanitas, puoi contattare l'Ufficio Ricoveri Privati chiamando il numero 02 82 24 62 50, attivo dal lunedÃ¬ al venerdÃ¬ dalle 8:00 alle 17:00, oppure inviare un'em..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2848 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 338
   ğŸ“Š Token totali stimati: 786
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao, vorrei prenotare un intervento in regime privato, come devo fare? [ASSISTENTE] Per prenotare un ricovero privato presso Humanitas, puoi contattare l'Ufficio Ricoveri Privati chiamando il numero 02 82 24 62 50, attivo dal lunedÃ¬ al venerdÃ¬ dalle 8:00 alle 17:00, oppure inviare un'em..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 196
   ğŸ“Š Token totali: 644
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 644 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 196
   ğŸ“Š Token conversazione finale: 196
   ğŸ“Š Token totali: 644
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 629 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non ho ricevuto la documentazione della polizza"
Output: problema_amministrativo
Ragionamento: Problemi con documenti o questioni amministrative
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Volevo sapere se nel Building 8 c'Ã¨ una cappella e a che ora fanno la messa il sabato e la domenica  [ASSISTENTE] Nel Building 8 di Humanitas Ã¨ presente una cappella dedicata al culto cattolico situata al piano terra. [...]  Buona giornata!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2816 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 196
   ğŸ“Š Token totali stimati: 644
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non ho ricevuto la documentazione della polizza"
Output: problema_amministrativo
Ragionamento: Problemi con documenti o questioni amministrative
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Volevo sapere se nel Building 8 c'Ã¨ una cappella e a che ora fanno la messa il sabato e la domenica  [ASSISTENTE] Nel Building 8 di Humanitas Ã¨ presente una cappella dedicata al culto cattolico situata al piano terra. [...]  Buona giornata!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 363
   ğŸ“Š Token totali: 811
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 811 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 363
   ğŸ“Š Token conversazione finale: 363
   ğŸ“Š Token totali: 811
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1144 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao il bar al Building 2 quali orari osserva [ASSISTENTE] Il bar situato al primo piano del Building 2, in fondo al corridoio centrale, Ã¨ aperto tutti i giorni dalle 6:30 alle 21:00. [...] it/info/altri-servizi/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2805 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 363
   ğŸ“Š Token totali stimati: 811
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao il bar al Building 2 quali orari osserva [ASSISTENTE] Il bar situato al primo piano del Building 2, in fondo al corridoio centrale, Ã¨ aperto tutti i giorni dalle 6:30 alle 21:00. [...] it/info/altri-servizi/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 284
   ğŸ“Š Token totali: 732
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 732 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 284
   ğŸ“Š Token conversazione finale: 284
   ğŸ“Š Token totali: 732
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 895 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Divrei prenotare per nedicazione [ASSISTENTE] Potresti chiarire meglio cosa intendi per "nedicazione"? Intendi dire "medicazione" o "indicazione"? Oppure hai bisogno di prenotare una visita o un esame? [UTENTE] Medicazione per ferita che non cicatrizza [ASSISTENTE] Per prenotare una medi..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2805 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 284
   ğŸ“Š Token totali stimati: 732
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Divrei prenotare per nedicazione [ASSISTENTE] Potresti chiarire meglio cosa intendi per "nedicazione"? Intendi dire "medicazione" o "indicazione"? Oppure hai bisogno di prenotare una visita o un esame? [UTENTE] Medicazione per ferita che non cicatrizza [ASSISTENTE] Per prenotare una medi..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Utente confuso - semplifica classificazione verso problemi tecnici

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 452
   ğŸ’¬ Token conversazione: 305
   ğŸ“Š Token totali: 757
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 757 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 452
   ğŸ“Š Token conversazione originale: 305
   ğŸ“Š Token conversazione finale: 305
   ğŸ“Š Token totali: 757
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1026 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] Non riesco a registrarmi. [...] it**, indicando:
   - Nome e cognome
   - Codice fiscale
   - Motivo della richiesta di assistenza

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2760 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 452
   ğŸ“Š Token conversazione: 305
   ğŸ“Š Token totali stimati: 757
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Utente confuso - semplifica classificazione verso problemi tecnici

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] Non riesco a registrarmi. [...] it**, indicando:
   - Nome e cognome
   - Codice fiscale
   - Motivo della richiesta di assistenza

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 210
   ğŸ“Š Token totali: 658
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 658 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 210
   ğŸ“Š Token conversazione finale: 210
   ğŸ“Š Token totali: 658
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 731 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Inserire numero impegnative con giÃ  appuntamento  [ASSISTENTE] Potresti chiarire meglio la tua richiesta? Intendi dire che desideri sapere come inserire il numero di un'impegnativa per un appuntamento giÃ  prenotato? [UTENTE] Si [ASSISTENTE] Per inserire il numero di un'impegnativa per un..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2849 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 210
   ğŸ“Š Token totali stimati: 658
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Inserire numero impegnative con giÃ  appuntamento  [ASSISTENTE] Potresti chiarire meglio la tua richiesta? Intendi dire che desideri sapere come inserire il numero di un'impegnativa per un appuntamento giÃ  prenotato? [UTENTE] Si [ASSISTENTE] Per inserire il numero di un'impegnativa per un..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 327
   ğŸ“Š Token totali: 755
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 755 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 327
   ğŸ“Š Token conversazione finale: 327
   ğŸ“Š Token totali: 755
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1458 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] English please [ASSISTENTE] Sure! How can I assist you today? [UTENTE] Thank you! I am trying to start my log in at Humanitas Comunicazione Sicura but the system doesnt recognize my cell phone number [ASSISTENTE] If the system does not recognize your cell phone number when trying to log ..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2800 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 327
   ğŸ“Š Token totali stimati: 755
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] English please [ASSISTENTE] Sure! How can I assist you today? [UTENTE] Thank you! I am trying to start my log in at Humanitas Comunicazione Sicura but the system doesnt recognize my cell phone number [ASSISTENTE] If the system does not recognize your cell phone number when trying to log ..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 454
   ğŸ’¬ Token conversazione: 534
   ğŸ“Š Token totali: 988
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 988 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione originale: 534
   ğŸ“Š Token conversazione finale: 534
   ğŸ“Š Token totali: 988
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1858 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, non riesco a registrare mio padre al sito per poter poi prenotare [ASSISTENTE] Per registrare tuo padre al sito [Humanitas con te](https://www. [...]  

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2832 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione: 534
   ğŸ“Š Token totali stimati: 988
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, non riesco a registrare mio padre al sito per poter poi prenotare [ASSISTENTE] Per registrare tuo padre al sito [Humanitas con te](https://www. [...]  

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 381
   ğŸ“Š Token totali: 830
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 830 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 381
   ğŸ“Š Token conversazione finale: 381
   ğŸ“Š Token totali: 830
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1128 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Vorrei prenotare una visita urologica [ASSISTENTE] Per prenotare una visita urologica presso l'Istituto Clinico Humanitas, puoi utilizzare i seguenti canali di prenotazione:

1. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2788 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 381
   ğŸ“Š Token totali stimati: 830
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Vorrei prenotare una visita urologica [ASSISTENTE] Per prenotare una visita urologica presso l'Istituto Clinico Humanitas, puoi utilizzare i seguenti canali di prenotazione:

1. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 319
   ğŸ“Š Token totali: 747
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 747 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 319
   ğŸ“Š Token conversazione finale: 319
   ğŸ“Š Token totali: 747
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1078 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao  [ASSISTENTE] Ciao! Come posso esserti utile? ğŸ˜Š [UTENTE] Si  [ASSISTENTE] Perfetto! Dimmi pure, come posso aiutarti? ğŸ˜Š [UTENTE] ho prenotato per il 15 settembre con il Dr. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2683 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 319
   ğŸ“Š Token totali stimati: 747
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao  [ASSISTENTE] Ciao! Come posso esserti utile? ğŸ˜Š [UTENTE] Si  [ASSISTENTE] Perfetto! Dimmi pure, come posso aiutarti? ğŸ˜Š [UTENTE] ho prenotato per il 15 settembre con il Dr. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

ğŸ”§ Creazione MongoClassificationReader per cliente: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” Risoluzione tenant da UUID: 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
âœ… Tenant risolto (DB TAG locale): Humanitas (humanitas) UUID=015007d9-d413-11ef-86a5-96000228e7fe
âœ… Tenant risolto da UUID: Humanitas (015007d9-d413-11ef-86a5-96000228e7fe)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
âœ… MongoClassificationReader inizializzato per tenant: Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
   ğŸ¢ Database: classificazioni
âœ… MongoClassificationReader creato per tenant: Humanitas (humanitas)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
âœ… Connesso a MongoDB database: classificazioni
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
ğŸ” Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
ğŸ·ï¸ Recupero etichette per tenant: Humanitas
ğŸ“Š Calcolo statistiche per tenant: Humanitas
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 195
   ğŸ“Š Token totali: 623
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 623 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 195
   ğŸ“Š Token conversazione finale: 195
   ğŸ“Š Token totali: 623
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 661 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Dovrei effettuare una enteroscopia con biopsia Humatis effettua questo tipo di prestazione  e il costo in regime privato [ASSISTENTE] Humanitas effettua l'enteroscopia con biopsia, una procedura che consente di esaminare il piccolo intestino e prelevare campioni di tessuto per analisi is..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2779 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 195
   ğŸ“Š Token totali stimati: 623
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Dovrei effettuare una enteroscopia con biopsia Humatis effettua questo tipo di prestazione  e il costo in regime privato [ASSISTENTE] Humanitas effettua l'enteroscopia con biopsia, una procedura che consente di esaminare il piccolo intestino e prelevare campioni di tessuto per analisi is..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 407
   ğŸ“Š Token totali: 856
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 856 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 407
   ğŸ“Š Token conversazione finale: 407
   ğŸ“Š Token totali: 856
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1204 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, sono Fava Piera (05/07/48) paziente del cardiologo dr Carlo Ceriotti che mi ha visitata ila Rozzano il 25/06/25 prescrivendo ECOCARDIO di controllo da fare entro 6 mesi x importante patologia. [...] 

Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2851 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 407
   ğŸ“Š Token totali stimati: 856
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, sono Fava Piera (05/07/48) paziente del cardiologo dr Carlo Ceriotti che mi ha visitata ila Rozzano il 25/06/25 prescrivendo ECOCARDIO di controllo da fare entro 6 mesi x importante patologia. [...] 

Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 197
   ğŸ“Š Token totali: 645
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 645 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 197
   ğŸ“Š Token conversazione finale: 197
   ğŸ“Š Token totali: 645
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 608 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] cistiscopia [ASSISTENTE] Puoi chiarire meglio la tua richiesta? Intendi sapere:

1. [...]  

Se hai bisogno di ulteriori informazioni o assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2734 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 197
   ğŸ“Š Token totali stimati: 645
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] cistiscopia [ASSISTENTE] Puoi chiarire meglio la tua richiesta? Intendi sapere:

1. [...]  

Se hai bisogno di ulteriori informazioni o assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 180
   ğŸ“Š Token totali: 628
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 628 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 180
   ğŸ“Š Token conversazione finale: 180
   ğŸ“Š Token totali: 628
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 551 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Dove trovare informazioni per la preparazione di un ecoendoscopia pancreas [ASSISTENTE] Puoi trovare le norme di preparazione per l'ecoendoscopia del pancreas al seguente [link](https://www. [...]  ğŸ˜Š"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2780 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 180
   ğŸ“Š Token totali stimati: 628
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Dove trovare informazioni per la preparazione di un ecoendoscopia pancreas [ASSISTENTE] Puoi trovare le norme di preparazione per l'ecoendoscopia del pancreas al seguente [link](https://www. [...]  ğŸ˜Š"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 180
   ğŸ“Š Token totali: 628
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 628 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 180
   ğŸ“Š Token conversazione finale: 180
   ğŸ“Š Token totali: 628
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 604 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Volevo sapere se ci sono delle indicazioni da seguire dopo aver effettuato una PET globale corporea con Gallio [ASSISTENTE] Dopo aver effettuato una PET globale corporea con Gallio, Ã¨ importante evitare stretto contatto con donne in gravidanza, in etÃ  fertile o con minorenni per motivi d..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2851 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 180
   ğŸ“Š Token totali stimati: 628
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Volevo sapere se ci sono delle indicazioni da seguire dopo aver effettuato una PET globale corporea con Gallio [ASSISTENTE] Dopo aver effettuato una PET globale corporea con Gallio, Ã¨ importante evitare stretto contatto con donne in gravidanza, in etÃ  fertile o con minorenni per motivi d..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 94
   ğŸ“Š Token totali: 522
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 522 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 94
   ğŸ“Š Token conversazione finale: 94
   ğŸ“Š Token totali: 522
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 321 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Preparazione per coronografia  [ASSISTENTE] Per la preparazione alla coronarografia, Ã¨ necessario eseguire l'esame a digiuno e viene effettuato in regime di ricovero. [...] it/visite-ed-esami/coronarografia)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2725 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 94
   ğŸ“Š Token totali stimati: 522
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Preparazione per coronografia  [ASSISTENTE] Per la preparazione alla coronarografia, Ã¨ necessario eseguire l'esame a digiuno e viene effettuato in regime di ricovero. [...] it/visite-ed-esami/coronarografia)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 196
   ğŸ“Š Token totali: 645
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 645 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 196
   ğŸ“Š Token conversazione finale: 196
   ğŸ“Š Token totali: 645
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 618 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] ciao, cosa devo fare per questo esame che faro domani pomeriggio alla Gavazzeni ,tc coronarica e tc di perfusione miocardica [ASSISTENTE] Per la preparazione alla tomografia computerizzata con mezzo di contrasto e studio per perfusione coronarica con stress farmacologico (adenosina o reg..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2835 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 196
   ğŸ“Š Token totali stimati: 645
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] ciao, cosa devo fare per questo esame che faro domani pomeriggio alla Gavazzeni ,tc coronarica e tc di perfusione miocardica [ASSISTENTE] Per la preparazione alla tomografia computerizzata con mezzo di contrasto e studio per perfusione coronarica con stress farmacologico (adenosina o reg..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

ğŸ”§ Creazione MongoClassificationReader per cliente: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” Risoluzione tenant da UUID: 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
âœ… Tenant risolto (DB TAG locale): Humanitas (humanitas) UUID=015007d9-d413-11ef-86a5-96000228e7fe
âœ… Tenant risolto da UUID: Humanitas (015007d9-d413-11ef-86a5-96000228e7fe)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
âœ… MongoClassificationReader inizializzato per tenant: Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
   ğŸ¢ Database: classificazioni
âœ… MongoClassificationReader creato per tenant: Humanitas (humanitas)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
âœ… Connesso a MongoDB database: classificazioni
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
ğŸ” Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
ğŸ·ï¸ Recupero etichette per tenant: Humanitas
ğŸ“Š Calcolo statistiche per tenant: Humanitas
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 708
   ğŸ“Š Token totali: 1156
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1156 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 708
   ğŸ“Š Token conversazione finale: 708
   ğŸ“Š Token totali: 1156
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 2173 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] devo fare la colonscopia mi dici come mi devo preparare ? hai le norme ? [ASSISTENTE] Certamente! Puoi trovare le norme di preparazione alla colonscopia a questo [link](https://www. [...] it)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2761 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 708
   ğŸ“Š Token totali stimati: 1156
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] devo fare la colonscopia mi dici come mi devo preparare ? hai le norme ? [ASSISTENTE] Certamente! Puoi trovare le norme di preparazione alla colonscopia a questo [link](https://www. [...] it)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 513
   ğŸ“Š Token totali: 961
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 961 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 513
   ğŸ“Š Token conversazione finale: 513
   ğŸ“Š Token totali: 961
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1694 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Devo fare prelievo di sangue presso Humanitas Via Sardegna. [...] it/info/esami-di-laboratorio/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2647 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 513
   ğŸ“Š Token totali stimati: 961
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Devo fare prelievo di sangue presso Humanitas Via Sardegna. [...] it/info/esami-di-laboratorio/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 597
   ğŸ“Š Token totali: 1045
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1045 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 597
   ğŸ“Š Token conversazione finale: 597
   ğŸ“Š Token totali: 1045
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1791 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao dovrei prenotare presso il centro di rozzano queste analisi del sangue: VES, PCR, ANA, anticorpi anti DNA, Ab anti ENA, anticorpi anti SSA, SSB, RNP, centromero, Sm, Jo1, Sel 70) Ra test, Ab anti peptidi ciclici citrullinati, uricemia, TSH, Ab anti tireoglobulina, Ab anti tireoperos..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2908 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 597
   ğŸ“Š Token totali stimati: 1045
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao dovrei prenotare presso il centro di rozzano queste analisi del sangue: VES, PCR, ANA, anticorpi anti DNA, Ab anti ENA, anticorpi anti SSA, SSB, RNP, centromero, Sm, Jo1, Sel 70) Ra test, Ab anti peptidi ciclici citrullinati, uricemia, TSH, Ab anti tireoglobulina, Ab anti tireoperos..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Utente confuso - semplifica classificazione verso problemi tecnici

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 452
   ğŸ’¬ Token conversazione: 354
   ğŸ“Š Token totali: 806
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 806 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 452
   ğŸ“Š Token conversazione originale: 354
   ğŸ“Š Token conversazione finale: 354
   ğŸ“Š Token totali: 806
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1099 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta


TESTO DA CLASSIFICARE:
"[UTENTE] Farmacia interna domani? La settimana di Ferragosto a farmacia interna all'Humanitas di Rozzano Ã¨ chiusa? [ASSISTENTE] La Farmacia dellâ€™Istituto Clinico Humanitas di Rozzano Ã¨ aperta dal lunedÃ¬ al venerdÃ¬, dalle 8:30 alle 13:00 e dalle 14:00 alle 17:30, esclusi i giorni festivi. Durante ..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2837 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 452
   ğŸ“Š Token conversazione: 354
   ğŸ“Š Token totali stimati: 806
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Utente confuso - semplifica classificazione verso problemi tecnici

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta


TESTO DA CLASSIFICARE:
"[UTENTE] Farmacia interna domani? La settimana di Ferragosto a farmacia interna all'Humanitas di Rozzano Ã¨ chiusa? [ASSISTENTE] La Farmacia dellâ€™Istituto Clinico Humanitas di Rozzano Ã¨ aperta dal lunedÃ¬ al venerdÃ¬, dalle 8:30 alle 13:00 e dalle 14:00 alle 17:30, esclusi i giorni festivi. Durante ..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 77
   ğŸ“Š Token totali: 505
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 505 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 77
   ğŸ“Š Token conversazione finale: 77
   ğŸ“Š Token totali: 505
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 256 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Vorrei consegnare domani un campione di urine  [ASSISTENTE] Per consegnare un campione di urine, ti consiglio di contattare il numero 0282248230 per ottenere informazioni dettagliate. Se hai bisogno di ulteriori indicazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2736 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 77
   ğŸ“Š Token totali stimati: 505
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Vorrei consegnare domani un campione di urine  [ASSISTENTE] Per consegnare un campione di urine, ti consiglio di contattare il numero 0282248230 per ottenere informazioni dettagliate. Se hai bisogno di ulteriori indicazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 474
   ğŸ“Š Token totali: 922
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 922 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 474
   ğŸ“Š Token conversazione finale: 474
   ğŸ“Š Token totali: 922
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1553 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Vorrei sapere se sabato 30 settembre 2025 Ã¨ possibile fare gli esami del sangue Humanitas fiordaliso? [ASSISTENTE] Presso Humanitas Medical Care Rozzano-Fiordaliso, il sabato Ã¨ possibile effettuare prelievi del sangue dalle 7:30 alle 10:00 solo su prenotazione, e dalle 10:00 alle 11:00 c..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2878 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 474
   ğŸ“Š Token totali stimati: 922
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Vorrei sapere se sabato 30 settembre 2025 Ã¨ possibile fare gli esami del sangue Humanitas fiordaliso? [ASSISTENTE] Presso Humanitas Medical Care Rozzano-Fiordaliso, il sabato Ã¨ possibile effettuare prelievi del sangue dalle 7:30 alle 10:00 solo su prenotazione, e dalle 10:00 alle 11:00 c..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 157
   ğŸ“Š Token totali: 605
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 605 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 157
   ğŸ“Š Token conversazione finale: 157
   ğŸ“Š Token totali: 605
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 492 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] Ho bisogno di sapere gli orari di visita dell'ospedale nÌˆel wek and  [ASSISTENTE] Per visitare i pazienti ricoverati in Humanitas, gli orari di visita possono variare a seconda del reparto. Ti consiglio di consultare le pagine dedicate per maggiori dettagli:

- [Accesso all'Ospedale](htt..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2866 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 157
   ğŸ“Š Token totali stimati: 605
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] Ho bisogno di sapere gli orari di visita dell'ospedale nÌˆel wek and  [ASSISTENTE] Per visitare i pazienti ricoverati in Humanitas, gli orari di visita possono variare a seconda del reparto. Ti consiglio di consultare le pagine dedicate per maggiori dettagli:

- [Accesso all'Ospedale](htt..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 87
   ğŸ“Š Token totali: 515
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 515 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 87
   ğŸ“Š Token conversazione finale: 87
   ğŸ“Š Token totali: 515
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 279 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] a che ore siete aperti? [ASSISTENTE] Gli orari di apertura possono variare a seconda del servizio o del reparto che desideri visitare. Potresti specificare a quale servizio o reparto ti riferisci? Ad esempio, pronto soccorso, ufficio ritiro referti, punti prelievo, ecc."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2790 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 87
   ğŸ“Š Token totali stimati: 515
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] a che ore siete aperti? [ASSISTENTE] Gli orari di apertura possono variare a seconda del servizio o del reparto che desideri visitare. Potresti specificare a quale servizio o reparto ti riferisci? Ad esempio, pronto soccorso, ufficio ritiro referti, punti prelievo, ecc."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 143
   ğŸ“Š Token totali: 571
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 571 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 143
   ğŸ“Š Token conversazione finale: 143
   ğŸ“Š Token totali: 571
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 476 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao , quanto tempo passa da pre ricovero al ricovero?  [ASSISTENTE] Il tempo tra il prericovero e il ricovero dipende dalla valutazione clinica e dalla tipologia di intervento. [...] jsonã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2697 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 143
   ğŸ“Š Token totali stimati: 571
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao , quanto tempo passa da pre ricovero al ricovero?  [ASSISTENTE] Il tempo tra il prericovero e il ricovero dipende dalla valutazione clinica e dalla tipologia di intervento. [...] jsonã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 188
   ğŸ“Š Token totali: 636
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 636 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 188
   ğŸ“Š Token conversazione finale: 188
   ğŸ“Š Token totali: 636
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 663 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] La struttura Ã¨ convenzionata ma alcuni medici non lo sono Unisalute [ASSISTENTE] Se ti riferisci alla possibilitÃ  di prenotare visite o esami con Unisalute, Ã¨ importante sapere che alcune prestazioni potrebbero essere coperte dalla convenzione, mentre altre no. Inoltre, non tutti i medic..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2848 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 188
   ğŸ“Š Token totali stimati: 636
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] La struttura Ã¨ convenzionata ma alcuni medici non lo sono Unisalute [ASSISTENTE] Se ti riferisci alla possibilitÃ  di prenotare visite o esami con Unisalute, Ã¨ importante sapere che alcune prestazioni potrebbero essere coperte dalla convenzione, mentre altre no. Inoltre, non tutti i medic..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 204
   ğŸ“Š Token totali: 632
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 632 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 204
   ğŸ“Š Token conversazione finale: 204
   ğŸ“Š Token totali: 632
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 646 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] vorrei disdire un appuntamento [ASSISTENTE] Per disdire un appuntamento presso Humanitas, puoi seguire queste indicazioni:

1. [...] 

Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2683 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 204
   ğŸ“Š Token totali stimati: 632
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] vorrei disdire un appuntamento [ASSISTENTE] Per disdire un appuntamento presso Humanitas, puoi seguire queste indicazioni:

1. [...] 

Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 283
   ğŸ“Š Token totali: 711
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 711 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 283
   ğŸ“Š Token conversazione finale: 283
   ğŸ“Š Token totali: 711
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 916 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno Giulia Mi chiamo Valentina 120 Ho prenotato una visita e il breath test al glucosio per mercoledÃ¬ in viale Premuda ma mi sono accorta Mi sono ricordata che ho mangiato yogurt Quindi vorrei spostarla a settembre mi puÃ² aiutare e possibilmente del [ASSISTENTE] Per spostare la tu..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2782 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 283
   ğŸ“Š Token totali stimati: 711
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno Giulia Mi chiamo Valentina 120 Ho prenotato una visita e il breath test al glucosio per mercoledÃ¬ in viale Premuda ma mi sono accorta Mi sono ricordata che ho mangiato yogurt Quindi vorrei spostarla a settembre mi puÃ² aiutare e possibilmente del [ASSISTENTE] Per spostare la tu..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 166
   ğŸ“Š Token totali: 594
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 594 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 166
   ğŸ“Š Token conversazione finale: 166
   ğŸ“Š Token totali: 594
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 557 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] buongiorno ho fatto una prenotazione di visita oncologica con prof Santoro, ma siccome al sito mi sono iscritta a mio nome risulta a mio nome la prenr, ma sarebbe per mio babbo [ASSISTENTE] Per modificare i dati della prenotazione e associarla al nome corretto, ti consiglio di contattare..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2764 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 166
   ğŸ“Š Token totali stimati: 594
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] buongiorno ho fatto una prenotazione di visita oncologica con prof Santoro, ma siccome al sito mi sono iscritta a mio nome risulta a mio nome la prenr, ma sarebbe per mio babbo [ASSISTENTE] Per modificare i dati della prenotazione e associarla al nome corretto, ti consiglio di contattare..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 425
   ğŸ“Š Token totali: 853
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 853 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 425
   ğŸ“Š Token conversazione finale: 425
   ğŸ“Š Token totali: 853
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1383 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Ho prenotato un prelievo venoso tramite assicurazione per una data ma dovrei spostare l'appuntamento. [...]  Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2685 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 425
   ğŸ“Š Token totali stimati: 853
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Ho prenotato un prelievo venoso tramite assicurazione per una data ma dovrei spostare l'appuntamento. [...]  Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 276
   ğŸ“Š Token totali: 724
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 724 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 276
   ğŸ“Š Token conversazione finale: 276
   ğŸ“Š Token totali: 724
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 889 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno  [ASSISTENTE] Buongiorno! Come posso esserti utile? [UTENTE] Volevo sapere se lâ€™appuntamento che mi avete dato per 14 agosto posso farlo il 13 agosto alle 15 [ASSISTENTE] Non ho accesso alle informazioni personali o agli appuntamenti specifici. Per modificare un appuntamento, ..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2870 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 276
   ğŸ“Š Token totali stimati: 724
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno  [ASSISTENTE] Buongiorno! Come posso esserti utile? [UTENTE] Volevo sapere se lâ€™appuntamento che mi avete dato per 14 agosto posso farlo il 13 agosto alle 15 [ASSISTENTE] Non ho accesso alle informazioni personali o agli appuntamenti specifici. Per modificare un appuntamento, ..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 176
   ğŸ“Š Token totali: 625
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 625 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 176
   ğŸ“Š Token conversazione finale: 176
   ğŸ“Š Token totali: 625
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 644 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Devo modificare il numero di cellulare  [ASSISTENTE] Per modificare il numero di cellulare associato al tuo account o ai tuoi dati presso Humanitas, ti consiglio di accedere al portale [Humanitas con te](https://www. [...]  

Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2875 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 176
   ğŸ“Š Token totali stimati: 625
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Devo modificare il numero di cellulare  [ASSISTENTE] Per modificare il numero di cellulare associato al tuo account o ai tuoi dati presso Humanitas, ti consiglio di accedere al portale [Humanitas con te](https://www. [...]  

Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 316
   ğŸ“Š Token totali: 765
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 765 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 316
   ğŸ“Š Token conversazione finale: 316
   ğŸ“Š Token totali: 765
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1118 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste


TESTO DA CLASSIFICARE:
"[UTENTE] Buona sera Giulia  [ASSISTENTE] Buona sera! Come posso esserti utile? ğŸ˜Š [UTENTE] Allora, devo entrare nella sezione referti, perÃ² non posso piÃ¹ entrare, perchÃ© non ho piÃ¹ il vecchio numero e non posso neppure cambiare il numero ti telefono dal vecchio a quello nuovo, perchÃ© giustamente m..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2876 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 316
   ğŸ“Š Token totali stimati: 765
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste


TESTO DA CLASSIFICARE:
"[UTENTE] Buona sera Giulia  [ASSISTENTE] Buona sera! Come posso esserti utile? ğŸ˜Š [UTENTE] Allora, devo entrare nella sezione referti, perÃ² non posso piÃ¹ entrare, perchÃ© non ho piÃ¹ il vecchio numero e non posso neppure cambiare il numero ti telefono dal vecchio a quello nuovo, perchÃ© giustamente m..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 454
   ğŸ’¬ Token conversazione: 384
   ğŸ“Š Token totali: 838
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 838 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione originale: 384
   ğŸ“Š Token conversazione finale: 384
   ğŸ“Š Token totali: 838
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1305 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Non ho ricevuto la documentazione della polizza"
Output: problema_amministrativo
Ragionamento: Problemi con documenti o questioni amministrative


TESTO DA CLASSIFICARE:
"[UTENTE] Non riesco a impostare la ricezione di notifiche sullâ€™area referti  [ASSISTENTE] Per impostare la ricezione di notifiche sullâ€™area referti di [Humanitas con te](https://www. [...]  

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2809 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione: 384
   ğŸ“Š Token totali stimati: 838
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Non ho ricevuto la documentazione della polizza"
Output: problema_amministrativo
Ragionamento: Problemi con documenti o questioni amministrative


TESTO DA CLASSIFICARE:
"[UTENTE] Non riesco a impostare la ricezione di notifiche sullâ€™area referti  [ASSISTENTE] Per impostare la ricezione di notifiche sullâ€™area referti di [Humanitas con te](https://www. [...]  

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Utente confuso - semplifica classificazione verso problemi tecnici

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 452
   ğŸ’¬ Token conversazione: 93
   ğŸ“Š Token totali: 545
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 545 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 452
   ğŸ“Š Token conversazione originale: 93
   ğŸ“Š Token conversazione finale: 93
   ğŸ“Š Token totali: 545
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 322 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Hanno sbagliato il mio numero di telefono  [ASSISTENTE] Se il tuo numero di telefono Ã¨ stato registrato in modo errato, ti consiglio di contattare direttamente il servizio di assistenza o il reparto con cui hai avuto contatti per correggere l'errore. Se hai bisogno di ulteriori dettagli o s..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2811 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 452
   ğŸ“Š Token conversazione: 93
   ğŸ“Š Token totali stimati: 545
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Utente confuso - semplifica classificazione verso problemi tecnici

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Hanno sbagliato il mio numero di telefono  [ASSISTENTE] Se il tuo numero di telefono Ã¨ stato registrato in modo errato, ti consiglio di contattare direttamente il servizio di assistenza o il reparto con cui hai avuto contatti per correggere l'errore. Se hai bisogno di ulteriori dettagli o s..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 326
   ğŸ“Š Token totali: 774
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 774 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 326
   ğŸ“Š Token conversazione finale: 326
   ğŸ“Š Token totali: 774
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1023 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, volevo sapere che esami devo fare per prepararmi all' angio tac coronaricaÃ¹ [ASSISTENTE] Per sapere quali esami o preparazioni sono necessari per un'angio TAC coronarica, ti consiglio di consultare il tuo medico di fiducia o il medico che ti ha prescritto l'esame. Non posso f..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2881 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 326
   ğŸ“Š Token totali stimati: 774
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, volevo sapere che esami devo fare per prepararmi all' angio tac coronaricaÃ¹ [ASSISTENTE] Per sapere quali esami o preparazioni sono necessari per un'angio TAC coronarica, ti consiglio di consultare il tuo medico di fiducia o il medico che ti ha prescritto l'esame. Non posso f..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 85
   ğŸ“Š Token totali: 513
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 513 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 85
   ğŸ“Š Token conversazione finale: 85
   ğŸ“Š Token totali: 513
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 278 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] zyclara [ASSISTENTE] Non ho trovato informazioni specifiche su "Zyclara" nei documenti forniti. Se hai bisogno di dettagli su un farmaco o un trattamento, ti consiglio di consultare il tuo medico o farmacista di fiducia. Se hai ulteriori domande, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2778 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 85
   ğŸ“Š Token totali stimati: 513
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] zyclara [ASSISTENTE] Non ho trovato informazioni specifiche su "Zyclara" nei documenti forniti. Se hai bisogno di dettagli su un farmaco o un trattamento, ti consiglio di consultare il tuo medico o farmacista di fiducia. Se hai ulteriori domande, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 101
   ğŸ“Š Token totali: 549
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 549 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 101
   ğŸ“Š Token conversazione finale: 101
   ğŸ“Š Token totali: 549
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 339 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Nervo pudendo  [ASSISTENTE] Non ho trovato informazioni specifiche sul nervo pudendo nei documenti caricati. [...]  Se posso esserti utile in altro, fammi sapere!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2727 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 101
   ğŸ“Š Token totali stimati: 549
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Nervo pudendo  [ASSISTENTE] Non ho trovato informazioni specifiche sul nervo pudendo nei documenti caricati. [...]  Se posso esserti utile in altro, fammi sapere!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 126
   ğŸ“Š Token totali: 574
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 574 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 126
   ğŸ“Š Token conversazione finale: 126
   ğŸ“Š Token totali: 574
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 423 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] per l'impegnativa per per il prericovero Cosa bisogna scrivere come dicitura [ASSISTENTE] Per sapere cosa scrivere come dicitura sull'impegnativa per il prericovero, ti consiglio di consultare il tuo medico di base o lo specialista che ti ha prescritto il ricovero. Saranno loro a indicar..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2883 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 126
   ğŸ“Š Token totali stimati: 574
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] per l'impegnativa per per il prericovero Cosa bisogna scrivere come dicitura [ASSISTENTE] Per sapere cosa scrivere come dicitura sull'impegnativa per il prericovero, ti consiglio di consultare il tuo medico di base o lo specialista che ti ha prescritto il ricovero. Saranno loro a indicar..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 608
   ğŸ“Š Token totali: 1057
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1057 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 608
   ğŸ“Š Token conversazione finale: 608
   ğŸ“Š Token totali: 1057
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 2063 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Ho mal di pancia e sto cercando cosa fare [ASSISTENTE] Come assistente digitale di Humanitas, il mio scopo Ã¨ fornire informazioni di carattere generale e notizie inerenti lâ€™ospedale. Per il tuo mal di pancia, ti consiglio di rivolgerti al tuo medico di fiducia o al tuo medico di Medicina..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2836 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 608
   ğŸ“Š Token totali stimati: 1057
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Ho mal di pancia e sto cercando cosa fare [ASSISTENTE] Come assistente digitale di Humanitas, il mio scopo Ã¨ fornire informazioni di carattere generale e notizie inerenti lâ€™ospedale. Per il tuo mal di pancia, ti consiglio di rivolgerti al tuo medico di fiducia o al tuo medico di Medicina..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 591
   ğŸ“Š Token totali: 1040
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1040 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 591
   ğŸ“Š Token conversazione finale: 591
   ğŸ“Š Token totali: 1040
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1862 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Ginecomastia [UTENTE] uomo [ASSISTENTE] Ciao! Sono Giulia, lâ€™assistente digitale dellâ€™Istituto Clinico Humanitas. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2692 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 591
   ğŸ“Š Token totali stimati: 1040
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Ginecomastia [UTENTE] uomo [ASSISTENTE] Ciao! Sono Giulia, lâ€™assistente digitale dellâ€™Istituto Clinico Humanitas. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 475
   ğŸ“Š Token totali: 903
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 903 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 475
   ğŸ“Š Token conversazione finale: 475
   ğŸ“Š Token totali: 903
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 2111 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] hello [ASSISTENTE] Hello! How can I assist you today? [UTENTE] Do you provide alcoholism treatment? [ASSISTENTE] To determine if Humanitas provides treatment for alcoholism, I will need to check the available information. Please give me a moment.Humanitas provides treatment for condition..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2816 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 475
   ğŸ“Š Token totali stimati: 903
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] hello [ASSISTENTE] Hello! How can I assist you today? [UTENTE] Do you provide alcoholism treatment? [ASSISTENTE] To determine if Humanitas provides treatment for alcoholism, I will need to check the available information. Please give me a moment.Humanitas provides treatment for condition..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta urgente - valuta prioritÃ  massima

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 447
   ğŸ’¬ Token conversazione: 115
   ğŸ“Š Token totali: 562
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 562 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 447
   ğŸ“Š Token conversazione originale: 115
   ğŸ“Š Token conversazione finale: 115
   ğŸ“Š Token totali: 562
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 385 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao Giulia, cosa vuol dire ICE? [ASSISTENTE] "ICE" Ã¨ l'acronimo di "In Case of Emergency" (in caso di emergenza). [...]  

Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2772 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 447
   ğŸ“Š Token conversazione: 115
   ğŸ“Š Token totali stimati: 562
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta urgente - valuta prioritÃ  massima

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao Giulia, cosa vuol dire ICE? [ASSISTENTE] "ICE" Ã¨ l'acronimo di "In Case of Emergency" (in caso di emergenza). [...]  

Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 268
   ğŸ“Š Token totali: 717
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 717 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 268
   ğŸ“Š Token conversazione finale: 268
   ğŸ“Š Token totali: 717
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 778 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] devo prenotare in humanitas con ssn. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2646 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 268
   ğŸ“Š Token totali stimati: 717
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] devo prenotare in humanitas con ssn. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

   ğŸ“ˆ Progresso LLM: 50/173
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 311
   ğŸ“Š Token totali: 759
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 759 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 311
   ğŸ“Š Token conversazione finale: 311
   ğŸ“Š Token totali: 759
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 945 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non ho ricevuto la documentazione della polizza"
Output: problema_amministrativo
Ragionamento: Problemi con documenti o questioni amministrative
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Buonasera, avrei bisogno di sapere per mia mamma se possibile fare una RM addome sup senza e con MDC per gennaio, in convenzione ssn grazie  [ASSISTENTE] Per prenotare una Risonanza Magnetica (RM) dell'addome superiore senza e con mezzo di contrasto (MDC) in convenzione con il Servizio S..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2866 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 311
   ğŸ“Š Token totali stimati: 759
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non ho ricevuto la documentazione della polizza"
Output: problema_amministrativo
Ragionamento: Problemi con documenti o questioni amministrative
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Buonasera, avrei bisogno di sapere per mia mamma se possibile fare una RM addome sup senza e con MDC per gennaio, in convenzione ssn grazie  [ASSISTENTE] Per prenotare una Risonanza Magnetica (RM) dell'addome superiore senza e con mezzo di contrasto (MDC) in convenzione con il Servizio S..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 124
   ğŸ“Š Token totali: 573
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 573 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 124
   ğŸ“Š Token conversazione finale: 124
   ğŸ“Š Token totali: 573
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 434 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Ã¨ possibile eseguire una visita dermatologica in ssn a Castellanza? [ASSISTENTE] SÃ¬, Ã¨ possibile eseguire una visita dermatologica tramite il Servizio Sanitario Nazionale (SSN) presso Humanitas Mater Domini a Castellanza. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2832 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 124
   ğŸ“Š Token totali stimati: 573
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Ã¨ possibile eseguire una visita dermatologica in ssn a Castellanza? [ASSISTENTE] SÃ¬, Ã¨ possibile eseguire una visita dermatologica tramite il Servizio Sanitario Nazionale (SSN) presso Humanitas Mater Domini a Castellanza. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 1502
   ğŸ“Š Token totali: 1950
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1950 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 1502
   ğŸ“Š Token conversazione finale: 1502
   ğŸ“Š Token totali: 1950
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 4728 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] ciao giulia [ASSISTENTE] Ciao! Come posso esserti utile oggi? ğŸ˜Š [UTENTE] vorrei prenotare una colonscopia ma l'attesa telefonica Ã¨ troppo lunga e non ci sono posti [ASSISTENTE] Capisco la tua situazione. [...]  Buona giornata!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2775 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 1502
   ğŸ“Š Token totali stimati: 1950
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] ciao giulia [ASSISTENTE] Ciao! Come posso esserti utile oggi? ğŸ˜Š [UTENTE] vorrei prenotare una colonscopia ma l'attesa telefonica Ã¨ troppo lunga e non ci sono posti [ASSISTENTE] Capisco la tua situazione. [...]  Buona giornata!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 640
   ğŸ“Š Token totali: 1088
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1088 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 640
   ğŸ“Š Token conversazione finale: 640
   ğŸ“Š Token totali: 1088
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1975 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Dopo attesa di oltre 30 min Ãª caduta la linea. [...]  Buona giornata!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2627 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 640
   ğŸ“Š Token totali stimati: 1088
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Dopo attesa di oltre 30 min Ãª caduta la linea. [...]  Buona giornata!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 243
   ğŸ“Š Token totali: 691
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 691 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 243
   ğŸ“Š Token conversazione finale: 243
   ğŸ“Š Token totali: 691
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 800 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] Vorrei informazioni sui tempi dâ€™attesa del mio ricovero in urologia  [ASSISTENTE] Non ho accesso diretto alle informazioni personali o ai tempi di attesa specifici per i ricoveri. [...]  Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2843 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 243
   ğŸ“Š Token totali stimati: 691
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] Vorrei informazioni sui tempi dâ€™attesa del mio ricovero in urologia  [ASSISTENTE] Non ho accesso diretto alle informazioni personali o ai tempi di attesa specifici per i ricoveri. [...]  Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 567
   ğŸ“Š Token totali: 1016
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1016 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 567
   ğŸ“Š Token conversazione finale: 567
   ğŸ“Š Token totali: 1016
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1748 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno Giulia mi riferimento il Sig. [...] 

Se ha bisogno di ulteriore assistenza, sono qui per aiutarla!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2655 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 567
   ğŸ“Š Token totali stimati: 1016
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno Giulia mi riferimento il Sig. [...] 

Se ha bisogno di ulteriore assistenza, sono qui per aiutarla!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 521
   ğŸ“Š Token totali: 969
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 969 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 521
   ğŸ“Š Token conversazione finale: 521
   ğŸ“Š Token totali: 969
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1612 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno,  ho avuto un piccolo intervento alle ginocchia il 9 luglio 2025. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2696 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 521
   ğŸ“Š Token totali stimati: 969
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno,  ho avuto un piccolo intervento alle ginocchia il 9 luglio 2025. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 240
   ğŸ“Š Token totali: 668
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 668 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 240
   ğŸ“Š Token conversazione finale: 240
   ğŸ“Š Token totali: 668
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 809 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao Giulia noi a noi Ã¨ stato dato con le dimissioni protette di mio padre Fanara Giulio Ã¨ stato consegnato un letto con materasso antidecubito sedia a rotelle e un deambulatore non sappiamo a chi rivolgersi per poterli riconsegnare adesso che mio papÃ  Ã¨ s [ASSISTENTE] Mi dispiace per la..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2783 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 240
   ğŸ“Š Token totali stimati: 668
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao Giulia noi a noi Ã¨ stato dato con le dimissioni protette di mio padre Fanara Giulio Ã¨ stato consegnato un letto con materasso antidecubito sedia a rotelle e un deambulatore non sappiamo a chi rivolgersi per poterli riconsegnare adesso che mio papÃ  Ã¨ s [ASSISTENTE] Mi dispiace per la..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 310
   ğŸ“Š Token totali: 758
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 758 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 310
   ğŸ“Š Token conversazione finale: 310
   ğŸ“Š Token totali: 758
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1069 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, sono Barbara Capone di Napoli la nipote di un paziente ricoverato d'urgenza Giuseppe Capone, ora spostato nel reparto di Pneumologia in stato di elevata gravitÃ . [...]  Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2813 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 310
   ğŸ“Š Token totali stimati: 758
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, sono Barbara Capone di Napoli la nipote di un paziente ricoverato d'urgenza Giuseppe Capone, ora spostato nel reparto di Pneumologia in stato di elevata gravitÃ . [...]  Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 262
   ğŸ“Š Token totali: 690
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 690 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 262
   ğŸ“Š Token conversazione finale: 262
   ğŸ“Š Token totali: 690
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 886 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Avrei bisogno di una cartella clinica  [ASSISTENTE] Puoi richiedere la cartella clinica dei ricoveri svolti presso l'Istituto Clinico Humanitas in diversi modi:

1. [...]  Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2743 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 262
   ğŸ“Š Token totali stimati: 690
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Avrei bisogno di una cartella clinica  [ASSISTENTE] Puoi richiedere la cartella clinica dei ricoveri svolti presso l'Istituto Clinico Humanitas in diversi modi:

1. [...]  Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 375
   ğŸ“Š Token totali: 824
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 824 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 375
   ğŸ“Š Token conversazione finale: 375
   ğŸ“Š Token totali: 824
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1296 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] Come ritirare il referto di mia figlia minorenne? [ASSISTENTE] Per ritirare il referto di tua figlia minorenne, Ã¨ necessario seguire queste indicazioni:

1. [...]  

Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2810 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 375
   ğŸ“Š Token totali stimati: 824
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] Come ritirare il referto di mia figlia minorenne? [ASSISTENTE] Per ritirare il referto di tua figlia minorenne, Ã¨ necessario seguire queste indicazioni:

1. [...]  

Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 841
   ğŸ“Š Token totali: 1289
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1289 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 841
   ğŸ“Š Token conversazione finale: 841
   ğŸ“Š Token totali: 1289
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 2744 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi


TESTO DA CLASSIFICARE:
"[UTENTE] Buon pomeriggio [ASSISTENTE] Buon pomeriggio! Come posso esserti utile? [UTENTE] Vorrei sapere come poter richiedere la cartella clinica di mio padre inerente al suo ricovero al centro di riabilitazione Building 8 dal 17 ottobre 2024 al 26 maggio 2025 [ASSISTENTE] Per richiedere la carte..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2857 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 841
   ğŸ“Š Token totali stimati: 1289
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi


TESTO DA CLASSIFICARE:
"[UTENTE] Buon pomeriggio [ASSISTENTE] Buon pomeriggio! Come posso esserti utile? [UTENTE] Vorrei sapere come poter richiedere la cartella clinica di mio padre inerente al suo ricovero al centro di riabilitazione Building 8 dal 17 ottobre 2024 al 26 maggio 2025 [ASSISTENTE] Per richiedere la carte..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 683
   ğŸ“Š Token totali: 1132
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1132 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 683
   ğŸ“Š Token conversazione finale: 683
   ğŸ“Š Token totali: 1132
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 2399 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] buongiorno Senta io sono stato dimesso vediamo un po' 19:20 martedÃ¬ 22 maggio Adesso io voglio richiedere la cartella clinica e mi chiede nel seguendola la prassi succede solo a Pegaso che parla io no no come faccio ad avere la cartella clinica [ASSISTENTE] Puoi richiedere la cartella cl..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2841 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 683
   ğŸ“Š Token totali stimati: 1132
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] buongiorno Senta io sono stato dimesso vediamo un po' 19:20 martedÃ¬ 22 maggio Adesso io voglio richiedere la cartella clinica e mi chiede nel seguendola la prassi succede solo a Pegaso che parla io no no come faccio ad avere la cartella clinica [ASSISTENTE] Puoi richiedere la cartella cl..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 397
   ğŸ“Š Token totali: 846
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 846 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 397
   ğŸ“Š Token conversazione finale: 397
   ğŸ“Š Token totali: 846
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1280 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] ciao [ASSISTENTE] Ciao! Come posso esserti utile oggi? ğŸ˜Š [UTENTE] devo ritirare copia esami [ASSISTENTE] Per ritirare una copia degli esami, puoi seguire queste indicazioni:

1. [...]  

Posso aiutarti in altro? ğŸ˜Š"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2788 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 397
   ğŸ“Š Token totali stimati: 846
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] ciao [ASSISTENTE] Ciao! Come posso esserti utile oggi? ğŸ˜Š [UTENTE] devo ritirare copia esami [ASSISTENTE] Per ritirare una copia degli esami, puoi seguire queste indicazioni:

1. [...]  

Posso aiutarti in altro? ğŸ˜Š"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 168
   ğŸ“Š Token totali: 616
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 616 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 168
   ğŸ“Š Token conversazione finale: 168
   ğŸ“Š Token totali: 616
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 557 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Volevo sapere se a Rozzano effettuano la brachiterapia [ASSISTENTE] SÃ¬, presso l'Istituto Clinico Humanitas di Rozzano Ã¨ possibile effettuare trattamenti di radioterapia e radiochirurgia, che includono tecniche avanzate come la brachiterapia per specifiche patologie. [...] jsonã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2830 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 168
   ğŸ“Š Token totali stimati: 616
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Volevo sapere se a Rozzano effettuano la brachiterapia [ASSISTENTE] SÃ¬, presso l'Istituto Clinico Humanitas di Rozzano Ã¨ possibile effettuare trattamenti di radioterapia e radiochirurgia, che includono tecniche avanzate come la brachiterapia per specifiche patologie. [...] jsonã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 295
   ğŸ“Š Token totali: 743
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 743 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 295
   ğŸ“Š Token conversazione finale: 295
   ğŸ“Š Token totali: 743
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1024 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] Catarata  [ASSISTENTE] La cataratta Ã¨ una patologia oculare caratterizzata dall'opacizzazione del cristallino, la lente naturale dell'occhio, che porta a una progressiva riduzione della vista. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2772 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 295
   ğŸ“Š Token totali stimati: 743
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] Catarata  [ASSISTENTE] La cataratta Ã¨ una patologia oculare caratterizzata dall'opacizzazione del cristallino, la lente naturale dell'occhio, che porta a una progressiva riduzione della vista. [...] it/info/prenotazioni/)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 375
   ğŸ“Š Token totali: 803
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 803 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 375
   ğŸ“Š Token conversazione finale: 375
   ğŸ“Š Token totali: 803
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1248 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] termoablazione a radiofrequenza [ASSISTENTE] La termoablazione a radiofrequenza Ã¨ una tecnica utilizzata per trattare tumori in fase precoce o di piccole dimensioni, come quelli al fegato o ai reni. [...]  Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2740 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 375
   ğŸ“Š Token totali stimati: 803
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] termoablazione a radiofrequenza [ASSISTENTE] La termoablazione a radiofrequenza Ã¨ una tecnica utilizzata per trattare tumori in fase precoce o di piccole dimensioni, come quelli al fegato o ai reni. [...]  Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 389
   ğŸ“Š Token totali: 837
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 837 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 389
   ğŸ“Š Token conversazione finale: 389
   ğŸ“Š Token totali: 837
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1204 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] buonasera [ASSISTENTE] Buonasera! Come posso esserti utile? [UTENTE] dovrei effettuare una quadrectomia+bls [UTENTE] in regime assicurato [ASSISTENTE] La quadrectomia Ã¨ un intervento chirurgico che riguarda la rimozione di una parte del tessuto mammario, spesso associata al trattamento d..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2865 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 389
   ğŸ“Š Token totali stimati: 837
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] buonasera [ASSISTENTE] Buonasera! Come posso esserti utile? [UTENTE] dovrei effettuare una quadrectomia+bls [UTENTE] in regime assicurato [ASSISTENTE] La quadrectomia Ã¨ un intervento chirurgico che riguarda la rimozione di una parte del tessuto mammario, spesso associata al trattamento d..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 454
   ğŸ’¬ Token conversazione: 260
   ğŸ“Š Token totali: 714
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 714 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione originale: 260
   ğŸ“Š Token conversazione finale: 260
   ğŸ“Š Token totali: 714
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 824 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Non riesco a registrami su Humanitas con te [ASSISTENTE] Per registrarti su [Humanitas con te](https://www. [...] docxã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2708 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione: 260
   ğŸ“Š Token totali stimati: 714
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Non riesco a registrami su Humanitas con te [ASSISTENTE] Per registrarti su [Humanitas con te](https://www. [...] docxã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 430
   ğŸ“Š Token totali: 878
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 878 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 430
   ğŸ“Š Token conversazione finale: 430
   ğŸ“Š Token totali: 878
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1423 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao Giulia, come posso registrarmi al vostro portale? [ASSISTENTE] Per registrarti al portale [Humanitas con te](https://www. [...]  Buona giornata! ğŸ˜Š"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2727 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 430
   ğŸ“Š Token totali stimati: 878
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao Giulia, come posso registrarmi al vostro portale? [ASSISTENTE] Per registrarti al portale [Humanitas con te](https://www. [...]  Buona giornata! ğŸ˜Š"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 454
   ğŸ’¬ Token conversazione: 368
   ğŸ“Š Token totali: 822
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 822 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione originale: 368
   ğŸ“Š Token conversazione finale: 368
   ğŸ“Š Token totali: 822
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1178 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Non riesco ad accedere ne registrarmi al servizio  [ASSISTENTE] Se riscontri problemi con la registrazione o l'accesso al portale [Humanitas con te](https://www. [...] it/info/humanitas-con-te)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2782 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione: 368
   ğŸ“Š Token totali stimati: 822
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Non riesco ad accedere ne registrarmi al servizio  [ASSISTENTE] Se riscontri problemi con la registrazione o l'accesso al portale [Humanitas con te](https://www. [...] it/info/humanitas-con-te)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 231
   ğŸ“Š Token totali: 680
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 680 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 231
   ğŸ“Š Token conversazione finale: 231
   ğŸ“Š Token totali: 680
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 775 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao dovrei fare la registrazione per poi scaricare i referti delle visite che ho fatto come devo fare [ASSISTENTE] Per registrarti al portale [Humanitas con te](https://www. [...] docxã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2764 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 231
   ğŸ“Š Token totali stimati: 680
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao dovrei fare la registrazione per poi scaricare i referti delle visite che ho fatto come devo fare [ASSISTENTE] Per registrarti al portale [Humanitas con te](https://www. [...] docxã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta urgente - valuta prioritÃ  massima

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 447
   ğŸ’¬ Token conversazione: 221
   ğŸ“Š Token totali: 668
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 668 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 447
   ğŸ“Š Token conversazione originale: 221
   ğŸ“Š Token conversazione finale: 221
   ğŸ“Š Token totali: 668
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 771 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] Ho bisogno di sapere il mio codice ID Humanitas con te [ASSISTENTE] Per recuperare lâ€™ID di [Humanitas con te](https://www. [...]  

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2737 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 447
   ğŸ“Š Token conversazione: 221
   ğŸ“Š Token totali stimati: 668
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta urgente - valuta prioritÃ  massima

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] Ho bisogno di sapere il mio codice ID Humanitas con te [ASSISTENTE] Per recuperare lâ€™ID di [Humanitas con te](https://www. [...]  

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 115
   ğŸ“Š Token totali: 563
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 563 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 115
   ğŸ“Š Token conversazione finale: 115
   ğŸ“Š Token totali: 563
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 393 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Mi Ã¨ arrivato il messaggio che Ã¨ pronto il referto ma cosa mi serve per ritirarlo? [ASSISTENTE] Per ritirare il referto, ti servirÃ  il tagliando di promemoria ritiro referto rilasciato al momento dellâ€™accettazione (sia al totem che allo sportello). Questo tagliando contiene l'ID necessar..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2880 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 115
   ğŸ“Š Token totali stimati: 563
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Mi Ã¨ arrivato il messaggio che Ã¨ pronto il referto ma cosa mi serve per ritirarlo? [ASSISTENTE] Per ritirare il referto, ti servirÃ  il tagliando di promemoria ritiro referto rilasciato al momento dellâ€™accettazione (sia al totem che allo sportello). Questo tagliando contiene l'ID necessar..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 1063
   ğŸ“Š Token totali: 1491
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1491 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 1063
   ğŸ“Š Token conversazione finale: 1063
   ğŸ“Š Token totali: 1491
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 3525 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno dovrei richiedere il referto di una TAC del 28 febbraio 2025 sono Pedroli Marisa ma non ho il messaggio con il querrecode sa come posso fare gay [ASSISTENTE] Per richiedere il referto della TAC, puoi accedere al portale [Humanitas con te](https://www.humanitasconte.it). Se non..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2785 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 1063
   ğŸ“Š Token totali stimati: 1491
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno dovrei richiedere il referto di una TAC del 28 febbraio 2025 sono Pedroli Marisa ma non ho il messaggio con il querrecode sa come posso fare gay [ASSISTENTE] Per richiedere il referto della TAC, puoi accedere al portale [Humanitas con te](https://www.humanitasconte.it). Se non..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 274
   ğŸ“Š Token totali: 723
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 723 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 274
   ğŸ“Š Token conversazione finale: 274
   ğŸ“Š Token totali: 723
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 988 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste


TESTO DA CLASSIFICARE:
"[UTENTE] ho bisogno di recuperare il mio ID Huawei [ASSISTENTE] Non posso aiutarti con il recupero dell'ID Huawei, in quanto mi occupo esclusivamente di informazioni relative all'Istituto Clinico Humanitas. [...] it, indicando nome, cognome, codice fiscale e motivo della richiesta di assistenza"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2861 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 274
   ğŸ“Š Token totali stimati: 723
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste


TESTO DA CLASSIFICARE:
"[UTENTE] ho bisogno di recuperare il mio ID Huawei [ASSISTENTE] Non posso aiutarti con il recupero dell'ID Huawei, in quanto mi occupo esclusivamente di informazioni relative all'Istituto Clinico Humanitas. [...] it, indicando nome, cognome, codice fiscale e motivo della richiesta di assistenza"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 284
   ğŸ“Š Token totali: 732
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 732 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 284
   ğŸ“Š Token conversazione finale: 284
   ğŸ“Š Token totali: 732
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 964 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Sono  Bove Marianna  devo scaricare cartelle cliniche ma quando inserisco il codice id mi dice il dato inserito non Ã¨ corretto, prego ricontrollare. [...]  Se hai bisogno di ulteriore assistenza, fammi sapere!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2783 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 284
   ğŸ“Š Token totali stimati: 732
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Sono  Bove Marianna  devo scaricare cartelle cliniche ma quando inserisco il codice id mi dice il dato inserito non Ã¨ corretto, prego ricontrollare. [...]  Se hai bisogno di ulteriore assistenza, fammi sapere!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 181
   ğŸ“Š Token totali: 629
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 629 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 181
   ğŸ“Š Token conversazione finale: 181
   ğŸ“Š Token totali: 629
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 692 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao,vorrei sapere se ci sono degli incontri gratuiti dove spiegano tutto il percorso di inseminazione assistita,con ginecologi,psicologi [ASSISTENTE] Per quanto riguarda il percorso di inseminazione assistita, Humanitas offre un Fertility Center specializzato in procreazione medicalment..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2810 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 181
   ğŸ“Š Token totali stimati: 629
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao,vorrei sapere se ci sono degli incontri gratuiti dove spiegano tutto il percorso di inseminazione assistita,con ginecologi,psicologi [ASSISTENTE] Per quanto riguarda il percorso di inseminazione assistita, Humanitas offre un Fertility Center specializzato in procreazione medicalment..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 396
   ğŸ“Š Token totali: 824
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 824 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 396
   ğŸ“Š Token conversazione finale: 396
   ğŸ“Š Token totali: 824
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1212 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] PMA quali prestazioni? [ASSISTENTE] Le prestazioni di Procreazione Medicalmente Assistita (PMA) offerte presso Humanitas includono:

1. [...] it/centri/fertility-center)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2678 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 396
   ğŸ“Š Token totali stimati: 824
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] PMA quali prestazioni? [ASSISTENTE] Le prestazioni di Procreazione Medicalmente Assistita (PMA) offerte presso Humanitas includono:

1. [...] it/centri/fertility-center)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 697
   ğŸ“Š Token totali: 1145
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1145 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 697
   ğŸ“Š Token conversazione finale: 697
   ğŸ“Š Token totali: 1145
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 2276 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] ciao! ho bisogno di informazioni sulla crioconservazione degli ovociti [ASSISTENTE] La crioconservazione degli ovociti Ã¨ una tecnica che consente di preservare la fertilitÃ  congelando gli ovociti in azoto liquido. [...] 

Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2792 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 697
   ğŸ“Š Token totali stimati: 1145
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] ciao! ho bisogno di informazioni sulla crioconservazione degli ovociti [ASSISTENTE] La crioconservazione degli ovociti Ã¨ una tecnica che consente di preservare la fertilitÃ  congelando gli ovociti in azoto liquido. [...] 

Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 927
   ğŸ“Š Token totali: 1375
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1375 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 927
   ğŸ“Š Token conversazione finale: 927
   ğŸ“Š Token totali: 1375
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 3113 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] informazioni su p,a omologa [ASSISTENTE] Non ho trovato informazioni specifiche sulla "P. [...]  Se desideri ulteriori informazioni sui percorsi di PMA eterologa presso Humanitas, fammi sapere!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2741 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 927
   ğŸ“Š Token totali stimati: 1375
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] informazioni su p,a omologa [ASSISTENTE] Non ho trovato informazioni specifiche sulla "P. [...]  Se desideri ulteriori informazioni sui percorsi di PMA eterologa presso Humanitas, fammi sapere!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 124
   ğŸ“Š Token totali: 572
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 572 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 124
   ğŸ“Š Token conversazione finale: 124
   ğŸ“Š Token totali: 572
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 388 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno vorrei sapere se fate l'esame ANTICORPI ANTI PIASTRINE TEST DIRETTO [ASSISTENTE] Non ho trovato informazioni specifiche sull'esame "ANTICORPI ANTI PIASTRINE TEST DIRETTO" nei documenti forniti. [...]  Se hai bisogno di ulteriori dettagli o assistenza, fammi sapere!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2837 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 124
   ğŸ“Š Token totali stimati: 572
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno vorrei sapere se fate l'esame ANTICORPI ANTI PIASTRINE TEST DIRETTO [ASSISTENTE] Non ho trovato informazioni specifiche sull'esame "ANTICORPI ANTI PIASTRINE TEST DIRETTO" nei documenti forniti. [...]  Se hai bisogno di ulteriori dettagli o assistenza, fammi sapere!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 332
   ğŸ“Š Token totali: 760
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 760 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 332
   ğŸ“Š Token conversazione finale: 332
   ğŸ“Š Token totali: 760
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1136 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno eseguite esame del sangue per allergia nickel? [ASSISTENTE] Non ho trovato informazioni specifiche sull'esecuzione di un esame del sangue per l'allergia al nichel presso Humanitas. [...] it/malattie/allergia-al-nichel)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2702 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 332
   ğŸ“Š Token totali stimati: 760
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno eseguite esame del sangue per allergia nickel? [ASSISTENTE] Non ho trovato informazioni specifiche sull'esecuzione di un esame del sangue per l'allergia al nichel presso Humanitas. [...] it/malattie/allergia-al-nichel)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 138
   ğŸ“Š Token totali: 566
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 566 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 138
   ğŸ“Š Token conversazione finale: 138
   ğŸ“Š Token totali: 566
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 430 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] humanitas effettua l'holter cardiaco di 20 giorni? [ASSISTENTE] Non ho trovato informazioni specifiche sull'Holter cardiaco di 20 giorni presso Humanitas. [...] it/pazienti/diagnosi/esami-del-cuore-e-vascolari/7952-elettrocardiogramma)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2724 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 138
   ğŸ“Š Token totali stimati: 566
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] humanitas effettua l'holter cardiaco di 20 giorni? [ASSISTENTE] Non ho trovato informazioni specifiche sull'Holter cardiaco di 20 giorni presso Humanitas. [...] it/pazienti/diagnosi/esami-del-cuore-e-vascolari/7952-elettrocardiogramma)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 400
   ğŸ“Š Token totali: 848
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 848 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 400
   ğŸ“Š Token conversazione finale: 400
   ğŸ“Š Token totali: 848
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1288 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] buongiorno, come posso sapere se certi tipi di esami del sangue vengono fatti c'o vostra struttura [ASSISTENTE] Per sapere se un determinato esame del sangue viene effettuato presso la nostra struttura, posso verificare per te. Puoi dirmi il nome specifico dell'esame del sangue che ti in..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2855 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 400
   ğŸ“Š Token totali stimati: 848
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] buongiorno, come posso sapere se certi tipi di esami del sangue vengono fatti c'o vostra struttura [ASSISTENTE] Per sapere se un determinato esame del sangue viene effettuato presso la nostra struttura, posso verificare per te. Puoi dirmi il nome specifico dell'esame del sangue che ti in..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 137
   ğŸ“Š Token totali: 585
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 585 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 137
   ğŸ“Š Token conversazione finale: 137
   ğŸ“Š Token totali: 585
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 466 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] Oggi si possono fare esami del sangue all' Humanitas di Rozzano? [ASSISTENTE] Per sapere se oggi Ã¨ possibile effettuare esami del sangue presso l'Humanitas di Rozzano, ti consiglio di contattare direttamente il punto prelievi. Puoi trovare tutte le informazioni sui punti prelievi e gli o..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2866 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 137
   ğŸ“Š Token totali stimati: 585
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online


TESTO DA CLASSIFICARE:
"[UTENTE] Oggi si possono fare esami del sangue all' Humanitas di Rozzano? [ASSISTENTE] Per sapere se oggi Ã¨ possibile effettuare esami del sangue presso l'Humanitas di Rozzano, ti consiglio di contattare direttamente il punto prelievi. Puoi trovare tutte le informazioni sui punti prelievi e gli o..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 211
   ğŸ“Š Token totali: 659
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 659 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 211
   ğŸ“Š Token conversazione finale: 211
   ğŸ“Š Token totali: 659
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 637 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno volevo sapere se eseguire il seguente esame  anticorpi anti cardiolipina (IGG,IGM,IGN) Grazie  [ASSISTENTE] SÃ¬, presso Humanitas Ã¨ possibile eseguire il test per gli anticorpi anti-cardiolipina (IgG, IgM, IgA). [...] jsonã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2814 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 211
   ğŸ“Š Token totali stimati: 659
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno volevo sapere se eseguire il seguente esame  anticorpi anti cardiolipina (IGG,IGM,IGN) Grazie  [ASSISTENTE] SÃ¬, presso Humanitas Ã¨ possibile eseguire il test per gli anticorpi anti-cardiolipina (IgG, IgM, IgA). [...] jsonã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 240
   ğŸ“Š Token totali: 689
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 689 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 240
   ğŸ“Š Token conversazione finale: 240
   ğŸ“Š Token totali: 689
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 728 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, vorrei prenotare un esame per la frammentazione del DNA spermatico [ASSISTENTE] Per prenotare un esame per la frammentazione del DNA spermatico, ti consiglio di contattare direttamente il Fertility Center di Humanitas. Questo esame, come il TUNEL, SCSA o HALO, Ã¨ utilizzato pe..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2843 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 240
   ğŸ“Š Token totali stimati: 689
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, vorrei prenotare un esame per la frammentazione del DNA spermatico [ASSISTENTE] Per prenotare un esame per la frammentazione del DNA spermatico, ti consiglio di contattare direttamente il Fertility Center di Humanitas. Questo esame, come il TUNEL, SCSA o HALO, Ã¨ utilizzato pe..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 167
   ğŸ“Š Token totali: 595
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 595 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 167
   ğŸ“Š Token conversazione finale: 167
   ğŸ“Š Token totali: 595
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 491 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] dove si esegue esame pet [ASSISTENTE] L'esame PET (Tomografia a Emissione di Positroni) viene eseguito presso l'UnitÃ  Operativa di Medicina Nucleare dell'Istituto Clinico Humanitas. [...] jsonã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2702 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 167
   ğŸ“Š Token totali stimati: 595
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] dove si esegue esame pet [ASSISTENTE] L'esame PET (Tomografia a Emissione di Positroni) viene eseguito presso l'UnitÃ  Operativa di Medicina Nucleare dell'Istituto Clinico Humanitas. [...] jsonã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 343
   ğŸ“Š Token totali: 792
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 792 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 343
   ğŸ“Š Token conversazione finale: 343
   ğŸ“Š Token totali: 792
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1170 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Devo richiedere la cartella clinica  [ASSISTENTE] Puoi richiedere il rilascio delle cartelle cliniche dei ricoveri svolti presso l'Istituto Clinico Humanitas online dallâ€™area referti di [Humanitas con te](https://www.humanitasconte.it). Se sei in struttura, puoi rivolgerti all'Ufficio Ri..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2866 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 343
   ğŸ“Š Token totali stimati: 792
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Devo richiedere la cartella clinica  [ASSISTENTE] Puoi richiedere il rilascio delle cartelle cliniche dei ricoveri svolti presso l'Istituto Clinico Humanitas online dallâ€™area referti di [Humanitas con te](https://www.humanitasconte.it). Se sei in struttura, puoi rivolgerti all'Ufficio Ri..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 130
   ğŸ“Š Token totali: 578
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 578 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 130
   ğŸ“Š Token conversazione finale: 130
   ğŸ“Š Token totali: 578
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 433 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Informazioni vaccini  [ASSISTENTE] Puoi trovare informazioni dettagliate sui vaccini, inclusi i tipi disponibili, le modalitÃ  di somministrazione e le indicazioni, visitando la pagina dedicata sul sito di Humanitas [Vaccini - Humanitas](https://www.humanitas.it/enciclopedia/vaccini)ã€6:0â€ ..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2873 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 130
   ğŸ“Š Token totali stimati: 578
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Informazioni vaccini  [ASSISTENTE] Puoi trovare informazioni dettagliate sui vaccini, inclusi i tipi disponibili, le modalitÃ  di somministrazione e le indicazioni, visitando la pagina dedicata sul sito di Humanitas [Vaccini - Humanitas](https://www.humanitas.it/enciclopedia/vaccini)ã€6:0â€ ..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 106
   ğŸ“Š Token totali: 554
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 554 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 106
   ğŸ“Š Token conversazione finale: 106
   ğŸ“Š Token totali: 554
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 368 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Ho bisogno la cartella clinica di un deceduto  [ASSISTENTE] Per richiedere la cartella clinica di una persona deceduta, Ã¨ necessario seguire una procedura specifica. [...] 

Se hai bisogno di ulteriori dettagli, fammi sapere!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2819 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 106
   ğŸ“Š Token totali stimati: 554
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] Ho bisogno la cartella clinica di un deceduto  [ASSISTENTE] Per richiedere la cartella clinica di una persona deceduta, Ã¨ necessario seguire una procedura specifica. [...] 

Se hai bisogno di ulteriori dettagli, fammi sapere!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 327
   ğŸ“Š Token totali: 776
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 776 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 327
   ğŸ“Š Token conversazione finale: 327
   ğŸ“Š Token totali: 776
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1087 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi


TESTO DA CLASSIFICARE:
"[UTENTE] devo fare richiesta di una cartella clinica di un paziente che Ã¨ deceduto Lino Humanitas [ASSISTENTE] Per richiedere la cartella clinica di un paziente deceduto, Ã¨ necessario seguire le normative sulla privacy. [...] 

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2820 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 327
   ğŸ“Š Token totali stimati: 776
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi


TESTO DA CLASSIFICARE:
"[UTENTE] devo fare richiesta di una cartella clinica di un paziente che Ã¨ deceduto Lino Humanitas [ASSISTENTE] Per richiedere la cartella clinica di un paziente deceduto, Ã¨ necessario seguire le normative sulla privacy. [...] 

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

ğŸ”§ Creazione MongoClassificationReader per cliente: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” Risoluzione tenant da UUID: 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
âœ… Tenant risolto (DB TAG locale): Humanitas (humanitas) UUID=015007d9-d413-11ef-86a5-96000228e7fe
âœ… Tenant risolto da UUID: Humanitas (015007d9-d413-11ef-86a5-96000228e7fe)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
âœ… MongoClassificationReader inizializzato per tenant: Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
   ğŸ¢ Database: classificazioni
âœ… MongoClassificationReader creato per tenant: Humanitas (humanitas)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
âœ… Connesso a MongoDB database: classificazioni
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
ğŸ” Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
ğŸ·ï¸ Recupero etichette per tenant: Humanitas
ğŸ“Š Calcolo statistiche per tenant: Humanitas
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 124
   ğŸ“Š Token totali: 572
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 572 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 124
   ğŸ“Š Token conversazione finale: 124
   ğŸ“Š Token totali: 572
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 447 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Richiesta preparati istologici  [ASSISTENTE] Per quanto riguarda i preparati istologici, Ã¨ importante sapere che i referti istologici con esito positivo non possono essere delegati per il ritiro. [...] jsonã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2782 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 124
   ğŸ“Š Token totali stimati: 572
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Richiesta preparati istologici  [ASSISTENTE] Per quanto riguarda i preparati istologici, Ã¨ importante sapere che i referti istologici con esito positivo non possono essere delegati per il ritiro. [...] jsonã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 156
   ğŸ“Š Token totali: 584
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 584 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 156
   ğŸ“Š Token conversazione finale: 156
   ğŸ“Š Token totali: 584
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 536 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica


TESTO DA CLASSIFICARE:
"[UTENTE] Vorrei consultare i miei referti  [ASSISTENTE] Per consultare i tuoi referti, devi essere registrato a [Humanitas con te](https://www. [...]  

Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2727 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 156
   ğŸ“Š Token totali stimati: 584
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica


TESTO DA CLASSIFICARE:
"[UTENTE] Vorrei consultare i miei referti  [ASSISTENTE] Per consultare i tuoi referti, devi essere registrato a [Humanitas con te](https://www. [...]  

Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 98
   ğŸ“Š Token totali: 526
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 526 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 98
   ğŸ“Š Token conversazione finale: 98
   ğŸ“Š Token totali: 526
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 308 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Fatturazione [ASSISTENTE] Puoi consultare e scaricare le tue fatture direttamente dal portale [Humanitas con te](https://www. [...] docxã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2656 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 98
   ğŸ“Š Token totali stimati: 526
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Fatturazione [ASSISTENTE] Puoi consultare e scaricare le tue fatture direttamente dal portale [Humanitas con te](https://www. [...] docxã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 175
   ğŸ“Š Token totali: 623
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 623 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 175
   ğŸ“Š Token conversazione finale: 175
   ğŸ“Š Token totali: 623
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 626 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao buongiorno Senti vorrei sapere se Ã¨ possibile rintracciare i risultati delle analisi che avevo fatto circa 3 anni fa [ASSISTENTE] Per recuperare i risultati delle analisi effettuate circa 3 anni fa, puoi accedere al portale [Humanitas con te](https://www.humanitasconte.it). Ti ricor..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2807 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 175
   ğŸ“Š Token totali stimati: 623
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao buongiorno Senti vorrei sapere se Ã¨ possibile rintracciare i risultati delle analisi che avevo fatto circa 3 anni fa [ASSISTENTE] Per recuperare i risultati delle analisi effettuate circa 3 anni fa, puoi accedere al portale [Humanitas con te](https://www.humanitasconte.it). Ti ricor..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 217
   ğŸ“Š Token totali: 645
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 645 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 217
   ğŸ“Š Token conversazione finale: 217
   ğŸ“Š Token totali: 645
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 789 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao non riesco ad entrare su ritiro referti e scaricare, per mio papÃ  che ha 87 anni e gli ho creato un email ed id [ASSISTENTE] Per accedere ai referti di tuo papÃ  tramite [Humanitas con te](https://www. [...] 

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2774 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 217
   ğŸ“Š Token totali stimati: 645
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao non riesco ad entrare su ritiro referti e scaricare, per mio papÃ  che ha 87 anni e gli ho creato un email ed id [ASSISTENTE] Per accedere ai referti di tuo papÃ  tramite [Humanitas con te](https://www. [...] 

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 253
   ğŸ“Š Token totali: 681
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 681 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 253
   ğŸ“Š Token conversazione finale: 253
   ğŸ“Š Token totali: 681
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 875 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] sono Marco Giuseppe Alfredo Fontana, FNTMCG67C30F205N Ã¨ ho effettuato in data 31/05/2024 check-up SALUTE SEMPLICE. [...] 

Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2660 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 253
   ğŸ“Š Token totali stimati: 681
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] sono Marco Giuseppe Alfredo Fontana, FNTMCG67C30F205N Ã¨ ho effettuato in data 31/05/2024 check-up SALUTE SEMPLICE. [...] 

Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

ğŸ”§ Creazione MongoClassificationReader per cliente: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ” Risoluzione tenant da UUID: 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
âœ… Tenant risolto (DB TAG locale): Humanitas (humanitas) UUID=015007d9-d413-11ef-86a5-96000228e7fe
âœ… Tenant risolto da UUID: Humanitas (015007d9-d413-11ef-86a5-96000228e7fe)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
âœ… MongoClassificationReader inizializzato per tenant: Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
   ğŸ¢ Database: classificazioni
âœ… MongoClassificationReader creato per tenant: Humanitas (humanitas)
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
   ğŸ“Š Collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
âœ… Connesso a MongoDB database: classificazioni
ğŸ“Š Collection generata: humanitas_015007d9-d413-11ef-86a5-96000228e7fe per tenant Humanitas
ğŸ” Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
ğŸ·ï¸ Recupero etichette per tenant: Humanitas
ğŸ“Š Calcolo statistiche per tenant: Humanitas
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 212
   ğŸ“Š Token totali: 640
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 640 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 212
   ğŸ“Š Token conversazione finale: 212
   ğŸ“Š Token totali: 640
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 774 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] PerchÃ¨ non riesco a visualizzare le prenotazioni di mia figlia minorenne [ASSISTENTE] Per visualizzare le prenotazioni di un minore su [Humanitas con te](https://www. [...]  

Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2721 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 212
   ğŸ“Š Token totali stimati: 640
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] PerchÃ¨ non riesco a visualizzare le prenotazioni di mia figlia minorenne [ASSISTENTE] Per visualizzare le prenotazioni di un minore su [Humanitas con te](https://www. [...]  

Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

   ğŸ“ˆ Progresso LLM: 100/173
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 180
   ğŸ“Š Token totali: 608
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 608 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 180
   ğŸ“Š Token conversazione finale: 180
   ğŸ“Š Token totali: 608
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 625 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] delega per gestione profilo humanitas da parte di altri come fare? [ASSISTENTE] Per delegare un utente terzo (curatore, caregiver, amministratore di sostegno) alla gestione del proprio profilo su [Humanitas con te](https://www. [...] jsonã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2730 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 180
   ğŸ“Š Token totali stimati: 608
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] delega per gestione profilo humanitas da parte di altri come fare? [ASSISTENTE] Per delegare un utente terzo (curatore, caregiver, amministratore di sostegno) alla gestione del proprio profilo su [Humanitas con te](https://www. [...] jsonã€‘"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 455
   ğŸ“Š Token totali: 903
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 903 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 455
   ğŸ“Š Token conversazione finale: 455
   ğŸ“Š Token totali: 903
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1610 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Non ho ricevuto la documentazione della polizza"
Output: problema_amministrativo
Ragionamento: Problemi con documenti o questioni amministrative


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao Giulia vorrei sapere se posso  scaricare il referto  della Pet di mio marito  dalla mia app [ASSISTENTE] Per scaricare il referto della PET di tuo marito dalla tua app, Ã¨ necessario che il referto sia associato al tuo account su [Humanitas con te](https://www. [...]  A presto!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2863 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 455
   ğŸ“Š Token totali stimati: 903
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Non ho ricevuto la documentazione della polizza"
Output: problema_amministrativo
Ragionamento: Problemi con documenti o questioni amministrative


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao Giulia vorrei sapere se posso  scaricare il referto  della Pet di mio marito  dalla mia app [ASSISTENTE] Per scaricare il referto della PET di tuo marito dalla tua app, Ã¨ necessario che il referto sia associato al tuo account su [Humanitas con te](https://www. [...]  A presto!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta urgente - valuta prioritÃ  massima

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 447
   ğŸ’¬ Token conversazione: 440
   ğŸ“Š Token totali: 887
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 887 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 447
   ğŸ“Š Token conversazione originale: 440
   ğŸ“Š Token conversazione finale: 440
   ğŸ“Š Token totali: 887
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1476 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta


TESTO DA CLASSIFICARE:
"[UTENTE] ciao, [ASSISTENTE] Ciao! Come posso esserti utile? ğŸ˜Š [UTENTE] ho fatto gli esami del sangue il 18 luglio, non so dove vederli perchÃ© quando li ho fatti ero ancora minorenne [ASSISTENTE] Se hai effettuato gli esami del sangue mentre eri minorenne, Ã¨ necessario che il tuo profilo venga ass..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2827 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 447
   ğŸ“Š Token conversazione: 440
   ğŸ“Š Token totali stimati: 887
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta urgente - valuta prioritÃ  massima

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a raggiungervi? Parto da Milano"
Output: indicazioni_stradali
Ragionamento: Informazioni su come raggiungere la sede Wopta


TESTO DA CLASSIFICARE:
"[UTENTE] ciao, [ASSISTENTE] Ciao! Come posso esserti utile? ğŸ˜Š [UTENTE] ho fatto gli esami del sangue il 18 luglio, non so dove vederli perchÃ© quando li ho fatti ero ancora minorenne [ASSISTENTE] Se hai effettuato gli esami del sangue mentre eri minorenne, Ã¨ necessario che il tuo profilo venga ass..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 146
   ğŸ“Š Token totali: 574
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 574 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 146
   ğŸ“Š Token conversazione finale: 146
   ğŸ“Š Token totali: 574
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 515 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Non ho ricevuto la documentazione della polizza"
Output: problema_amministrativo
Ragionamento: Problemi con documenti o questioni amministrative
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, ho ricevuto la comunicazione che avrei ricevuto una chiamata per comunicazioni relative al mio appuntamento di domattina ma non ho ricevuto alcuna chiamata [ASSISTENTE] Mi dispiace per l'inconveniente. [...]  Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2772 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 146
   ğŸ“Š Token totali stimati: 574
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Non ho ricevuto la documentazione della polizza"
Output: problema_amministrativo
Ragionamento: Problemi con documenti o questioni amministrative
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, ho ricevuto la comunicazione che avrei ricevuto una chiamata per comunicazioni relative al mio appuntamento di domattina ma non ho ricevuto alcuna chiamata [ASSISTENTE] Mi dispiace per l'inconveniente. [...]  Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 152
   ğŸ“Š Token totali: 580
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 580 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 152
   ğŸ“Š Token conversazione finale: 152
   ğŸ“Š Token totali: 580
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 509 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno Giulia, ho un appuntamento con il prof. [...]  Buona giornata!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2593 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 152
   ğŸ“Š Token totali stimati: 580
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno Giulia, ho un appuntamento con il prof. [...]  Buona giornata!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 454
   ğŸ’¬ Token conversazione: 133
   ğŸ“Š Token totali: 587
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 587 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione originale: 133
   ğŸ“Š Token conversazione finale: 133
   ğŸ“Š Token totali: 587
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 469 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi


TESTO DA CLASSIFICARE:
"[UTENTE] cia Giulia sono MAriagrazia non riesco a trovare comunicazione di una prenotazione fatta per mio figlio Jacopo Maria Marino 2. [...]  Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2817 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione: 133
   ğŸ“Š Token totali stimati: 587
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi


TESTO DA CLASSIFICARE:
"[UTENTE] cia Giulia sono MAriagrazia non riesco a trovare comunicazione di una prenotazione fatta per mio figlio Jacopo Maria Marino 2. [...]  Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 151
   ğŸ“Š Token totali: 599
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 599 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 151
   ğŸ“Š Token conversazione finale: 151
   ğŸ“Š Token totali: 599
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 489 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] volevo sapere se Ã¨ stato spostato a luglio un appuntamento del 16/6/2025 per mia moglie Lek Naowabut [ASSISTENTE] Non ho accesso a informazioni personali o specifiche sugli appuntamenti. [...]  Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2772 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 151
   ğŸ“Š Token totali stimati: 599
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] volevo sapere se Ã¨ stato spostato a luglio un appuntamento del 16/6/2025 per mia moglie Lek Naowabut [ASSISTENTE] Non ho accesso a informazioni personali o specifiche sugli appuntamenti. [...]  Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 206
   ğŸ“Š Token totali: 634
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 634 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 206
   ğŸ“Š Token conversazione finale: 206
   ğŸ“Š Token totali: 634
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 733 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] Non riesco accedere a referto  [ASSISTENTE] Se non riesci ad accedere al tuo referto, ti consiglio di verificare di aver inserito correttamente l'ID Humanitas con te. [...] 

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2716 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 206
   ğŸ“Š Token totali stimati: 634
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] Non riesco accedere a referto  [ASSISTENTE] Se non riesci ad accedere al tuo referto, ti consiglio di verificare di aver inserito correttamente l'ID Humanitas con te. [...] 

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 454
   ğŸ’¬ Token conversazione: 933
   ğŸ“Š Token totali: 1387
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1387 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione originale: 933
   ğŸ“Š Token conversazione finale: 933
   ğŸ“Š Token totali: 1387
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 3220 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Devo scaricare degli esami di mio papÃ  e devo registrarlo inserisco il codice fiscale ma me lo dÃ  errato l'ho ripetuto piÃ¹ volte ma il codice fiscale corretto solo che mi dice che non va bene [ASSISTENTE] Se il codice fiscale Ã¨ corretto ma il sistema lo segnala come errato, ti consiglio ..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2870 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione: 933
   ğŸ“Š Token totali stimati: 1387
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato


TESTO DA CLASSIFICARE:
"[UTENTE] Devo scaricare degli esami di mio papÃ  e devo registrarlo inserisco il codice fiscale ma me lo dÃ  errato l'ho ripetuto piÃ¹ volte ma il codice fiscale corretto solo che mi dice che non va bene [ASSISTENTE] Se il codice fiscale Ã¨ corretto ma il sistema lo segnala come errato, ti consiglio ..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 765
   ğŸ“Š Token totali: 1214
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1214 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 765
   ğŸ“Š Token conversazione finale: 765
   ğŸ“Š Token totali: 1214
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 2628 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] buongiorno, non vedo nei referti l'esito dell'esame TACTOR01 di RAD1 del 08-08-2025, sono TULLIO PIANA ID. [...] 

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2754 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 765
   ğŸ“Š Token totali stimati: 1214
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] buongiorno, non vedo nei referti l'esito dell'esame TACTOR01 di RAD1 del 08-08-2025, sono TULLIO PIANA ID. [...] 

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 267
   ğŸ“Š Token totali: 695
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 695 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 267
   ğŸ“Š Token conversazione finale: 267
   ğŸ“Š Token totali: 695
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 933 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] l'ultima visita di controllo mi ero accordato che avrei fatto la prossima l'8 agosto, tuttavia in Humanitas con te non trovo il mio appuntamento. [...] 

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2695 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 267
   ğŸ“Š Token totali stimati: 695
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] l'ultima visita di controllo mi ero accordato che avrei fatto la prossima l'8 agosto, tuttavia in Humanitas con te non trovo il mio appuntamento. [...] 

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 454
   ğŸ’¬ Token conversazione: 461
   ğŸ“Š Token totali: 915
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 915 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione originale: 461
   ğŸ“Š Token conversazione finale: 461
   ğŸ“Š Token totali: 915
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1605 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] non riesco ad accedere all'esito degli esami di mia figlia, minorenne, perchÃ¨ ID dice non corretto [ASSISTENTE] Per accedere agli esiti degli esami di un minorenne su [Humanitas con te](https://www.humanitasconte.it), Ã¨ necessario verificare che l'ID sia corretto. L'ID si trova sul tagli..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2903 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 454
   ğŸ“Š Token conversazione: 461
   ğŸ“Š Token totali stimati: 915
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Problema tecnico di accesso - prioritÃ  problema_accesso_portale su altre categorie

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] non riesco ad accedere all'esito degli esami di mia figlia, minorenne, perchÃ¨ ID dice non corretto [ASSISTENTE] Per accedere agli esiti degli esami di un minorenne su [Humanitas con te](https://www.humanitasconte.it), Ã¨ necessario verificare che l'ID sia corretto. L'ID si trova sul tagli..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 116
   ğŸ“Š Token totali: 564
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 564 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 116
   ğŸ“Š Token conversazione finale: 116
   ğŸ“Š Token totali: 564
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 409 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] salve come posso sapere un contatto di un professore di ematologia? [ASSISTENTE] Per ottenere informazioni sui medici, inclusi i professori di ematologia, ti consiglio di consultare la pagina dedicata alla [Ricerca Medici](https://www.humanitas.it/medici/). Qui potrai trovare i dettagli ..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2855 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 116
   ğŸ“Š Token totali stimati: 564
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte


TESTO DA CLASSIFICARE:
"[UTENTE] salve come posso sapere un contatto di un professore di ematologia? [ASSISTENTE] Per ottenere informazioni sui medici, inclusi i professori di ematologia, ti consiglio di consultare la pagina dedicata alla [Ricerca Medici](https://www.humanitas.it/medici/). Qui potrai trovare i dettagli ..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 217
   ğŸ“Š Token totali: 645
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 645 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 217
   ğŸ“Š Token conversazione finale: 217
   ğŸ“Š Token totali: 645
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 722 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] NicolÃ² Maria buffi chi Ã¨? [ASSISTENTE] Il Professor NicolÃ² Maria Buffi Ã¨ un medico specializzato in Urologia presso l'UnitÃ  Operativa di Urologia dell'Istituto Clinico Humanitas. [...] it/unita-operative/urologia)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2738 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 217
   ğŸ“Š Token totali stimati: 645
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "La polizza copre anche viaggi all'estero?"
Output: info_copertura_geografica_assicurazione
Ragionamento: Richiesta informazioni sulla copertura geografica
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] NicolÃ² Maria buffi chi Ã¨? [ASSISTENTE] Il Professor NicolÃ² Maria Buffi Ã¨ un medico specializzato in Urologia presso l'UnitÃ  Operativa di Urologia dell'Istituto Clinico Humanitas. [...] it/unita-operative/urologia)"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 403
   ğŸ“Š Token totali: 851
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 851 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 403
   ğŸ“Š Token conversazione finale: 403
   ğŸ“Š Token totali: 851
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1342 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] vorrei prenotare una visita con il dottor furlan sulla disautonomia [ASSISTENTE] Puoi prenotare una visita con il Dottor Raffaello Furlan, specializzato in disautonomia e responsabile dell'UnitÃ  Sincopi e Disturbi della Postura presso Humanitas. Per maggiori dettagli e per prenotare, vis..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2860 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 403
   ğŸ“Š Token totali stimati: 851
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] vorrei prenotare una visita con il dottor furlan sulla disautonomia [ASSISTENTE] Puoi prenotare una visita con il Dottor Raffaello Furlan, specializzato in disautonomia e responsabile dell'UnitÃ  Sincopi e Disturbi della Postura presso Humanitas. Per maggiori dettagli e per prenotare, vis..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 836
   ğŸ“Š Token totali: 1284
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1284 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 836
   ğŸ“Š Token conversazione finale: 836
   ğŸ“Š Token totali: 1284
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 2583 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Vorrei per favore l'elenco di ortopedici del ginocchio [ASSISTENTE] Gli ortopedici specializzati nel trattamento del ginocchio presso Humanitas includono:

1. [...]  Buona giornata!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2720 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 836
   ğŸ“Š Token totali stimati: 1284
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Vorrei per favore l'elenco di ortopedici del ginocchio [ASSISTENTE] Gli ortopedici specializzati nel trattamento del ginocchio presso Humanitas includono:

1. [...]  Buona giornata!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 454
   ğŸ“Š Token totali: 882
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 882 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 454
   ğŸ“Š Token conversazione finale: 454
   ğŸ“Š Token totali: 882
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1624 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] ho fatto una prenotazione a nome Silvana Delogu per una visita oncologica online dalla dottoressa lorenza rimassa il 17/09/205 ore 14. [...] 

Se hai bisogno di ulteriori dettagli, ti consiglio di contattare il servizio di assistenza dedicata"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2748 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 454
   ğŸ“Š Token totali stimati: 882
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] ho fatto una prenotazione a nome Silvana Delogu per una visita oncologica online dalla dottoressa lorenza rimassa il 17/09/205 ore 14. [...] 

Se hai bisogno di ulteriori dettagli, ti consiglio di contattare il servizio di assistenza dedicata"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 364
   ğŸ“Š Token totali: 812
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 812 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 364
   ğŸ“Š Token conversazione finale: 364
   ğŸ“Š Token totali: 812
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1215 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] vorrei avere conferma dell'orario del prericovero [ASSISTENTE] Il prericovero puÃ² essere effettuato in regime privato o tramite il Servizio Sanitario Nazionale (SSN). [...]  Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2802 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 364
   ğŸ“Š Token totali stimati: 812
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] vorrei avere conferma dell'orario del prericovero [ASSISTENTE] Il prericovero puÃ² essere effettuato in regime privato o tramite il Servizio Sanitario Nazionale (SSN). [...]  Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 152
   ğŸ“Š Token totali: 580
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 580 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 152
   ğŸ“Š Token conversazione finale: 152
   ğŸ“Š Token totali: 580
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 507 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao, se prenoto con una ricetta SSN posso al telefono, scegliere il medico con cui svolgere la prestazione? [ASSISTENTE] SÃ¬, quando prenoti una prestazione tramite il Servizio Sanitario Nazionale (SSN), puoi esprimere una preferenza per il medico con cui desideri svolgere la prestazione..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2801 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 152
   ğŸ“Š Token totali stimati: 580
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao, se prenoto con una ricetta SSN posso al telefono, scegliere il medico con cui svolgere la prestazione? [ASSISTENTE] SÃ¬, quando prenoti una prestazione tramite il Servizio Sanitario Nazionale (SSN), puoi esprimere una preferenza per il medico con cui desideri svolgere la prestazione..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta urgente - valuta prioritÃ  massima

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 447
   ğŸ’¬ Token conversazione: 545
   ğŸ“Š Token totali: 992
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 992 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 447
   ğŸ“Š Token conversazione originale: 545
   ğŸ“Š Token conversazione finale: 545
   ğŸ“Š Token totali: 992
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1759 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao Giulia scusa io Ã¨ 15 giorni che provo a chiamare E dai prericoveri perchÃ© ho da dirgli una cosa importante ma non riesco davvero parlare con nessuno [ASSISTENTE] Capisco la tua situazione. [...]  In bocca al lupo per tutto! ğŸ˜Š"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2810 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 447
   ğŸ“Š Token conversazione: 545
   ğŸ“Š Token totali stimati: 992
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta urgente - valuta prioritÃ  massima

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Quanto costa la polizza vita per una persona di 35 anni?"
Output: info_costi_premio
Ragionamento: Richiesta informazioni sui costi e premi assicurativi
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao Giulia scusa io Ã¨ 15 giorni che provo a chiamare E dai prericoveri perchÃ© ho da dirgli una cosa importante ma non riesco davvero parlare con nessuno [ASSISTENTE] Capisco la tua situazione. [...]  In bocca al lupo per tutto! ğŸ˜Š"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 884
   ğŸ“Š Token totali: 1332
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1332 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 884
   ğŸ“Š Token conversazione finale: 884
   ğŸ“Š Token totali: 1332
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 2882 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] Possibile fare una rinosettoplastica pagando solo la parte estetica? La funzione con ssn [ASSISTENTE] Per quanto riguarda la rinosettoplastica, Ã¨ possibile che la parte funzionale venga coperta dal Servizio Sanitario Nazionale (SSN) se ci sono indicazioni mediche specifiche, mentre la pa..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2853 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 884
   ğŸ“Š Token totali stimati: 1332
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale


TESTO DA CLASSIFICARE:
"[UTENTE] Possibile fare una rinosettoplastica pagando solo la parte estetica? La funzione con ssn [ASSISTENTE] Per quanto riguarda la rinosettoplastica, Ã¨ possibile che la parte funzionale venga coperta dal Servizio Sanitario Nazionale (SSN) se ci sono indicazioni mediche specifiche, mentre la pa..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 185
   ğŸ“Š Token totali: 633
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 633 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 185
   ğŸ“Š Token conversazione finale: 185
   ğŸ“Š Token totali: 633
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 613 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Non ho ricevuto la documentazione della polizza"
Output: problema_amministrativo
Ragionamento: Problemi con documenti o questioni amministrative


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno io effettuato dei esami ma non ancora avuto esiti  [ASSISTENTE] Per aiutarti al meglio, potresti dirmi di che tipo di esami si tratta? Alcuni esami non sono consultabili online e devono essere ritirati presso lo sportello ufficio referti. Se invece hai bisogno di assistenza pe..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2879 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 185
   ğŸ“Š Token totali stimati: 633
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo fare visite mediche per attivare la polizza?"
Output: info_questionario_medico
Ragionamento: Domande su questionari o visite mediche richieste
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Mi dai l'indirizzo della sede di Wopta?"
Output: info_sede_aziendale
Ragionamento: Richiesta informazioni sulla sede aziendale
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Non ho ricevuto la documentazione della polizza"
Output: problema_amministrativo
Ragionamento: Problemi con documenti o questioni amministrative


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno io effettuato dei esami ma non ancora avuto esiti  [ASSISTENTE] Per aiutarti al meglio, potresti dirmi di che tipo di esami si tratta? Alcuni esami non sono consultabili online e devono essere ritirati presso lo sportello ufficio referti. Se invece hai bisogno di assistenza pe..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta urgente - valuta prioritÃ  massima

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 447
   ğŸ’¬ Token conversazione: 537
   ğŸ“Š Token totali: 984
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 984 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 447
   ğŸ“Š Token conversazione originale: 537
   ğŸ“Š Token conversazione finale: 537
   ğŸ“Š Token totali: 984
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1845 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] quanto tempo ci vuole per avere i risultati degli esami del sangue [ASSISTENTE] I risultati degli esami del sangue sono generalmente disponibili in breve tempo, variando da pochi giorni a una settimana. Per maggiori informazioni, puoi visitare la pagina [Esami del sangue](https://www.hum..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2866 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 447
   ğŸ“Š Token conversazione: 537
   ğŸ“Š Token totali stimati: 984
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta urgente - valuta prioritÃ  massima

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Non riesco ad entrare nel mio account del portale Wopta"
Output: problema_accesso_portale
Ragionamento: DifficoltÃ  di login al portale assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Cosa copre esattamente la polizza vita Wopta?"
Output: info_condizioni_polizza
Ragionamento: Richiesta di informazioni sulle condizioni di polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione


TESTO DA CLASSIFICARE:
"[UTENTE] quanto tempo ci vuole per avere i risultati degli esami del sangue [ASSISTENTE] I risultati degli esami del sangue sono generalmente disponibili in breve tempo, variando da pochi giorni a una settimana. Per maggiori informazioni, puoi visitare la pagina [Esami del sangue](https://www.hum..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 49
   ğŸ“Š Token totali: 477
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 477 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 49
   ğŸ“Š Token conversazione finale: 49
   ğŸ“Š Token totali: 477
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 155 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Risultato? [ASSISTENTE] Potresti specificare meglio la tua richiesta? Intendi il risultato di un esame, un referto o altro? Sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2655 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 49
   ğŸ“Š Token totali stimati: 477
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Quanti anni puÃ² durare al massimo la polizza vita?"
Output: info_durata_polizza
Ragionamento: Richiesta di informazioni sulla durata della polizza vita
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Quando inserisco il CF dice che non Ã¨ valido"
Output: problema_accesso_portale
Ragionamento: Problema tecnico di accesso al portale online


TESTO DA CLASSIFICARE:
"[UTENTE] Risultato? [ASSISTENTE] Potresti specificare meglio la tua richiesta? Intendi il risultato di un esame, un referto o altro? Sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 415
   ğŸ“Š Token totali: 863
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 863 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 415
   ğŸ“Š Token conversazione finale: 415
   ğŸ“Š Token totali: 863
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1395 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] buongiorno [ASSISTENTE] Buongiorno! Come posso esserti utile oggi? [UTENTE] per il ritiro di un esito esame istologico Ã¨ solo il medico che ha richiesto che lo puÃ² consegnare? [ASSISTENTE] Tutti i referti, ad eccezione del test HIV e degli esami istologici con esito positivo, possono ess..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2840 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 415
   ğŸ“Š Token totali stimati: 863
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] buongiorno [ASSISTENTE] Buongiorno! Come posso esserti utile oggi? [UTENTE] per il ritiro di un esito esame istologico Ã¨ solo il medico che ha richiesto che lo puÃ² consegnare? [ASSISTENTE] Tutti i referti, ad eccezione del test HIV e degli esami istologici con esito positivo, possono ess..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 303
   ğŸ“Š Token totali: 751
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 751 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 303
   ğŸ“Š Token conversazione finale: 303
   ğŸ“Š Token totali: 751
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1011 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, [ASSISTENTE] Buongiorno! Come posso esserti utile oggi? [UTENTE] Sono la Sig. [...] 

Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2723 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 303
   ğŸ“Š Token totali stimati: 751
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno, [ASSISTENTE] Buongiorno! Come posso esserti utile oggi? [UTENTE] Sono la Sig. [...] 

Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 309
   ğŸ“Š Token totali: 758
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 758 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 309
   ğŸ“Š Token conversazione finale: 309
   ğŸ“Š Token totali: 758
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1101 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Buonasera, non riesco a visualizzare un referto on line su humanitas con te [ASSISTENTE] Se non riesci a visualizzare un referto online su [Humanitas con te](https://www. [...] 

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2785 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 309
   ğŸ“Š Token totali stimati: 758
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Buonasera, non riesco a visualizzare un referto on line su humanitas con te [ASSISTENTE] Se non riesci a visualizzare un referto online su [Humanitas con te](https://www. [...] 

Se hai bisogno di ulteriore supporto, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 449
   ğŸ’¬ Token conversazione: 564
   ğŸ“Š Token totali: 1013
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1013 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione originale: 564
   ğŸ“Š Token conversazione finale: 564
   ğŸ“Š Token totali: 1013
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1811 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao, non sono riesco a vedere i miei esami del sangue che ho fatto il 14/06/25 . [...] it, indicando nome, cognome, codice fiscale e motivo della richiesta di assistenza"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2716 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 449
   ğŸ“Š Token conversazione: 564
   ğŸ“Š Token totali stimati: 1013
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta operativa - preferisci etichette di azione

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Ciao, non sono riesco a vedere i miei esami del sangue che ho fatto il 14/06/25 . [...] it, indicando nome, cognome, codice fiscale e motivo della richiesta di assistenza"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 451
   ğŸ“Š Token totali: 879
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 879 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 451
   ğŸ“Š Token conversazione finale: 451
   ğŸ“Š Token totali: 879
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1425 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] gli esami del sangue posso scaricarli dal fascicolo sanitario? [ASSISTENTE] SÃ¬, gli esami del sangue possono essere scaricati dal Fascicolo Sanitario Elettronico (FSE) se sono stati caricati. [...]  Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2734 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 451
   ğŸ“Š Token totali stimati: 879
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto


TESTO DA CLASSIFICARE:
"[UTENTE] gli esami del sangue posso scaricarli dal fascicolo sanitario? [ASSISTENTE] SÃ¬, gli esami del sangue possono essere scaricati dal Fascicolo Sanitario Elettronico (FSE) se sono stati caricati. [...]  Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 428
   ğŸ’¬ Token conversazione: 643
   ğŸ“Š Token totali: 1071
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 1071 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione originale: 643
   ğŸ“Š Token conversazione finale: 643
   ğŸ“Š Token totali: 1071
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 2141 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno  [ASSISTENTE] Buongiorno! Come posso esserti utile oggi? [UTENTE] In data 16/07 ho effettuato presso Humanitas di Rozzano RX ginocchio dx e sx ma NON Ã¨ visualizzabile online referto ginocchio dx [ASSISTENTE] Alcuni referti non sono consultabili online. Ti chiedo gentilmente di..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2764 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 428
   ğŸ“Š Token conversazione: 643
   ğŸ“Š Token totali stimati: 1071
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica




OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come faccio a disdire la polizza vita?"
Output: disdetta_polizza
Ragionamento: L'utente vuole disdire la sua polizza vita


TESTO DA CLASSIFICARE:
"[UTENTE] Buongiorno  [ASSISTENTE] Buongiorno! Come posso esserti utile oggi? [UTENTE] In data 16/07 ho effettuato presso Humanitas di Rozzano RX ginocchio dx e sx ma NON Ã¨ visualizzabile online referto ginocchio dx [ASSISTENTE] Alcuni referti non sono consultabili online. Ti chiedo gentilmente di..."

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 286
   ğŸ“Š Token totali: 734
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 734 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 286
   ğŸ“Š Token conversazione finale: 286
   ğŸ“Š Token totali: 734
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 1001 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Ãˆ proprio obbligatorio avere una richiesta del medico di base per una visita privata? [ASSISTENTE] No, per una visita privata non Ã¨ obbligatorio avere una richiesta del medico di base. [...]  

Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2834 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 286
   ğŸ“Š Token totali stimati: 734
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "In caso di morte, come funziona l'indennizzo?"
Output: info_caso_morte
Ragionamento: Richiesta informazioni su come funziona la copertura in caso di morte
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Come funziona il riscatto della polizza?"
Output: info_riscatto_polizza
Ragionamento: Richiesta informazioni sul riscatto della polizza


TESTO DA CLASSIFICARE:
"[UTENTE] Ãˆ proprio obbligatorio avere una richiesta del medico di base per una visita privata? [ASSISTENTE] No, per una visita privata non Ã¨ obbligatorio avere una richiesta del medico di base. [...]  

Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
ğŸ¤– ELABORAZIONE CONVERSAZIONE PER LLM
   ğŸ†” Session ID: llm_conversation
   ğŸ“ Token prompt: 448
   ğŸ’¬ Token conversazione: 276
   ğŸ“Š Token totali: 724
   ğŸ¯ Limite massimo: 8000
   âœ… Conversazione OK: 724 â‰¤ 8000
âœ… Tokenizzazione LLM completata:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione originale: 276
   ğŸ“Š Token conversazione finale: 276
   ğŸ“Š Token totali: 724
   ğŸ“Š Limite configurato: 8000
   âœ… Conversazione entro i limiti, nessun troncamento
============================================================

================================================================================
ğŸ‘¤ DEBUG PROMPT USER - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/TEMPLATE/intelligent_classifier_user
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Text Length: 987 chars
--------------------------------------------------------------------------------
ğŸ“„ USER PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] Salve,

attraverso la mia assicurazione "Generali" ho inserito la pratica "Valutazione nutrizionistica/dietista (con relazione finale)" in prestazione diretta presso Medical Care De Angeli (Nr. [...]  Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):
================================================================================

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸš€ PROMPT COMPLETO FINALE INVIATO ALL'LLM
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
ğŸ¤– Model: mistral:7b
ğŸŒ Ollama URL: http://localhost:11434
ğŸ¢ Tenant: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Total Prompt Length: 2855 characters
ğŸ”¢ Token Analysis:
   ğŸ“Š Token prompt base: 448
   ğŸ“Š Token conversazione: 276
   ğŸ“Š Token totali stimati: 724
   ğŸ“Š Limite configurato: 8000
   âœ… STATUS: Conversazione COMPLETA
--------------------------------------------------------------------------------
ğŸ“„ FULL PROMPT CONTENT:
--------------------------------------------------------------------------------
<|system|>
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.

<|user|>
Analizza questo testo seguendo l'approccio degli esempi:

ESEMPIO 1 (ALTA CERTEZZA):
Input: "Come posso contattare l'assistenza Wopta?"
Output: info_contatti
Ragionamento: Domanda sui contatti dell'assicurazione
ESEMPIO 2 (ALTA CERTEZZA):
Input: "Il beneficiario della polizza deve essere mio figlio che deve ancora nascere, come posso fare?"
Output: info_beneficiario
Ragionamento: Domanda su come impostare un beneficiario non ancora nato
ESEMPIO 3 (MEDIA CERTEZZA):
Input: "Devo cambiare la mail con cui mi sono registrato al portale"
Output: cambio_anagrafica
Ragionamento: Cambio delle informazioni anagrafiche richiesto
ESEMPIO 4 (MEDIA CERTEZZA):
Input: "Su che sito posso aprire la polizza?"
Output: info_sottoscrizione_online
Ragionamento: Informazioni su come sottoscrivere la polizza online
ESEMPIO 5 (MEDIA CERTEZZA):
Input: "Posso modificare l'importo assicurato dopo la sottoscrizione?"
Output: modifica_condizioni_polizza
Ragionamento: Richiesta di modifica delle condizioni contrattuali


TESTO DA CLASSIFICARE:
"[UTENTE] Salve,

attraverso la mia assicurazione "Generali" ho inserito la pratica "Valutazione nutrizionistica/dietista (con relazione finale)" in prestazione diretta presso Medical Care De Angeli (Nr. [...]  Se hai bisogno di ulteriore assistenza, sono qui per aiutarti!"

RAGIONA STEP-BY-STEP:
1. Identifica l'intento principale
2. Confronta con gli esempi
3. Scegli l'etichetta piÃ¹ appropriata
4. Valuta la tua certezza

OUTPUT (SOLO JSON):

<|assistant|>
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

================================================================================
ğŸ¤– DEBUG PROMPT SYSTEM - DATABASE
================================================================================
ğŸ“‹ Prompt Name: LLM/SYSTEM/intelligent_classifier_system
ğŸ¢ Tenant ID: 015007d9-d413-11ef-86a5-96000228e7fe
ğŸ“ Variables Used: ['available_labels', 'priority_labels', 'context_guidance']
--------------------------------------------------------------------------------
ğŸ“„ SYSTEM PROMPT CONTENT (dopo sostituzione placeholder):
--------------------------------------------------------------------------------
Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario.

MISSIONE: Classifica conversazioni con pazienti/utenti in base al loro intento principale.

APPROCCIO ANALITICO:
1. Identifica l'intento principale (non dettagli secondari)
2. Considera il contesto ospedaliero (prenotazioni, referti, informazioni)
3. Distingui richieste operative da richieste informative
4. Se incerto tra 2 etichette, scegli la piÃ¹ specifica

CONFIDENCE GUIDELINES:
- 0.9-1.0: Intento chiarissimo e inequivocabile
- 0.7-0.8: Intento probabile con piccole ambiguitÃ 
- 0.5-0.6: Intento possibile ma con dubbi ragionevoli  
- 0.3-0.4: Molto incerto, probabilmente "altro"
- 0.0-0.2: Impossibile classificare

LABELING GUIDELINES:
la logica con cui devi creare le etichette Ã¨: <tipologia di richiesta>_<ambito a cui si riferisce> 

#LABELING EXAMPLE 
- info_prenotazione
- info_esame
- info_ricovero
- info_prericovero
- parere_clinico
- info_fertility_center 
- problema_accesso_portale
- problema_registrazione_portale
- info_ritiro_referto_cartella_clinica



CONTESTO SPECIFICO: Richiesta informativa - preferisci etichette info_*

OUTPUT FORMAT (SOLO JSON):
{"predicted_label": "etichetta_precisa", "confidence": 0.X, "motivation": "ragionamento_breve"}

CRITICAL: Genera ESCLUSIVAMENTE JSON valido. Zero testo aggiuntivo.
================================================================================

ğŸ” TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
