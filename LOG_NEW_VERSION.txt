🚀 UMAP disponibile per riduzione dimensionale!
🚀 cuML GPU clustering disponibile!
💥 EmbeddingDestroyer inizializzato - Ready to destroy and rebuild!
🎯 SimpleEmbeddingManager inizializzato
🎛️ Configurazioni AI saranno salvate su DATABASE MySQL
🎛️ AIConfigurationService inizializzato
   � Backend: DATABASE MySQL
   🔑 OpenAI API Key: ✅ Configurata
🏭 EmbeddingEngineFactory inizializzata
🎯 EmbeddingManager inizializzato
✅ Blueprint esempi inizializzato correttamente
🚀 Avvio server Flask - Debug: True
 * Serving Flask app 'server'
 * Debug mode: on
🔍 [DEBUG] GET /api/tenants - Avvio richiesta tenant
🔍 [DEBUG] Inizializzo MongoClassificationReader...
🔍 [DEBUG] Chiamo get_available_tenants()...
Recuperati 22 tenant dalla tabella TAG.tenants
🔍 [DEBUG] Recuperati 22 tenant dal database
🔍 [DEBUG] Primi 3 tenant: [{'tenant_id': 'a0fd7600-f4f7-11ef-9315-96000228e7fe', 'nome': 'Alleanza'}, {'tenant_id': '6bc4f06f-742e-11f0-acb8-96000228e7fe', 'nome': 'BluPantheon'}, {'tenant_id': '0f9d6e90-d319-11ef-86a5-96000228e7fe', 'nome': 'Boots'}]
🔍 [DEBUG] Invio risposta con 22 tenant
🔧 Creazione MongoClassificationReader per cliente: humanitas
✅ MongoClassificationReader humanitas creato con collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
✅ Connesso a MongoDB database: classificazioni
🔍 Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
🔍 [DEBUG] GET /api/tenants - Avvio richiesta tenant
🔍 [DEBUG] Inizializzo MongoClassificationReader...
🔍 [DEBUG] Chiamo get_available_tenants()...
Recuperati 22 tenant dalla tabella TAG.tenants
🔍 [DEBUG] Recuperati 22 tenant dal database
🔍 [DEBUG] Primi 3 tenant: [{'tenant_id': 'a0fd7600-f4f7-11ef-9315-96000228e7fe', 'nome': 'Alleanza'}, {'tenant_id': '6bc4f06f-742e-11f0-acb8-96000228e7fe', 'nome': 'BluPantheon'}, {'tenant_id': '0f9d6e90-d319-11ef-86a5-96000228e7fe', 'nome': 'Boots'}]
🔍 [DEBUG] Invio risposta con 22 tenant
🔍 [DEBUG] GET /api/prompts/a0fd7600-f4f7-11ef-9315-96000228e7fe/status - Avvio richiesta
🔍 [DEBUG] API: Recupero status prompt per tenant: a0fd7600-f4f7-11ef-9315-96000228e7fe
✅ [DEBUG] Riconosciuto come tenant_id UUID: a0fd7600-f4f7-11ef-9315-96000228e7fe
🔍 [DEBUG] Inizializzo PromptManager...
🔍 [DEBUG] Chiamo get_all_prompts_for_tenant(a0fd7600-f4f7-11ef-9315-96000228e7fe)...
🔍 [DEBUG] Recuperati 5 prompt dal PromptManager
🔍 [DEBUG] Statistiche: 5/5 attivi, 0 inattivi
✅ [DEBUG] Status calcolato: {'success': True, 'tenant_id': 'a0fd7600-f4f7-11ef-9315-96000228e7fe', 'tenant_name': 'Alleanza', 'total_prompts': 5, 'active_prompts': 5, 'inactive_prompts': 0, 'last_updated': '2025-08-25T08:54:43', 'status': 'ready', 'canOperate': True, 'requiredPrompts': [{'name': 'System Prompt', 'type': 'system', 'description': 'Prompt di sistema per la classificazione', 'exists': True}, {'name': 'User Template', 'type': 'user', 'description': 'Template per prompt utente', 'exists': True}, {'name': 'Classification Prompt', 'type': 'classification', 'description': 'Prompt per classificazione intelligente', 'exists': False}], 'missingCount': 1}
✅ [DEBUG] Status prompt per tenant_id a0fd7600-f4f7-11ef-9315-96000228e7fe: 5/5 attivi
🔍 [DEBUG] Invio risposta JSON per status prompt
🔍 [DEBUG] GET /api/prompts/a0fd7600-f4f7-11ef-9315-96000228e7fe/status - Avvio richiesta
🔍 [DEBUG] API: Recupero status prompt per tenant: a0fd7600-f4f7-11ef-9315-96000228e7fe
✅ [DEBUG] Riconosciuto come tenant_id UUID: a0fd7600-f4f7-11ef-9315-96000228e7fe
🔍 [DEBUG] Inizializzo PromptManager...
🔍 [DEBUG] Chiamo get_all_prompts_for_tenant(a0fd7600-f4f7-11ef-9315-96000228e7fe)...
🔍 [DEBUG] Recuperati 5 prompt dal PromptManager
🔍 [DEBUG] Statistiche: 5/5 attivi, 0 inattivi
✅ [DEBUG] Status calcolato: {'success': True, 'tenant_id': 'a0fd7600-f4f7-11ef-9315-96000228e7fe', 'tenant_name': 'Alleanza', 'total_prompts': 5, 'active_prompts': 5, 'inactive_prompts': 0, 'last_updated': '2025-08-25T08:54:43', 'status': 'ready', 'canOperate': True, 'requiredPrompts': [{'name': 'System Prompt', 'type': 'system', 'description': 'Prompt di sistema per la classificazione', 'exists': True}, {'name': 'User Template', 'type': 'user', 'description': 'Template per prompt utente', 'exists': True}, {'name': 'Classification Prompt', 'type': 'classification', 'description': 'Prompt per classificazione intelligente', 'exists': False}], 'missingCount': 1}
✅ [DEBUG] Status prompt per tenant_id a0fd7600-f4f7-11ef-9315-96000228e7fe: 5/5 attivi
🔍 [DEBUG] Invio risposta JSON per status prompt
🔧 Creazione MongoClassificationReader per cliente: humanitas
🔍 [DEBUG] GET /api/prompts/015007d9-d413-11ef-86a5-96000228e7fe/status - Avvio richiesta
🔍 [DEBUG] API: Recupero status prompt per tenant: 015007d9-d413-11ef-86a5-96000228e7fe
✅ [DEBUG] Riconosciuto come tenant_id UUID: 015007d9-d413-11ef-86a5-96000228e7fe
🔍 [DEBUG] Inizializzo PromptManager...
🔍 [DEBUG] Chiamo get_all_prompts_for_tenant(015007d9-d413-11ef-86a5-96000228e7fe)...
🔍 [DEBUG] Recuperati 5 prompt dal PromptManager
🔍 [DEBUG] Statistiche: 5/5 attivi, 0 inattivi
✅ [DEBUG] Status calcolato: {'success': True, 'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'total_prompts': 5, 'active_prompts': 5, 'inactive_prompts': 0, 'last_updated': '2025-08-26T15:04:08', 'status': 'ready', 'canOperate': True, 'requiredPrompts': [{'name': 'System Prompt', 'type': 'system', 'description': 'Prompt di sistema per la classificazione', 'exists': True}, {'name': 'User Template', 'type': 'user', 'description': 'Template per prompt utente', 'exists': True}, {'name': 'Classification Prompt', 'type': 'classification', 'description': 'Prompt per classificazione intelligente', 'exists': False}], 'missingCount': 1}
✅ [DEBUG] Status prompt per tenant_id 015007d9-d413-11ef-86a5-96000228e7fe: 5/5 attivi
🔍 [DEBUG] Invio risposta JSON per status prompt
✅ MongoClassificationReader humanitas creato con collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
✅ Connesso a MongoDB database: classificazioni
🔍 Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
🎯 TRAINING SUPERVISIONATO - Cliente: humanitas
📋 Parametri utente semplificati:
  � Max sessioni review: 500
  🎯 Soglia confidenza: 0.9
  🔄 Forza review: False
  ⚖️  Soglia disagreement: 0.3
🔧 Inizializzazione pipeline per cliente: humanitas (con lock)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
✅ Tenant risolto da slug (DB TAG locale): Humanitas (humanitas) UUID=015007d9-d413-11ef-86a5-96000228e7fe
✅ [CONFIG] Configurazione base caricata da /home/ubuntu/classificatore/Utils/../config.yaml
🎯 [PIPELINE CLUSTERING CONFIG] Caricati parametri personalizzati per tenant 015007d9-d413-11ef-86a5-96000228e7fe:
   allow_single_cluster: non_definito -> False
   alpha: non_definito -> 0.7
   cluster_selection_epsilon: non_definito -> 0.13
   cluster_selection_method: non_definito -> leaf
   max_cluster_size: non_definito -> 0
   metric: non_definito -> euclidean
   min_cluster_size: 5 -> 21
   min_samples: 3 -> 14
   only_user: non_definito -> False
   umap_metric: non_definito -> cosine
   umap_min_dist: non_definito -> 0.05
   umap_n_components: non_definito -> 100
   umap_n_neighbors: non_definito -> 15
   umap_random_state: non_definito -> 42
   use_umap: non_definito -> True

🚀 [FASE 1: INIZIALIZZAZIONE] Avvio pipeline...
🏥 [FASE 1: INIZIALIZZAZIONE] Tenant: humanitas
🎯 [FASE 1: INIZIALIZZAZIONE] Configurazione:
   📊 Confidence threshold: 0.7
   🤖 Auto mode: True
   🔄 Auto retrain: False
� [FASE 1: INIZIALIZZAZIONE] Inizializzazione lettore conversazioni...
📖 [LETTORE] Schema common: only_user = False (legacy - no tenant_id)
� [FASE 1: INIZIALIZZAZIONE] Inizializzazione aggregator...
   🔍 Schema: 'humanitas'
   🆔 Tenant ID: '015007d9-d413-11ef-86a5-96000228e7fe'
✅ [CONFIG] Configurazione base caricata da /home/ubuntu/classificatore/Utils/../config.yaml
✅ [CONFIG] Config personalizzata tenant 015007d9-d413-11ef-86a5-96000228e7fe: 15 parametri
🎯 [ONLY_USER] Tenant 015007d9-d413-11ef-86a5-96000228e7fe: False (da config personalizzata)
🎯 [LETTORE] Tenant 015007d9-d413-11ef-86a5-96000228e7fe: only_user = False (da config tenant)
🎯 [ONLY_USER] Tenant 015007d9-d413-11ef-86a5-96000228e7fe: False (da config personalizzata)
🎯 [ONLY_USER] Tenant 015007d9-d413-11ef-86a5-96000228e7fe: False (da config tenant)
🧠 [FASE 1: INIZIALIZZAZIONE] Sistema embedder dinamico (lazy loading)
🔧 [FASE 1: INIZIALIZZAZIONE] Parametri clustering:
   📊 Min cluster size: 21
   📊 Min samples: 14
✅ [CONFIG] Config personalizzata tenant 015007d9-d413-11ef-86a5-96000228e7fe: 15 parametri
🗂️  [UMAP] Parametri per tenant 015007d9-d413-11ef-86a5-96000228e7fe:
   use_umap: True
   n_neighbors: 15
   min_dist: 0.05
   n_components: 100
   metric: cosine
🔧 [FIX DEBUG] Parametri tenant passati a HDBSCANClusterer:
   min_cluster_size: 21
   min_samples: 14
   alpha: 0.7
   cluster_selection_method: leaf
   cluster_selection_epsilon: 0.13
   metric: euclidean
   allow_single_cluster: False
   max_cluster_size: 0
   🗂️  use_umap: True
   🗂️  umap_n_neighbors: 15
   🗂️  umap_min_dist: 0.05
   🗂️  umap_n_components: 100
🎯 [BERTOPIC] Parametri consistenti configurati:
   📊 HDBSCAN: 10 parametri
   📊 UMAP: 5 parametri
🔧 HDBSCANClusterer inizializzato:
   min_cluster_size: 21
   min_samples: 14
   metric: euclidean
   cluster_selection_epsilon: 0.13
   🗂️  UMAP enabled: True
     📏 n_neighbors: 15
     📐 min_dist: 0.05
     📊 n_components: 100
     🎯 metric: cosine
   🚀 GPU enabled: True
   💾 GPU memory limit: 80%
   🔄 CPU fallback: True
   ⚠️  [GPU MODE] Limitazioni cuML HDBSCAN:
     🚫 leaf_size=40 sarà IGNORATO su GPU
     ✅ Parametri supportati: cluster_selection_method, alpha, allow_single_cluster
🎯 [DEBUG REACT] Parametri configurati:
   cluster_selection_method: leaf
   alpha: 0.7
   allow_single_cluster: False
🧠 Inizializzazione memoria semantica...
🔧 TokenizationManager inizializzato:
   📊 Modello tokenizer: cl100k_base
   🔢 Limite massimo token: 8000
   ✂️  Strategia troncamento: start
✅ TokenizationManager integrato in LaBSE per gestione conversazioni lunghe
🚀 Inizializzazione LaBSE embedder su device: cuda
📥 Caricamento modello sentence-transformers/LaBSE...
🚀 Caricamento diretto su GPU...
✅ Modello caricato con successo!
📊 Dimensione embedding: 768
🔧 Device: cuda
🎮 GPU: NVIDIA A10G
💾 GPU Memory: 23.7 GB
📈 GPU Memory utilizzata: 1.89 GB
� Primo parametro su device: cuda:0
🧪 Test del modello LaBSE...
🔍 Encoding 3 testi con LaBSE su device cuda...

🔍 TOKENIZZAZIONE PREVENTIVA LABSE CLUSTERING
============================================================
🔍 ELABORAZIONE CONVERSAZIONI PER CLUSTERING
   📊 Numero conversazioni: 3
   🆔 Session IDs forniti: No

📊 STATISTICHE ELABORAZIONE:
   🔢 Conversazioni totali: 3
   ✂️  Conversazioni troncate: 0
   📏 Token originali totali: 20
   📐 Token finali totali: 20
   📊 Range token: 6 - 7
✅ Tokenizzazione LaBSE completata:
   📊 Conversazioni processate: 3
   📊 Conversazioni troncate: 0
   📊 Token limite configurato: 8000
   ✅ Tutte le conversazioni entro i limiti, nessun troncamento
============================================================
✅ Embedding generati: shape (3, 768)
✅ Test modello completato con successo!
   Shape: (3, 768)
   Norme: [0.99999994 1.         1.        ]
   Device: cuda
🎯 Modello pronto per l'uso!
🧠 SemanticMemoryManager inizializzato
  🎯 Soglia riutilizzo etichette: 0.8
  🔍 Soglia similarità semantica: 0.8
  💾 Cache path: semantic_cache/humanitas_015007d9_memory
🔗 Inizializzazione ensemble classifier avanzato...
🔍 ML Ensemble Debugger inizializzato e ATTIVO
   📝 Debug file: ./debug_logs/ml_debug.log
🔍 ML Ensemble Debugger attivato
🔧 Tentativo di inizializzazione IntelligentClassifier tramite LLMFactory...
🧠 GPU Memory prima di LLM: 1.8GB/22.1GB (free: 20.3GB)
✅ Memoria GPU sufficiente, inizializzazione LLM tramite Factory...
🎛️ Configurazioni AI saranno salvate su DATABASE MySQL
🎛️ AIConfigurationService inizializzato
   � Backend: DATABASE MySQL
   🔑 OpenAI API Key: ✅ Configurata
🏭 LLM Factory inizializzato con cache invalidation intelligente
🔍 LLM FACTORY DEBUG: Chiamata ai_config_service.get_tenant_configuration(humanitas) normale...
🔄 DatabaseAI: Modalità legacy - risolvo tenant_id humanitas
🔍 [DEBUG] Query eseguita per tenant_id: 015007d9-d413-11ef-86a5-96000228e7fe
🔍 [DEBUG] Risultato database: {'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'tenant_slug': 'humanitas', 'embedding_engine': 'labse', 'llm_engine': 'mistral:7b', 'embedding_config': None, 'llm_config': None, 'is_active': 1, 'updated_at': datetime.datetime(2025, 8, 28, 16, 51, 54)}
🔍 [DEBUG AIConfig] db_config ricevuto: {'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'tenant_slug': 'humanitas', 'embedding_engine': 'labse', 'llm_engine': 'mistral:7b', 'is_active': 1, 'updated_at': datetime.datetime(2025, 8, 28, 16, 51, 54), 'embedding_config': {}, 'llm_config': {}}
🔍 [DEBUG AIConfig] llm_engine nel db_config: mistral:7b
🎯 LLM FACTORY DEBUG: Modello normale = 'mistral:7b'
🔧 Creazione LLM classifier mistral:7b per tenant humanitas
🚀 LLM FACTORY DEBUG: Avvio creazione nuovo classifier modello 'mistral:7b'
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
✅ Tenant risolto da slug (DB TAG locale): Humanitas (humanitas) UUID=015007d9-d413-11ef-86a5-96000228e7fe
🔍 LLM Debugger inizializzato e ATTIVO
   📝 Debug file: ./debug_logs/llm_debug.log
   🎨 Visual formatting: True
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa
🔧 TokenizationManager inizializzato:
   📊 Modello tokenizer: cl100k_base
   🔢 Limite massimo token: 8000
   ✂️  Strategia troncamento: start
✅ LLM FACTORY DEBUG: Nuovo classifier creato: mistral:7b
✅ LLM Classifier mistral:7b (mistral:7b) creato e cached per tenant humanitas
🏭 LLM classifier ottenuto tramite Factory per tenant humanitas
🤖 LLM classifier creato automaticamente nell'ensemble: mistral:7b
💡 Possibile fine-tuning per humanitas
🔗 Advanced Ensemble Classifier inizializzato
   🧠 LLM weight: 0.60
   🤖 ML weight: 0.40
   🎯 Confidence threshold: 0.7
   🔄 Adaptive weights: True
   👤 Disaccordi gestiti da QualityGateEngine
⚠️ Nessun modello trovato per tenant 'humanitas' nella directory models/
⏸️ Riaddestramento automatico disabilitato (modalità supervisione/API)
   💡 Per abilitare, usare auto_retrain=True nell'inizializzazione
✅ Classificatore LLM disponibile nell'ensemble
👤 Inizializzazione trainer interattivo...
🎯 SIMPLE MANAGER: Richiesta embedder per tenant 015007d9-d413-11ef-86a5-96000228e7fe
📥 Primo embedder - creazione per tenant 015007d9-d413-11ef-86a5-96000228e7fe
🚀 CREATING FRESH EMBEDDER per tenant 015007d9-d413-11ef-86a5-96000228e7fe
🎛️ Configurazioni AI saranno salvate su DATABASE MySQL
🎛️ AIConfigurationService inizializzato
   � Backend: DATABASE MySQL
   🔑 OpenAI API Key: ✅ Configurata
🔄 DatabaseAI: Modalità legacy - risolvo tenant_id 015007d9-d413-11ef-86a5-96000228e7fe
🔧 FORCE NO CACHE: Bypass cache per tenant 015007d9-d413-11ef-86a5-96000228e7fe
🔥 FORCE NO CACHE: Bypasso cache e leggo DIRETTAMENTE dal database per tenant 015007d9-d413-11ef-86a5-96000228e7fe
🔍 [DEBUG] Query eseguita per tenant_id: 015007d9-d413-11ef-86a5-96000228e7fe
🔍 [DEBUG] Risultato database: {'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'tenant_slug': 'humanitas', 'embedding_engine': 'labse', 'llm_engine': 'mistral:7b', 'embedding_config': None, 'llm_config': None, 'is_active': 1, 'updated_at': datetime.datetime(2025, 8, 28, 16, 51, 54)}
🔍 [DEBUG AIConfig] db_config ricevuto: {'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'tenant_slug': 'humanitas', 'embedding_engine': 'labse', 'llm_engine': 'mistral:7b', 'is_active': 1, 'updated_at': datetime.datetime(2025, 8, 28, 16, 51, 54), 'embedding_config': {}, 'llm_config': {}}
🔍 [DEBUG AIConfig] llm_engine nel db_config: mistral:7b
🔍 SIMPLE MANAGER: Engine da DB per 015007d9-d413-11ef-86a5-96000228e7fe = 'labse'
🎯 Engine configurato: labse
🔧 DIRECT CREATE: labse
🔧 TokenizationManager inizializzato:
   📊 Modello tokenizer: cl100k_base
   🔢 Limite massimo token: 8000
   ✂️  Strategia troncamento: start
✅ TokenizationManager integrato in LaBSE per gestione conversazioni lunghe
🚀 Inizializzazione LaBSE embedder su device: cuda
📥 Caricamento modello sentence-transformers/LaBSE...
🚀 Caricamento diretto su GPU...
✅ Modello caricato con successo!
📊 Dimensione embedding: 768
🔧 Device: cuda
🎮 GPU: NVIDIA A10G
💾 GPU Memory: 23.7 GB
📈 GPU Memory utilizzata: 3.78 GB
� Primo parametro su device: cuda:0
🧪 Test del modello LaBSE...
🔍 Encoding 3 testi con LaBSE su device cuda...

🔍 TOKENIZZAZIONE PREVENTIVA LABSE CLUSTERING
============================================================
🔍 ELABORAZIONE CONVERSAZIONI PER CLUSTERING
   📊 Numero conversazioni: 3
   🆔 Session IDs forniti: No

📊 STATISTICHE ELABORAZIONE:
   🔢 Conversazioni totali: 3
   ✂️  Conversazioni troncate: 0
   📏 Token originali totali: 20
   📐 Token finali totali: 20
   📊 Range token: 6 - 7
✅ Tokenizzazione LaBSE completata:
   📊 Conversazioni processate: 3
   📊 Conversazioni troncate: 0
   📊 Token limite configurato: 8000
   ✅ Tutte le conversazioni entro i limiti, nessun troncamento
============================================================
✅ Embedding generati: shape (3, 768)
✅ Test modello completato con successo!
   Shape: (3, 768)
   Norme: [0.99999994 1.         1.        ]
   Device: cuda
🎯 Modello pronto per l'uso!
✅ FRESH EMBEDDER creato: LaBSEEmbedder per tenant 015007d9-d413-11ef-86a5-96000228e7fe
🧠 Inizializzazione dedupplicatore intelligente...
💾 [FASE 1: INIZIALIZZAZIONE] Caricamento memoria semantica...
📦 Memoria semantica caricata da cache (4089 sessioni)
   📊 Campioni: 1797
   🏷️ Tag: 250
✅ [FASE 1: INIZIALIZZAZIONE] Completata in 7.70s
🎯 [FASE 1: INIZIALIZZAZIONE] Pipeline pronta per l'uso!
✅ Pipeline humanitas inizializzata
🚀 TRAINING SUPERVISIONATO CON DATASET COMPLETO
  📊 Estrazione: TUTTE le discussioni dal database
  🧩 Clustering: Su tutto il dataset disponibile
  👤 Review umana: Max 500 sessioni rappresentative
🎯 Confidence threshold aggiornato a: 0.9
🎓 TRAINING SUPERVISIONATO AVANZATO
� NUOVA LOGICA:
  🔄 Estrazione: TUTTE le discussioni dal database
  🧩 Clustering: Su tutto il dataset completo
  👤 Review umana: Massimo 500 sessioni rappresentative
--------------------------------------------------
📊 FASE 1: ESTRAZIONE COMPLETA DATASET

� [FASE 2: ESTRAZIONE] Avvio estrazione sessioni...
🏥 [FASE 2: ESTRAZIONE] Tenant: humanitas
📅 [FASE 2: ESTRAZIONE] Giorni indietro: 7
🔄 [FASE 2: ESTRAZIONE] Modalità COMPLETA attivata
🎯 [FASE 2: ESTRAZIONE] Ignorando limite - estrazione totale dataset
� [FASE 2: ESTRAZIONE] Modalità: COMPLETA
� [FASE 2: ESTRAZIONE] Connessione database...
📊 [DEBUG ONLY_USER] Estrazione sessioni aggregate dal schema 'humanitas'...
🎯 [DEBUG ONLY_USER] Parametro only_user = False (tenant_id: 015007d9-d413-11ef-86a5-96000228e7fe)
📄 [DEBUG ONLY_USER] Estrazione completa (senza limite)
📄 [DEBUG ONLY_USER] Filtraggio standard: messaggi USER e AGENT
🔍 [DEBUG ONLY_USER] Esecuzione query per leggere conversazioni dal schema 'humanitas'...
🎯 [DEBUG ONLY_USER] Parametro only_user = False
📋 [DEBUG ONLY_USER] Filtro applicato: WHERE csm.said_by IN ('USER', 'AGENT')
Connessione al database MySQL stabilita con successo
✅ [DEBUG ONLY_USER] Query eseguita con successo!
📊 [DEBUG ONLY_USER] Totale righe: 21129
👤 [DEBUG ONLY_USER] Messaggi USER: 10546
🤖 [DEBUG ONLY_USER] Messaggi AGENT: 10583
✅ [DEBUG ONLY_USER] Filtro funziona correttamente!
✅ Trovate 21129 righe da aggregare
🔄 [DEBUG ONLY_USER] Inizio generazione testo completo per 4215 sessioni
🔍 [DEBUG ONLY_USER] Sessione 0008ef4f-c2f4-4f5e-933e-646574f3638c: 3 USER, 3 AGENT
📝 [DEBUG ONLY_USER] Sessione 0008ef4f-c2f4-4f5e-933e-646574f3638c testo finale:
   [UTENTE] tags: 2
   [ASSISTENTE] tags: 2
   Lunghezza testo: 554 caratteri
🔍 [DEBUG ONLY_USER] Sessione 000b61d7-4431-40d2-b83c-9abbb70c98be: 4 USER, 4 AGENT
📝 [DEBUG ONLY_USER] Sessione 000b61d7-4431-40d2-b83c-9abbb70c98be testo finale:
   [UTENTE] tags: 3
   [ASSISTENTE] tags: 3
   Lunghezza testo: 1133 caratteri
🔍 [DEBUG ONLY_USER] Sessione 00160700-ac7f-463d-8fa0-fe57f74a73e6: 4 USER, 4 AGENT
✅ Aggregate 4215 sessioni uniche
🔄 Saltati 8430 messaggi di benvenuto (primi 2 per sessione)
🔄 Sessioni vuote (solo benvenuto): 887
📥 [FASE 2: ESTRAZIONE] Sessioni grezze: 4215
🔍 [FASE 2: ESTRAZIONE] Filtraggio sessioni...
🔍 Filtraggio sessioni vuote/irrilevanti...
✅ Filtro completato:
  📊 Sessioni originali: 4215
  ❌ Sessioni scartate: 887
  ✅ Sessioni valide: 3328
✅ [FASE 2: ESTRAZIONE] Completata in 0.59s
📊 [FASE 2: ESTRAZIONE] Dataset completo: 3328 sessioni
🗑️ [FASE 2: ESTRAZIONE] Filtrate: 887 sessioni vuote/irrilevanti
🎯 [FASE 2: ESTRAZIONE] Pronte per clustering completo
✅ Dataset completo: 3328 sessioni totali

📊 FASE 2: CLUSTERING COMPLETO

🚀 [FASE 4: CLUSTERING] Avvio clustering intelligente...
📊 [FASE 4: CLUSTERING] Dataset: 3328 sessioni
🎯 [FASE 4: CLUSTERING] Modalità: INTELLIGENTE
🧠 [FASE 4: CLUSTERING] Clustering incrementale (se possibile)...

🚀 [FASE 3: EMBEDDINGS] Avvio generazione embeddings...
� [FASE 3: EMBEDDINGS] Dataset: 3328 sessioni
📊 [FASE 3: EMBEDDINGS] Caratteristiche testo:
   📏 Lunghezza media: 1011 caratteri
   📏 Lunghezza massima: 29104 caratteri
   📏 Lunghezza minima: 75 caratteri
🧠 [FASE 3: EMBEDDINGS] Generazione embeddings...
🔄 LAZY LOADING: Caricamento embedder dinamico per tenant 'humanitas'
🎯 SimpleEmbeddingManager inizializzato
🔄 SIMPLE MANAGER: Normalizzato 'humanitas' -> '015007d9-d413-11ef-86a5-96000228e7fe'
🎯 SIMPLE MANAGER: Richiesta embedder per tenant 015007d9-d413-11ef-86a5-96000228e7fe
📥 Primo embedder - creazione per tenant 015007d9-d413-11ef-86a5-96000228e7fe
🚀 CREATING FRESH EMBEDDER per tenant 015007d9-d413-11ef-86a5-96000228e7fe
🎛️ Configurazioni AI saranno salvate su DATABASE MySQL
🎛️ AIConfigurationService inizializzato
   � Backend: DATABASE MySQL
   🔑 OpenAI API Key: ✅ Configurata
🔄 DatabaseAI: Modalità legacy - risolvo tenant_id 015007d9-d413-11ef-86a5-96000228e7fe
🔧 FORCE NO CACHE: Bypass cache per tenant 015007d9-d413-11ef-86a5-96000228e7fe
🔥 FORCE NO CACHE: Bypasso cache e leggo DIRETTAMENTE dal database per tenant 015007d9-d413-11ef-86a5-96000228e7fe
🔍 [DEBUG] Query eseguita per tenant_id: 015007d9-d413-11ef-86a5-96000228e7fe
🔍 [DEBUG] Risultato database: {'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'tenant_slug': 'humanitas', 'embedding_engine': 'labse', 'llm_engine': 'mistral:7b', 'embedding_config': None, 'llm_config': None, 'is_active': 1, 'updated_at': datetime.datetime(2025, 8, 28, 16, 51, 54)}
🔍 [DEBUG AIConfig] db_config ricevuto: {'tenant_id': '015007d9-d413-11ef-86a5-96000228e7fe', 'tenant_name': 'Humanitas', 'tenant_slug': 'humanitas', 'embedding_engine': 'labse', 'llm_engine': 'mistral:7b', 'is_active': 1, 'updated_at': datetime.datetime(2025, 8, 28, 16, 51, 54), 'embedding_config': {}, 'llm_config': {}}
🔍 [DEBUG AIConfig] llm_engine nel db_config: mistral:7b
🔍 SIMPLE MANAGER: Engine da DB per 015007d9-d413-11ef-86a5-96000228e7fe = 'labse'
🎯 Engine configurato: labse
🔧 DIRECT CREATE: labse
🔧 TokenizationManager inizializzato:
   📊 Modello tokenizer: cl100k_base
   🔢 Limite massimo token: 8000
   ✂️  Strategia troncamento: start
✅ TokenizationManager integrato in LaBSE per gestione conversazioni lunghe
🚀 Inizializzazione LaBSE embedder su device: cuda
📥 Caricamento modello sentence-transformers/LaBSE...
🚀 Caricamento diretto su GPU...
✅ Modello caricato con successo!
📊 Dimensione embedding: 768
🔧 Device: cuda
🎮 GPU: NVIDIA A10G
💾 GPU Memory: 23.7 GB
📈 GPU Memory utilizzata: 5.67 GB
� Primo parametro su device: cuda:0
🧪 Test del modello LaBSE...
🔍 Encoding 3 testi con LaBSE su device cuda...

🔍 TOKENIZZAZIONE PREVENTIVA LABSE CLUSTERING
============================================================
🔍 ELABORAZIONE CONVERSAZIONI PER CLUSTERING
   📊 Numero conversazioni: 3
   🆔 Session IDs forniti: No

📊 STATISTICHE ELABORAZIONE:
   🔢 Conversazioni totali: 3
   ✂️  Conversazioni troncate: 0
   📏 Token originali totali: 20
   📐 Token finali totali: 20
   📊 Range token: 6 - 7
✅ Tokenizzazione LaBSE completata:
   📊 Conversazioni processate: 3
   📊 Conversazioni troncate: 0
   📊 Token limite configurato: 8000
   ✅ Tutte le conversazioni entro i limiti, nessun troncamento
============================================================
✅ Embedding generati: shape (3, 768)
✅ Test modello completato con successo!
   Shape: (3, 768)
   Norme: [0.99999994 1.         1.        ]
   Device: cuda
🎯 Modello pronto per l'uso!
✅ FRESH EMBEDDER creato: LaBSEEmbedder per tenant 015007d9-d413-11ef-86a5-96000228e7fe
✅ Embedder caricato per tenant UUID 'humanitas': LaBSEEmbedder
🔍 Encoding 3328 testi con LaBSE su device cuda...

🔍 TOKENIZZAZIONE PREVENTIVA LABSE CLUSTERING
============================================================
🔍 ELABORAZIONE CONVERSAZIONI PER CLUSTERING
   📊 Numero conversazioni: 3328
   🆔 Session IDs forniti: Sì
✂️  TRONCAMENTO NECESSARIO:
   📊 Token originali: 8588
   🎯 Target token: 8000
   ⚡ Strategia: start
   ✅ Token finali: 8000
   📏 Caratteri rimossi: 1927
   ✂️  Conversazione 3fe6b43b-3d09-4ed4-9002-d8a1f2b64291: 8588 → 8000 token
✂️  TRONCAMENTO NECESSARIO:
   📊 Token originali: 8227
   🎯 Target token: 8000
   ⚡ Strategia: start
   ✅ Token finali: 8000
   📏 Caratteri rimossi: 710
   ✂️  Conversazione dbd64c8d-dcd6-4b19-a8ab-7f3760898dfe: 8227 → 8000 token

📊 STATISTICHE ELABORAZIONE:
   🔢 Conversazioni totali: 3328
   ✂️  Conversazioni troncate: 2
   📏 Token originali totali: 1,011,590
   📐 Token finali totali: 1,010,775
   📊 Range token: 26 - 8588
   💾 Riduzione totale: 0.1%
✅ Tokenizzazione LaBSE completata:
   📊 Conversazioni processate: 3328
   📊 Conversazioni troncate: 2
   📊 Token limite configurato: 8000
   ✂️  2 conversazioni TRONCATE per rispettare limite token
============================================================
✅ Embedding generati: shape (3328, 768)
✅ [FASE 3: EMBEDDINGS] Completata in 8.44s
📈 [FASE 3: EMBEDDINGS] Shape: (3328, 768)
⚡ [FASE 3: EMBEDDINGS] Throughput: 394.5 testi/secondo

📊 FASE 2A: TRAINING BERTOPIC ANTICIPATO

🚀 TRAINING BERTOPIC ANTICIPATO (NUOVO FLUSSO OTTIMIZZATO):
   📊 Dataset completo: 3328 sessioni
   📊 Embeddings shape: (3328, 768)
   🎯 Addestramento su TUTTO il dataset per features ottimali
   🔥 Esecuzione bertopic_provider.fit() su dataset completo...
📊 BERTopic training su 3328 campioni
   🎯 Embedder configurato: LaBSEEmbedder
   🔧 STRATEGIA: BERTopic userà embedder personalizzato via wrapper
   ✅ Wrapper embedder creato per BERTopic
   🔧 BERTopic userà embedder personalizzato interno
🔧 Creazione MongoClassificationReader per cliente: humanitas
✅ MongoClassificationReader humanitas creato con collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
✅ Connesso a MongoDB database: classificazioni
🔍 Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
✅ BERTopic FIT completato su 3328 campioni
   🔧 SVD Training: Usando embedder personalizzato interno
✅ SVD addestrato su full probas (k=20)
   ✅ BERTopic FIT completato in 39.75 secondi
   🔄 Esecuzione bertopic_provider.transform() per features extraction...
🔧 Transform: BERTopic userà embedder personalizzato interno
   ✅ BERTopic TRANSFORM completato in 4.26 secondi
   📊 Topic probabilities shape: (3328, 20)
   📊 One-hot shape: None
   ✅ BERTopic provider addestrato con successo su 3328 sessioni
   ✅ BERTopic provider disponibile per augmentation features
   🔗 BERTopic model assegnato al trainer per validazione ALTRO

📊 FASE 2B: CLUSTERING HDBSCAN
🧠 Usando clustering INTELLIGENTE (LLM + ML senza pattern)
🗂️  [DEBUG] Caricamento config tenant-specific: /home/ubuntu/classificatore/tenant_configs/015007d9-d413-11ef-86a5-96000228e7fe_clustering.yaml
🗂️  [DEBUG] Config tenant caricato: ['allow_single_cluster', 'alpha', 'cluster_selection_epsilon', 'cluster_selection_method', 'max_cluster_size', 'metric', 'min_cluster_size', 'min_samples', 'only_user', 'umap_metric', 'umap_min_dist', 'umap_n_components', 'umap_n_neighbors', 'umap_random_state', 'use_umap']
🗂️  [DEBUG] UMAP config finale: use_umap=True, n_components=100, min_dist=0.05
🧠 Clustering intelligente configurato:
   🎯 Categorie intent suggerite: 12
   🤖 LLM primario: True
   📊 Min confidence: 0.8
   📈 Min conversations per intent: 2
   👥 Rappresentanti diversificati: True
   🔢 Max rappresentanti per cluster: 5
   🤝 Strategia consenso: majority
🧠 Avvio clustering intelligente OTTIMIZZATO di 3328 conversazioni...
📊 Fase 1: Clustering semantico con HDBSCAN...
🔧 HDBSCANClusterer inizializzato:
   min_cluster_size: 21
   min_samples: 14
   metric: euclidean
   cluster_selection_epsilon: 0.13
   🗂️  UMAP enabled: True
     📏 n_neighbors: 15
     📐 min_dist: 0.05
     📊 n_components: 100
     🎯 metric: cosine
   🚀 GPU enabled: True
   💾 GPU memory limit: 80%
   🔄 CPU fallback: True
   ⚠️  [GPU MODE] Limitazioni cuML HDBSCAN:
     🚫 leaf_size=40 sarà IGNORATO su GPU
     ✅ Parametri supportati: cluster_selection_method, alpha, allow_single_cluster
🎯 [DEBUG REACT] Parametri configurati:
   cluster_selection_method: eom
   alpha: 1.0
   allow_single_cluster: False
🔍 Clustering HDBSCAN su 3328 embedding (9.8MB)...
⚙️  Parametri: min_cluster_size=21, min_samples=14, metric=euclidean
📊 [DEBUG FIT_PREDICT] Embedding input:
   📏 Shape: (3328, 768)
   🔢 Dtype: float32
   📈 Range: [-0.1261, 0.0955]
   💾 Memory: 9.8MB

🗂️  [DEBUG FIT_PREDICT] STEP 1: Controllo applicazione UMAP...
🔍 [DEBUG UMAP] Controllo condizioni applicazione UMAP...
   ✅ self.use_umap = True
   ✅ UMAP_AVAILABLE = True
� [DEBUG UMAP] UMAP ABILITATO - Iniziando riduzione dimensionale...
   📏 Dimensioni input: (3328, 768)
   🔢 Tipo dati input: float32
   📊 Range valori input: [-0.1261, 0.0955]
   🎯 Parametri UMAP configurati:
     📐 n_neighbors: 15
     📏 min_dist: 0.05
     🔢 n_components: 100
     📈 metric: cosine
     🎲 random_state: 42
🔧 [DEBUG UMAP] Inizializzazione riduttore UMAP...
🆕 [DEBUG UMAP] Modalità TRAINING - fit nuovo reducer
✅ [DEBUG UMAP] Riduttore UMAP inizializzato con successo
⏳ [DEBUG UMAP] Applicazione fit_transform agli embeddings...
UMAP(angular_rp_forest=True, metric='cosine', min_dist=0.05, n_components=100, n_jobs=1, random_state=42, verbose=True)
Fri Aug 29 11:15:30 2025 Construct fuzzy simplicial set
Fri Aug 29 11:15:43 2025 Finding Nearest Neighbors
Fri Aug 29 11:15:44 2025 Finished Nearest Neighbor Search
Fri Aug 29 11:15:44 2025 Construct embedding
	completed  0  /  500 epochs
	completed  50  /  500 epochs
	completed  100  /  500 epochs
	completed  150  /  500 epochs
	completed  200  /  500 epochs
	completed  250  /  500 epochs
	completed  300  /  500 epochs
	completed  350  /  500 epochs
	completed  400  /  500 epochs
	completed  450  /  500 epochs
Fri Aug 29 11:15:55 2025 Finished embedding
✅ [DEBUG UMAP] UMAP COMPLETATO con SUCCESSO in 24.99s
   📐 Dimensioni output: (3328, 100)
   � Tipo dati output: float32
   �📊 Range valori output: [-1.1767, 14.7635]
   📈 Riduzione dimensionale: 768 → 100 dimensioni
   📉 Fattore riduzione: 7.7x
✅ [DEBUG UMAP] RIDUZIONE DIMENSIONALE CONFERMATA
✅ [DEBUG UMAP] Nessun NaN nel risultato UMAP
✅ [DEBUG UMAP] Nessun valore infinito nel risultato UMAP
📊 [DEBUG UMAP] Diversità embeddings ridotti: 3328/3328 righe uniche
✅ [DEBUG UMAP] Buona diversità negli embeddings ridotti
📋 [DEBUG UMAP] Info riduzione salvate nel clusterer
📋 [DEBUG FIT_PREDICT] Risultato UMAP:
   ✅ UMAP applicato: True
   📏 Shape post-UMAP: (3328, 100)
   📈 Range post-UMAP: [-1.1767, 14.7635]
   ⏱️  Tempo riduzione: 24.99s

🔧 [DEBUG FIT_PREDICT] STEP 2: Normalizzazione per metrica euclidean...
   🎯 Nessuna normalizzazione necessaria per metrica euclidean
   📏 Shape finale per clustering: (3328, 100)
   📈 Range finale: [-1.1767, 14.7635]
   🎯 Metrica effettiva clustering: euclidean
💾 Memoria GPU: 17.7GB disponibili, 0.0GB necessari
🚀 Utilizzo GPU per clustering accelerato

🚀 [DEBUG FIT_PREDICT] STEP 3: Avvio clustering...
   🖥️  Modalità: GPU
� [GPU CLUSTERING] Inizializzazione cuML HDBSCAN con parametri supportati...

✅ [DEBUG FIT_PREDICT] CLUSTERING COMPLETATO in 0.11s con 🚀 GPU!
📊 Risultati finali:
   🎯 Cluster trovati: 37
   🔍 Outlier: 808 (24.3%)
   📈 Silhouette score: 0.642

📋 [DEBUG FIT_PREDICT] RIEPILOGO TRASFORMAZIONI:
   🔤 Input originale: (3328, 768)
   🗂️  Dopo UMAP: (3328, 100)
   🔧 Dopo normalizzazione: (3328, 100)
   🎯 Utilizzato per clustering: (3328, 100) con metrica euclidean
   📈 Cluster HDBSCAN trovati: 37
   🔍 Outliers: 808
👥 Fase 2: Selezione rappresentanti per cluster...
   � Cluster 0: 38 sessioni, 4 rappresentanti selezionati
   � Cluster 1: 261 sessioni, 5 rappresentanti selezionati
   � Cluster 2: 61 sessioni, 5 rappresentanti selezionati
   � Cluster 3: 192 sessioni, 5 rappresentanti selezionati
   � Cluster 4: 57 sessioni, 5 rappresentanti selezionati
   � Cluster 5: 156 sessioni, 5 rappresentanti selezionati
   � Cluster 6: 37 sessioni, 4 rappresentanti selezionati
   � Cluster 7: 135 sessioni, 5 rappresentanti selezionati
   � Cluster 8: 50 sessioni, 4 rappresentanti selezionati
   � Cluster 9: 50 sessioni, 4 rappresentanti selezionati
   � Cluster 10: 35 sessioni, 4 rappresentanti selezionati
   � Cluster 11: 24 sessioni, 4 rappresentanti selezionati
   � Cluster 12: 24 sessioni, 4 rappresentanti selezionati
   � Cluster 13: 41 sessioni, 4 rappresentanti selezionati
   � Cluster 14: 29 sessioni, 4 rappresentanti selezionati
   � Cluster 15: 51 sessioni, 5 rappresentanti selezionati
   � Cluster 16: 93 sessioni, 5 rappresentanti selezionati
   � Cluster 17: 133 sessioni, 5 rappresentanti selezionati
   � Cluster 18: 40 sessioni, 4 rappresentanti selezionati
   � Cluster 19: 59 sessioni, 5 rappresentanti selezionati
   � Cluster 20: 26 sessioni, 4 rappresentanti selezionati
   � Cluster 21: 50 sessioni, 4 rappresentanti selezionati
   � Cluster 22: 96 sessioni, 5 rappresentanti selezionati
   � Cluster 23: 26 sessioni, 4 rappresentanti selezionati
   � Cluster 24: 24 sessioni, 4 rappresentanti selezionati
   � Cluster 25: 23 sessioni, 4 rappresentanti selezionati
   � Cluster 26: 65 sessioni, 5 rappresentanti selezionati
   � Cluster 27: 55 sessioni, 5 rappresentanti selezionati
   � Cluster 28: 105 sessioni, 5 rappresentanti selezionati
   � Cluster 29: 34 sessioni, 4 rappresentanti selezionati
   � Cluster 30: 74 sessioni, 5 rappresentanti selezionati
   � Cluster 31: 148 sessioni, 5 rappresentanti selezionati
   � Cluster 32: 74 sessioni, 5 rappresentanti selezionati
   � Cluster 33: 60 sessioni, 5 rappresentanti selezionati
   � Cluster 34: 29 sessioni, 4 rappresentanti selezionati
   � Cluster 35: 41 sessioni, 4 rappresentanti selezionati
   � Cluster 36: 24 sessioni, 4 rappresentanti selezionati
🤖 Fase 3: Analisi LLM di 166 rappresentanti...
🤖 Analisi LLM di 166 conversazioni...
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 212
   📊 Token totali: 640
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 640 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 212
   📊 Token conversazione finale: 212
   📊 Token totali: 640
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 774 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2721 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:15:58.742806
====================================================================================================
📋 Session ID: classify_1756466158
⏱️  Processing Time: 3.136s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (774 chars):
   [UTENTE] Perchè non riesco a visualizzare le prenotazioni di mia figlia minorenne [ASSISTENTE] Per visualizzare le prenotazioni di un minore su [Humanitas con te](https://www.humanitasconte.it), è ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (147 chars):
    {"predicted_label": "info_prenotazione", "confidence": 0.9, "motivation": "Domanda su come visualizzare le prenotazioni di una persona minorenne"}

📊 Parsed Response:
   predicted_label: info_prenotazione
   confidence: 0.9
   motivation: Domanda su come visualizzare le prenotazioni di una persona minorenne
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come visualizzare le prenotazioni di una persona minorenne
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

✅ Connesso a MongoDB database: classificazioni
🤖 LLM DIRECT CLASSIFICATION: Sessione 54679b5dd0fd90d7bd845dfdb6fd8c8f classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 180
   📊 Token totali: 608
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 608 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 180
   📊 Token conversazione finale: 180
   📊 Token totali: 608
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 625 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2730 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:15:59.694278
====================================================================================================
📋 Session ID: classify_1756466159
⏱️  Processing Time: 0.820s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (625 chars):
   [UTENTE] delega per gestione profilo humanitas da parte di altri come fare? [ASSISTENTE] Per delegare un utente terzo (curatore, caregiver, amministratore di sostegno) alla gestione del proprio pro...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (136 chars):
    {"predicted_label": "delega_profilo", "confidence": 0.9, "motivation": "Domanda su come delegare il proprio profilo a un altro utente"}

📊 Parsed Response:
   predicted_label: delega_profilo
   confidence: 0.9
   motivation: Domanda su come delegare il proprio profilo a un altro utente
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come delegare il proprio profilo a un altro utente
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 356f7524398d9a84694232d68e070bc9 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 153
   📊 Token totali: 581
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 581 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 153
   📊 Token conversazione finale: 153
   📊 Token totali: 581
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 518 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2657 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:00.526202
====================================================================================================
📋 Session ID: classify_1756466160
⏱️  Processing Time: 0.725s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (518 chars):
   [UTENTE] Come faccio a creare un altro profilo in una in un Humanitas per te [ASSISTENTE] Per creare un altro profilo su [Humanitas con te](https://www.humanitasconte.it), ad esempio per gestire un...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (125 chars):
    {"predicted_label": "profilo_nuovo", "confidence": 0.8, "motivation": "L'utente vuole creare un nuovo profilo su Humanitas"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: L'utente vuole creare un nuovo profilo su Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   L'utente vuole creare un nuovo profilo su Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione ad2830a64127191792d9a5fbe01019f8 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 121
   📊 Token totali: 569
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 569 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 121
   📊 Token conversazione finale: 121
   📊 Token totali: 569
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 410 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2824 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:01.575414
====================================================================================================
📋 Session ID: classify_1756466161
⏱️  Processing Time: 0.943s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (410 chars):
   [UTENTE] Giulia, avrei bisogno della copia della cartella clinica di mia figlia minorenne  [ASSISTENTE] Per richiedere la copia della cartella clinica di un minore, è necessario seguire una procedu...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (158 chars):
    {"predicted_label": "info_copia_cartella_clinica", "confidence": 0.9, "motivation": "Domanda su come ottenere una copia della cartella clinica di un minore"}

📊 Parsed Response:
   predicted_label: info_copia_cartella_clinica
   confidence: 0.9
   motivation: Domanda su come ottenere una copia della cartella clinica di un minore
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come ottenere una copia della cartella clinica di un minore
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 42fd7c859924ae0579aed8559acba313 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 373
   📊 Token totali: 822
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 822 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 373
   📊 Token conversazione finale: 373
   📊 Token totali: 822
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1108 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2768 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:02.611469
====================================================================================================
📋 Session ID: classify_1756466162
⏱️  Processing Time: 0.930s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1108 chars):
   [UTENTE] Voglio prenotare visita oncologica  [ASSISTENTE] Per prenotare una visita oncologica presso Humanitas, puoi utilizzare i seguenti canali di prenotazione:

1. **Privatamente con fondi e ass...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (147 chars):
    {"predicted_label": "prenotazione_oncologica", "confidence": 0.9, "motivation": "L'utente vuole prenotare una visita oncologica presso Humanitas"}

📊 Parsed Response:
   predicted_label: prenotazione_oncologica
   confidence: 0.9
   motivation: L'utente vuole prenotare una visita oncologica presso Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente vuole prenotare una visita oncologica presso Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 9e013dae3e1d9f72e3e02eb54dca24dd classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 447
   💬 Token conversazione: 996
   📊 Token totali: 1443
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 1443 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 447
   📊 Token conversazione originale: 996
   📊 Token conversazione finale: 996
   📊 Token totali: 1443
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 3385 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2753 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:03.834397
====================================================================================================
📋 Session ID: classify_1756466163
⏱️  Processing Time: 1.117s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (3385 chars):
   [UTENTE] Buongiorno mi rivolgo ad Humanitas perché sto cercando professionalità riguardo la mia patologia. Pultroppo anni fa mi è stata diagnosticata artrosi deformante degenerativa e fibromiofalgi...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (126 chars):
    {"predicted_label": "parere_clinico", "confidence": 0.9, "motivation": "Domanda riguardo la professionalità della patologia"}

📊 Parsed Response:
   predicted_label: parere_clinico
   confidence: 0.9
   motivation: Domanda riguardo la professionalità della patologia
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda riguardo la professionalità della patologia
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 0f4d2db633adaf47a65228144aa5b737 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 591
   📊 Token totali: 1040
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 1040 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 591
   📊 Token conversazione finale: 591
   📊 Token totali: 1040
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1862 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2692 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:04.639926
====================================================================================================
📋 Session ID: classify_1756466164
⏱️  Processing Time: 0.700s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1862 chars):
   [UTENTE] Ginecomastia [UTENTE] uomo [ASSISTENTE] Ciao! Sono Giulia, l’assistente digitale dell’Istituto Clinico Humanitas. Come posso aiutarti oggi? [ASSISTENTE] La ginecomastia è una condizione ca...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (106 chars):
    {"predicted_label": "info_esame", "confidence": 0.8, "motivation": "Domanda riguardante un esame medico"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda riguardante un esame medico
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda riguardante un esame medico
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🔧 Creazione MongoClassificationReader per cliente: humanitas
🤖 LLM DIRECT CLASSIFICATION: Sessione 87f5d0fa875e620abc9a723a1b05d11c classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 547
   📊 Token totali: 995
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 995 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 547
   📊 Token conversazione finale: 547
   📊 Token totali: 995
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1653 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2842 chars (debug_prompt=False)
✅ MongoClassificationReader humanitas creato con collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
✅ Connesso a MongoDB database: classificazioni
🔍 Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:05.668256
====================================================================================================
📋 Session ID: classify_1756466165
⏱️  Processing Time: 0.907s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1653 chars):
   [UTENTE] Con l'ecoendoscopia è  possibile esplorare per intero l'ideologia o l'intestino tenue [ASSISTENTE] L'ecoendoscopia è una tecnica diagnostica avanzata che consente di esplorare alcune parti...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (126 chars):
    {"predicted_label": "info_ecoendoscopia", "confidence": 0.9, "motivation": "L'utente chiede informazioni sull'ecoendoscopia"}

📊 Parsed Response:
   predicted_label: info_ecoendoscopia
   confidence: 0.9
   motivation: L'utente chiede informazioni sull'ecoendoscopia
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni sull'ecoendoscopia
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione cf5040ec7c44aa569f78ee053b4e34cf classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 579
   📊 Token totali: 1027
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 1027 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 579
   📊 Token conversazione finale: 579
   📊 Token totali: 1027
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1735 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2871 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:06.662288
====================================================================================================
📋 Session ID: classify_1756466166
⏱️  Processing Time: 0.889s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1735 chars):
   [UTENTE] Vorrei sapere si voi fatte le onde d'urto ecoguidate? [ASSISTENTE] Sì, presso Humanitas vengono effettuati trattamenti con onde d'urto ecoguidate, utilizzando tecnologie avanzate per tratt...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (148 chars):
    {"predicted_label": "info_trattamento", "confidence": 0.9, "motivation": "L'utente chiede informazioni sui trattamenti con onde d'urto ecoguidate"}

📊 Parsed Response:
   predicted_label: info_trattamento
   confidence: 0.9
   motivation: L'utente chiede informazioni sui trattamenti con onde d'urto ecoguidate
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni sui trattamenti con onde d'urto ecoguidate
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione cfe4c0e70f680367333ef411c14fdc88 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 447
   💬 Token conversazione: 4489
   📊 Token totali: 4936
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 4936 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 447
   📊 Token conversazione originale: 4489
   📊 Token conversazione finale: 4489
   📊 Token totali: 4936
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 15466 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2847 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:07.583649
====================================================================================================
📋 Session ID: classify_1756466167
⏱️  Processing Time: 0.816s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (15466 chars):
   [UTENTE] Ciao! Sono Pimpa ❤️ [ASSISTENTE] Ciao Pimpa! Come posso esserti utile oggi? [UTENTE] Soffro di Anoressia  [ASSISTENTE] Come assistente digitale di Humanitas, il mio scopo è fornire informa...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (124 chars):
    {"predicted_label": "info_condizioni_patologiche", "confidence": 0.9, "motivation": "Domanda su una condizione patologica"}

📊 Parsed Response:
   predicted_label: info_condizioni_patologiche
   confidence: 0.9
   motivation: Domanda su una condizione patologica
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su una condizione patologica
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 3b98a6346aac3d5c644d1a0470dacc40 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 255
   📊 Token totali: 683
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 683 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 255
   📊 Token conversazione finale: 255
   📊 Token totali: 683
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 847 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2757 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:08.560099
====================================================================================================
📋 Session ID: classify_1756466168
⏱️  Processing Time: 0.865s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (847 chars):
   [UTENTE] GIULIA TU CONOSCI IL PACCHETTO COLON IRRITABILE [ASSISTENTE] Il pacchetto relativo alla sindrome del colon irritabile (o intestino irritabile) non è specificamente menzionato nei documenti...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (139 chars):
    {"predicted_label": "info_malattia", "confidence": 0.9, "motivation": "Domanda su un pacchetto di trattamento specifico per una malattia"}

📊 Parsed Response:
   predicted_label: info_malattia
   confidence: 0.9
   motivation: Domanda su un pacchetto di trattamento specifico per una malattia
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su un pacchetto di trattamento specifico per una malattia
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 05a99d0eb701e800f07c457c68bf4256 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 447
   💬 Token conversazione: 115
   📊 Token totali: 562
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 562 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 447
   📊 Token conversazione originale: 115
   📊 Token conversazione finale: 115
   📊 Token totali: 562
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 385 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2772 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:09.418186
====================================================================================================
📋 Session ID: classify_1756466169
⏱️  Processing Time: 0.750s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (385 chars):
   [UTENTE] Ciao Giulia, cosa vuol dire ICE? [ASSISTENTE] "ICE" è l'acronimo di "In Case of Emergency" (in caso di emergenza). Viene spesso utilizzato per indicare un contatto da chiamare in caso di e...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (98 chars):
    {"predicted_label": "info_ice", "confidence": 0.9, "motivation": "Domanda su cosa significa ICE"}

📊 Parsed Response:
   predicted_label: info_ice
   confidence: 0.9
   motivation: Domanda su cosa significa ICE
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su cosa significa ICE
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione e7dd50ce94013f05a68b4b633a35b9ea classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 130
   📊 Token totali: 578
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 578 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 130
   📊 Token conversazione finale: 130
   📊 Token totali: 578
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 433 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2873 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:10.345765
====================================================================================================
📋 Session ID: classify_1756466170
⏱️  Processing Time: 0.822s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (433 chars):
   [UTENTE] Informazioni vaccini  [ASSISTENTE] Puoi trovare informazioni dettagliate sui vaccini, inclusi i tipi disponibili, le modalità di somministrazione e le indicazioni, visitando la pagina dedi...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (115 chars):
    {"predicted_label": "info_vaccini", "confidence": 0.9, "motivation": "L'utente richiede informazioni sui vaccini"}

📊 Parsed Response:
   predicted_label: info_vaccini
   confidence: 0.9
   motivation: L'utente richiede informazioni sui vaccini
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente richiede informazioni sui vaccini
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 4ada1f2c0e7a44d0984089980736800c classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 143
   📊 Token totali: 591
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 591 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 143
   📊 Token conversazione finale: 143
   📊 Token totali: 591
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 465 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2792 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:11.344871
====================================================================================================
📋 Session ID: classify_1756466171
⏱️  Processing Time: 0.893s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (465 chars):
   [UTENTE] Morso gatto randagio, anti rabbia, vado al pronto soccorso? [ASSISTENTE] In caso di morso da un animale randagio, come un gatto, è importante agire rapidamente. Ti consiglio di recarti al ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (161 chars):
    {"predicted_label": "info_morso", "confidence": 0.9, "motivation": "L'utente ha chiesto informazioni su come procedere in caso di morso da un animale randagio"}

📊 Parsed Response:
   predicted_label: info_morso
   confidence: 0.9
   motivation: L'utente ha chiesto informazioni su come procedere in caso di morso da un animale randagio
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente ha chiesto informazioni su come procedere in caso di morso da un animale randagio
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 787e9493efcd884aa2f08434cc66fd90 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 287
   📊 Token totali: 736
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 736 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 287
   📊 Token conversazione finale: 287
   📊 Token totali: 736
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1020 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2865 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:12.259270
====================================================================================================
📋 Session ID: classify_1756466172
⏱️  Processing Time: 0.809s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1020 chars):
   [UTENTE] Non riesco a vedere gli esami online  [ASSISTENTE] Potresti dirmi che tipo di esame stai cercando di visualizzare online? Alcuni esami non sono consultabili online e devono essere ritirati...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (147 chars):
    {"predicted_label": "problema_visualizzazione_esami", "confidence": 0.8, "motivation": "Problema di visualizzazione degli esami online richiesto"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Problema di visualizzazione degli esami online richiesto
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Problema di visualizzazione degli esami online richiesto
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione f9d8f86ea510af30843b1b2ed6c21994 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 114
   📊 Token totali: 542
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 542 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 114
   📊 Token conversazione finale: 114
   📊 Token totali: 542
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 363 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2651 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:13.144371
====================================================================================================
📋 Session ID: classify_1756466173
⏱️  Processing Time: 0.780s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (363 chars):
   [UTENTE] Posso avere telefono ufficio referti  [ASSISTENTE] L'ufficio ritiro referti di Humanitas si trova in Via Sardegna 5, Fizzonasco di Pieve Emanuele. Per ulteriori informazioni, puoi visitare...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (115 chars):
    {"predicted_label": "info_contatti", "confidence": 0.9, "motivation": "Domanda sui contatti dell'ufficio referti"}

📊 Parsed Response:
   predicted_label: info_contatti
   confidence: 0.9
   motivation: Domanda sui contatti dell'ufficio referti
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda sui contatti dell'ufficio referti
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 9ebd75e21c44bf4a0feddfd09e4490fe classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 128
   📊 Token totali: 556
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 556 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 128
   📊 Token conversazione finale: 128
   📊 Token totali: 556
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 437 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2741 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:14.167271
====================================================================================================
📋 Session ID: classify_1756466174
⏱️  Processing Time: 0.916s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (437 chars):
   [UTENTE] Ciao Giulia, se faccio gli esami del sangue per creatinina e GFR domani mattina, entro quando ho i risultati? [ASSISTENTE] Il tuo referto sarà disponibile a partire dalla data e orario spe...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (153 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "L'utente chiede quando avrà i risultati degli esami di sangue per creatinina e GFR"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: L'utente chiede quando avrà i risultati degli esami di sangue per creatinina e GFR
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede quando avrà i risultati degli esami di sangue per creatinina e GFR
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 7fd088f1d2e657b33ae81ac1d864c7c2 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 272
   📊 Token totali: 721
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 721 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 272
   📊 Token conversazione finale: 272
   📊 Token totali: 721
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 930 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2876 chars (debug_prompt=False)
🔧 Creazione MongoClassificationReader per cliente: alleanza
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
✅ MongoClassificationReader alleanza creato con collection: alleanza_a0fd7600-f4f7-11ef-9315-96000228e7fe
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
✅ Connesso a MongoDB database: classificazioni
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:15.914587
====================================================================================================
📋 Session ID: classify_1756466175
⏱️  Processing Time: 1.641s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (930 chars):
   [UTENTE] Dopo quanto tempo scade una visita? [ASSISTENTE] Le ricette emesse prima del 30 dicembre 2024 hanno una validità di 180 giorni dalla data di prescrizione per effettuare la prenotazione. Le...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (355 chars):
    {"predicted_label": "info_prenotazione", "confidence": 0.9, "motivation": "La domanda riguarda il tempo di scadenza per una visita e la risposta fornita indica che le ricette emesse prima del 30 dicembre 2024 hanno una validità di 180 giorni dalla data di prescrizione per effettuare la prenotazi...

📊 Parsed Response:
   predicted_label: info_prenotazione
   confidence: 0.9
   motivation: La domanda riguarda il tempo di scadenza per una visita e la risposta fornita indica che le ricette emesse prima del 30 dicembre 2024 hanno una validità di 180 giorni dalla data di prescrizione per effettuare la prenotazione, quindi si tratta di informazioni sulla prenotazione
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   La domanda riguarda il tempo di scadenza per una visita e la risposta fornita indica che le ricette emesse prima del 30 dicembre 2024 hanno una validità di 180 giorni dalla data di prescrizione per effettuare la prenotazione, quindi si tratta di informazioni sulla prenotazione
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🔍 Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
🤖 LLM DIRECT CLASSIFICATION: Sessione ceaf3fa0028b23278fde0666a682d87c classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 240
   📊 Token totali: 688
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 688 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 240
   📊 Token conversazione finale: 240
   📊 Token totali: 688
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 856 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2850 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:16.845063
====================================================================================================
📋 Session ID: classify_1756466176
⏱️  Processing Time: 0.820s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (856 chars):
   [UTENTE] Ho prenotato Ho prenotato una risonanza magnetica alla spalla per il giorno 7 settembre presso la Clinica Pio decimo se prenoto la visita per il giorno successivo cioè 8 settembre il medic...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (114 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "Domanda sui risultati di un esame prenotato"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: Domanda sui risultati di un esame prenotato
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda sui risultati di un esame prenotato
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione ffc7adf73747fda9ccd6b009c4ecf308 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 239
   📊 Token totali: 688
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 688 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 239
   📊 Token conversazione finale: 239
   📊 Token totali: 688
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 746 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2814 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:17.828653
====================================================================================================
📋 Session ID: classify_1756466177
⏱️  Processing Time: 0.879s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (746 chars):
   [UTENTE] Ciao, vorrei prenotare dei prelievi venosi con SSN, mi indichi come faccio online? [ASSISTENTE] Per prenotare un prelievo venoso con il Servizio Sanitario Nazionale (SSN) presso Humanitas,...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (134 chars):
    {"predicted_label": "prenotazione_esame", "confidence": 0.9, "motivation": "L'utente vuole prenotare un esame di laboratorio online"}

📊 Parsed Response:
   predicted_label: prenotazione_esame
   confidence: 0.9
   motivation: L'utente vuole prenotare un esame di laboratorio online
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente vuole prenotare un esame di laboratorio online
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione e3ff9852018699bdcf8f77dbf1b526d0 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 113
   📊 Token totali: 562
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 562 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 113
   📊 Token conversazione finale: 113
   📊 Token totali: 562
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 370 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2859 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:18.790708
====================================================================================================
📋 Session ID: classify_1756466178
⏱️  Processing Time: 0.856s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (370 chars):
   [UTENTE] devo dare i campioni delle feci per coprocoltura e capotrectina [ASSISTENTE] Per consegnare campioni di materiale biologico, come le feci per coprocoltura e calprotectina, ti consiglio di ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (146 chars):
    {"predicted_label": "consegna_campioni", "confidence": 0.9, "motivation": "L'utente richiede informazioni su come consegnare campioni biologici"}

📊 Parsed Response:
   predicted_label: consegna_campioni
   confidence: 0.9
   motivation: L'utente richiede informazioni su come consegnare campioni biologici
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente richiede informazioni su come consegnare campioni biologici
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 5d95d01e6ea12269ed200be3eae0024a classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 186
   📊 Token totali: 635
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 635 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 186
   📊 Token conversazione finale: 186
   📊 Token totali: 635
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 567 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2846 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:19.997936
====================================================================================================
📋 Session ID: classify_1756466179
⏱️  Processing Time: 1.101s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (567 chars):
   [UTENTE] Il punto prelievi di viale sardegna è aperto in estate?  [ASSISTENTE] Il punto prelievi di Via Sardegna 5, Fizzonasco di Pieve Emanuele, è aperto durante l'estate con i seguenti orari: da ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (189 chars):
    {"predicted_label": "info_orario", "confidence": 0.9, "motivation": "L'utente chiede informazioni sui tempi di apertura del punto prelievi di Via Sardegna 5, Fizzonasco di Pieve Emanuele"}

📊 Parsed Response:
   predicted_label: info_orario
   confidence: 0.9
   motivation: L'utente chiede informazioni sui tempi di apertura del punto prelievi di Via Sardegna 5, Fizzonasco di Pieve Emanuele
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni sui tempi di apertura del punto prelievi di Via Sardegna 5, Fizzonasco di Pieve Emanuele
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione ca50df1e6c42c5be1e6a170ea90d7c6f classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 94
   📊 Token totali: 522
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 522 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 94
   📊 Token conversazione finale: 94
   📊 Token totali: 522
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 321 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2725 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:21.080096
====================================================================================================
📋 Session ID: classify_1756466181
⏱️  Processing Time: 0.976s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (321 chars):
   [UTENTE] Preparazione per coronografia  [ASSISTENTE] Per la preparazione alla coronarografia, è necessario eseguire l'esame a digiuno e viene effettuato in regime di ricovero. Per ulteriori dettagl...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (188 chars):
    {"predicted_label": "info_preparazione_esame", "confidence": 0.9, "motivation": "L'utente chiede informazioni sulla preparazione per un esame specifico, in questo caso la coronarografia"}

📊 Parsed Response:
   predicted_label: info_preparazione_esame
   confidence: 0.9
   motivation: L'utente chiede informazioni sulla preparazione per un esame specifico, in questo caso la coronarografia
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni sulla preparazione per un esame specifico, in questo caso la coronarografia
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 08172694b6e0077a2d8b2dd869a457ec classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 474
   📊 Token totali: 922
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 922 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 474
   📊 Token conversazione finale: 474
   📊 Token totali: 922
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1553 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2878 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:22.276998
====================================================================================================
📋 Session ID: classify_1756466182
⏱️  Processing Time: 1.091s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1553 chars):
   [UTENTE] Vorrei sapere se sabato 30 settembre 2025 è possibile fare gli esami del sangue Humanitas fiordaliso? [ASSISTENTE] Presso Humanitas Medical Care Rozzano-Fiordaliso, il sabato è possibile e...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (214 chars):
    {"predicted_label": "info_prenotazione", "confidence": 0.8, "motivation": "Domanda su quando e' possibile prenotare un esame di sangue presso Humanitas Medical Care Rozzano-Fiordaliso il sabato 30 settembre 2025"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda su quando e' possibile prenotare un esame di sangue presso Humanitas Medical Care Rozzano-Fiordaliso il sabato 30 settembre 2025
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda su quando e' possibile prenotare un esame di sangue presso Humanitas Medical Care Rozzano-Fiordaliso il sabato 30 settembre 2025
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 0e136e7f2019409187c6b0278433e590 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 204
   📊 Token totali: 632
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 632 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 204
   📊 Token conversazione finale: 204
   📊 Token totali: 632
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 646 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2683 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:23.199171
====================================================================================================
📋 Session ID: classify_1756466183
⏱️  Processing Time: 0.816s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (646 chars):
   [UTENTE] vorrei disdire un appuntamento [ASSISTENTE] Per disdire un appuntamento presso Humanitas, puoi seguire queste indicazioni:

1. **Prenotazioni private**: Puoi annullare tramite il portale [...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [77 more lines] ...
     Line 81: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (120 chars):
    {"predicted_label": "disdetta_appuntamento", "confidence": 0.9, "motivation": "L'utente vuole disdire un appuntamento"}

📊 Parsed Response:
   predicted_label: disdetta_appuntamento
   confidence: 0.9
   motivation: L'utente vuole disdire un appuntamento
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente vuole disdire un appuntamento
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 561cd119e94fd7da2a11e19b794f0b59 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 124
   📊 Token totali: 552
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 552 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 124
   📊 Token conversazione finale: 124
   📊 Token totali: 552
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 428 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2621 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:24.123811
====================================================================================================
📋 Session ID: classify_1756466184
⏱️  Processing Time: 0.819s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (428 chars):
   [UTENTE] Buongiorno ho disdetto una visita privata usando la segreteria telefonica come da istruzioni. La conferma di disdetta viene mandata via e.mail? [ASSISTENTE] Non ho informazioni specifiche ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (131 chars):
    {"predicted_label": "info_disdetta_visita", "confidence": 0.9, "motivation": "Domanda riguardante una disdetta di visita privata"}

📊 Parsed Response:
   predicted_label: info_disdetta_visita
   confidence: 0.9
   motivation: Domanda riguardante una disdetta di visita privata
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda riguardante una disdetta di visita privata
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione ed4b837eb3ba2dc5310b8a6d16a39e73 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 287
   📊 Token totali: 735
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 735 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 287
   📊 Token conversazione finale: 287
   📊 Token totali: 735
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 978 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2856 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:25.095939
====================================================================================================
📋 Session ID: classify_1756466185
⏱️  Processing Time: 0.866s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (978 chars):
   [UTENTE] Buongiorno volevo sapere quale è la tempistica per l'annullamento di una visita in regime privato Grazie [ASSISTENTE] Per annullare una visita in regime privato, è necessario farlo almeno ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (139 chars):
    {"predicted_label": "info_annullamento_visita", "confidence": 0.9, "motivation": "Domanda su come annullare una visita in regime privato"}

📊 Parsed Response:
   predicted_label: info_annullamento_visita
   confidence: 0.9
   motivation: Domanda su come annullare una visita in regime privato
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come annullare una visita in regime privato
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 47950ed6055043e0200bd4736615170d classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 425
   📊 Token totali: 853
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 853 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 425
   📊 Token conversazione finale: 425
   📊 Token totali: 853
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1383 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2685 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:26.131897
====================================================================================================
📋 Session ID: classify_1756466186
⏱️  Processing Time: 0.931s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1383 chars):
   [UTENTE] Ho prenotato un prelievo venoso tramite assicurazione per una data ma dovrei spostare l'appuntamento. E' possibile farlo visto che l'autorizzazione dell'assicurazione ha un determinato per...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (161 chars):
    {"predicted_label": "cambio_appuntamento", "confidence": 0.9, "motivation": "Domanda su come spostare un appuntamento di prelievo venoso tramite assicurazione"}

📊 Parsed Response:
   predicted_label: cambio_appuntamento
   confidence: 0.9
   motivation: Domanda su come spostare un appuntamento di prelievo venoso tramite assicurazione
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come spostare un appuntamento di prelievo venoso tramite assicurazione
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 93e307139bd3a7bd30aff9b98e043652 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 183
   📊 Token totali: 611
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 611 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 183
   📊 Token conversazione finale: 183
   📊 Token totali: 611
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 628 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2695 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:27.007517
====================================================================================================
📋 Session ID: classify_1756466187
⏱️  Processing Time: 0.769s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (628 chars):
   [UTENTE] Come vedo se una prenotazione è stata annullata?  [ASSISTENTE] Per verificare se una prenotazione è stata annullata, puoi accedere all’area “Miei appuntamenti” sul sito [Humanitas con te](...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (133 chars):
    {"predicted_label": "info_prenotazione", "confidence": 0.9, "motivation": "Domanda su come verificare lo stato di una prenotazione"}

📊 Parsed Response:
   predicted_label: info_prenotazione
   confidence: 0.9
   motivation: Domanda su come verificare lo stato di una prenotazione
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come verificare lo stato di una prenotazione
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 25fe727a43271a08704e9da0ea3af470 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 568
   📊 Token totali: 1016
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 1016 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 568
   📊 Token conversazione finale: 568
   📊 Token totali: 1016
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1706 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2624 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:27.936171
====================================================================================================
📋 Session ID: classify_1756466187
⏱️  Processing Time: 0.823s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1706 chars):
   [UTENTE] Ciao Giulia, domani ho una visita. Come posso arrivare in Humanitas? [ASSISTENTE] Da dove parti e in quale sede Humanitas devi arrivare? Inoltre, preferisci utilizzare l'auto, i mezzi pubb...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (124 chars):
    {"predicted_label": "info_visita", "confidence": 0.9, "motivation": "Domanda riguardante una visita al centro ospedaliero"}

📊 Parsed Response:
   predicted_label: info_visita
   confidence: 0.9
   motivation: Domanda riguardante una visita al centro ospedaliero
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda riguardante una visita al centro ospedaliero
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 094dd46d9b78f8dad0d021f7b3741c05 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 85
   📊 Token totali: 513
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 513 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 85
   📊 Token conversazione finale: 85
   📊 Token totali: 513
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 267 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2737 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:28.917675
====================================================================================================
📋 Session ID: classify_1756466188
⏱️  Processing Time: 0.876s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (267 chars):
   [UTENTE] La linea 220 è extraurbana? [ASSISTENTE] Sì, la linea 220 è una linea extraurbana che collega Humanitas con Pieve Emanuele, Opera e Locate, partendo da Rozzano, via della Solidarietà【6:0†s...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (132 chars):
    {"predicted_label": "info_linea", "confidence": 0.9, "motivation": "Domanda su dove si trova la linea 220 e sulle città che serve"}

📊 Parsed Response:
   predicted_label: info_linea
   confidence: 0.9
   motivation: Domanda su dove si trova la linea 220 e sulle città che serve
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su dove si trova la linea 220 e sulle città che serve
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 8b42ef48bf61435ee6b34184131a5418 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 161
   📊 Token totali: 589
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 589 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 161
   📊 Token conversazione finale: 161
   📊 Token totali: 589
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 529 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2502 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:29.599828
====================================================================================================
📋 Session ID: classify_1756466189
⏱️  Processing Time: 0.576s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (529 chars):
   [UTENTE] Buongiorno. Esiste ancora il servizio navetta che ti porta dalla metropolitana di Abbiategrasso all'ospedale Humanitas ? [ASSISTENTE] Sì, esiste ancora un servizio di trasporto pubblico ch...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (95 chars):
    {"predicted_label": "info_benvenuto", "confidence": 0.9, "motivation": "Domanda di benvenuto"}

📊 Parsed Response:
   predicted_label: info_benvenuto
   confidence: 0.9
   motivation: Domanda di benvenuto
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda di benvenuto
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 2f23911465f38b6123f687633306d10c classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 182
   📊 Token totali: 630
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 630 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 182
   📊 Token conversazione finale: 182
   📊 Token totali: 630
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 587 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2843 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:30.502619
====================================================================================================
📋 Session ID: classify_1756466190
⏱️  Processing Time: 0.797s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (587 chars):
   [UTENTE] Volevo chiedere se ce il servizio transfer ? [ASSISTENTE] Potresti specificare meglio cosa intendi per "servizio transfer"? Ti riferisci a un servizio di trasporto da e per l'ospedale, opp...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (130 chars):
    {"predicted_label": "info_trasporto", "confidence": 0.8, "motivation": "Domanda su un servizio di trasporto da e per l'ospedale"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda su un servizio di trasporto da e per l'ospedale
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda su un servizio di trasporto da e per l'ospedale
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione d0684fe510373586ea1882e862fa606e classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 136
   📊 Token totali: 585
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 585 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 136
   📊 Token conversazione finale: 136
   📊 Token totali: 585
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 493 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2763 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:31.423953
====================================================================================================
📋 Session ID: classify_1756466191
⏱️  Processing Time: 0.815s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (493 chars):
   [UTENTE] Voglio visionare i miei referti online [ASSISTENTE] Per visionare i tuoi referti online, è necessario registrarsi a [Humanitas con te](https://www.humanitasconte.it). Una volta registrato,...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (123 chars):
    {"predicted_label": "info_referti", "confidence": 0.9, "motivation": "L'utente chiede di visionare i suoi referti online"}

📊 Parsed Response:
   predicted_label: info_referti
   confidence: 0.9
   motivation: L'utente chiede di visionare i suoi referti online
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede di visionare i suoi referti online
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione f64fbee98f98a2c83c37373a473f1f69 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 128
   📊 Token totali: 556
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 556 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 128
   📊 Token conversazione finale: 128
   📊 Token totali: 556
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 429 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2743 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:32.515488
====================================================================================================
📋 Session ID: classify_1756466192
⏱️  Processing Time: 0.986s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (429 chars):
   [UTENTE] non so come verificare la mia postazione  [ASSISTENTE] Per verificare la tua postazione o il luogo di accettazione per una visita o esame, puoi consultare la sezione "Miei appuntamenti" de...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (173 chars):
    {"predicted_label": "info_miei_appuntamenti", "confidence": 0.9, "motivation": "Domanda su come verificare la postazione o il luogo di accettazione per una visita o esame"}

📊 Parsed Response:
   predicted_label: info_miei_appuntamenti
   confidence: 0.9
   motivation: Domanda su come verificare la postazione o il luogo di accettazione per una visita o esame
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come verificare la postazione o il luogo di accettazione per una visita o esame
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 636b13b7899b5f48f73cab8a20b442e7 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 98
   📊 Token totali: 526
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 526 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 98
   📊 Token conversazione finale: 98
   📊 Token totali: 526
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 308 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2656 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:33.511098
====================================================================================================
📋 Session ID: classify_1756466193
⏱️  Processing Time: 0.889s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (308 chars):
   [UTENTE] Fatturazione [ASSISTENTE] Puoi consultare e scaricare le tue fatture direttamente dal portale [Humanitas con te](https://www.humanitasconte.it). Accedi con le tue credenziali, vai alla sez...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (162 chars):
    {"predicted_label": "info_fatturazione", "confidence": 0.9, "motivation": "L'utente è informato su come consultare e scaricare le fatture dal portale Humanitas"}

📊 Parsed Response:
   predicted_label: info_fatturazione
   confidence: 0.9
   motivation: L'utente è informato su come consultare e scaricare le fatture dal portale Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente è informato su come consultare e scaricare le fatture dal portale Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 92b438ff69e40821dc52e3b2012f7b60 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 481
   📊 Token totali: 929
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 929 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 481
   📊 Token conversazione finale: 481
   📊 Token totali: 929
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1502 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2810 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:34.499956
====================================================================================================
📋 Session ID: classify_1756466194
⏱️  Processing Time: 0.866s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1502 chars):
   [UTENTE] come scaricare la prenotazione di un esame [ASSISTENTE] Per scaricare la prenotazione di un esame, è necessario accedere al portale [Humanitas con te](https://www.humanitasconte.it). Dopo ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (132 chars):
    {"predicted_label": "info_prenotazione", "confidence": 0.9, "motivation": "Domanda su come scaricare una prenotazione di un esame"}

📊 Parsed Response:
   predicted_label: info_prenotazione
   confidence: 0.9
   motivation: Domanda su come scaricare una prenotazione di un esame
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come scaricare una prenotazione di un esame
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 244e3645f6ed55b7bdfd90c5cac927f7 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 97
   📊 Token totali: 525
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 525 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 97
   📊 Token conversazione finale: 97
   📊 Token totali: 525
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 336 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2616 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:35.458113
====================================================================================================
📋 Session ID: classify_1756466195
⏱️  Processing Time: 0.852s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (336 chars):
   [UTENTE] Non ho ancora ricevuto il messaggio per il ritiro del RX del 01.08 [ASSISTENTE] Per verificare lo stato del referto, ti consiglio di contattare il servizio dedicato compilando il modulo di...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (135 chars):
    {"predicted_label": "problema_ritiro_RX", "confidence": 0.9, "motivation": "Domanda su un problema con il ritiro di una prescrizione"}

📊 Parsed Response:
   predicted_label: problema_ritiro_rx
   confidence: 0.9
   motivation: Domanda su un problema con il ritiro di una prescrizione
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su un problema con il ritiro di una prescrizione
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 2b17e5dd553ce95d37370e4b03146537 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 295
   📊 Token totali: 743
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 743 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 295
   📊 Token conversazione finale: 295
   📊 Token totali: 743
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 952 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2687 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:36.432788
====================================================================================================
📋 Session ID: classify_1756466196
⏱️  Processing Time: 0.869s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (952 chars):
   [UTENTE] P7 castellanza [ASSISTENTE] Non ho informazioni specifiche sul parcheggio P7 a Castellanza. Tuttavia, se hai bisogno di informazioni sui parcheggi o su come raggiungere una delle sedi di H...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (142 chars):
    {"predicted_label": "info_parcheggio", "confidence": 0.9, "motivation": "Domanda su informazioni specifiche sul parcheggio P7 a Castellanza"}

📊 Parsed Response:
   predicted_label: info_parcheggio
   confidence: 0.9
   motivation: Domanda su informazioni specifiche sul parcheggio P7 a Castellanza
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su informazioni specifiche sul parcheggio P7 a Castellanza
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 9e2176698f02b81f1a6ecbf79bf9d863 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 116
   📊 Token totali: 544
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 544 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 116
   📊 Token conversazione finale: 116
   📊 Token totali: 544
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 327 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2702 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:37.426755
====================================================================================================
📋 Session ID: classify_1756466197
⏱️  Processing Time: 0.887s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (327 chars):
   [UTENTE] Costo parcheggio P4 [ASSISTENTE] Il costo del parcheggio P4 è il seguente:

- Prima ora (o frazione di ora): € 2,00;
- Ora o frazione successiva: € 2,00;
- Giornata intera: € 8,00.

Per ma...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [77 more lines] ...
     Line 81: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (132 chars):
    {"predicted_label": "info_parcheggio", "confidence": 0.9, "motivation": "L'utente chiede informazioni sul costo del parcheggio P4"}

📊 Parsed Response:
   predicted_label: info_parcheggio
   confidence: 0.9
   motivation: L'utente chiede informazioni sul costo del parcheggio P4
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni sul costo del parcheggio P4
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione dda3b104960241c9488ad8199585f8a0 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 167
   📊 Token totali: 595
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 595 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 167
   📊 Token conversazione finale: 167
   📊 Token totali: 595
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 554 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2739 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:38.299465
====================================================================================================
📋 Session ID: classify_1756466198
⏱️  Processing Time: 0.767s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (554 chars):
   [UTENTE] cosa include il pacchettp p [ASSISTENTE] Non ho trovato informazioni specifiche sul "pacchetto p" nei documenti caricati. Potresti fornirmi maggiori dettagli o chiarire a cosa ti riferisci...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (146 chars):
    {"predicted_label": "info_pacchetto", "confidence": 0.6, "motivation": "L'utente chiede informazioni su un pacchetto specifico non identificato"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.39999999999999997
   motivation: L'utente chiede informazioni su un pacchetto specifico non identificato
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.400
   [███████░░░░░░░░░░░░░] 40.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni su un pacchetto specifico non identificato
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 52ede270308eb3d573a70134426f6525 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 146
   📊 Token totali: 594
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 594 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 146
   📊 Token conversazione finale: 146
   📊 Token totali: 594
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 489 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2799 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:39.168614
====================================================================================================
📋 Session ID: classify_1756466199
⏱️  Processing Time: 0.764s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (489 chars):
   [UTENTE] Posso pagare il parcheggio con l'app easy park? [ASSISTENTE] Non ho informazioni specifiche sull'utilizzo dell'app EasyPark per il pagamento del parcheggio presso Humanitas. Tuttavia, poss...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (129 chars):
    {"predicted_label": "info_parcheggio", "confidence": 0.8, "motivation": "Domanda su come pagare il parcheggio presso Humanitas"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda su come pagare il parcheggio presso Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda su come pagare il parcheggio presso Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 22b97fda51adf4a0d4e203293986d3e6 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 82
   📊 Token totali: 510
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 510 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 82
   📊 Token conversazione finale: 82
   📊 Token totali: 510
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 279 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2779 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:40.152014
====================================================================================================
📋 Session ID: classify_1756466200
⏱️  Processing Time: 0.878s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (279 chars):
   [UTENTE] Ho bisogno di un oncologo [ASSISTENTE] Per avere informazioni specifiche sui medici oncologi di Humanitas, ti consiglio di visitare la pagina dedicata alla [Ricerca Medici](https://www.hum...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (137 chars):
    {"predicted_label": "info_medico", "confidence": 0.9, "motivation": "L'utente ha chiesto informazioni sui medici oncologi di Humanitas"}

📊 Parsed Response:
   predicted_label: info_medico
   confidence: 0.9
   motivation: L'utente ha chiesto informazioni sui medici oncologi di Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente ha chiesto informazioni sui medici oncologi di Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione e6810c2a4142fea56170c5119b4324f0 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 236
   📊 Token totali: 664
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 664 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 236
   📊 Token conversazione finale: 236
   📊 Token totali: 664
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 773 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2779 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:41.266244
====================================================================================================
📋 Session ID: classify_1756466201
⏱️  Processing Time: 1.009s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (773 chars):
   [UTENTE] Cerco oncologo che tratti tumore pancreas con metastasi fegato  [ASSISTENTE] Per il trattamento del tumore al pancreas con metastasi epatiche, Humanitas offre un approccio multidisciplinar...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (183 chars):
    {"predicted_label": "info_oncologo", "confidence": 0.9, "motivation": "L'utente sta cercando informazioni su un oncologo specializzato in tumori del pancreas con metastasi epatiche"}

📊 Parsed Response:
   predicted_label: info_oncologo
   confidence: 0.9
   motivation: L'utente sta cercando informazioni su un oncologo specializzato in tumori del pancreas con metastasi epatiche
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente sta cercando informazioni su un oncologo specializzato in tumori del pancreas con metastasi epatiche
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione cf269492799fa61e3379452b2c7e7557 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 290
   📊 Token totali: 718
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 718 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 290
   📊 Token conversazione finale: 290
   📊 Token totali: 718
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 979 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2693 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:42.241509
====================================================================================================
📋 Session ID: classify_1756466202
⏱️  Processing Time: 0.869s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (979 chars):
   [UTENTE] Volevo elenco medici humanity’s per gastroenterologos [ASSISTENTE] Per informazioni sui medici specializzati in gastroenterologia presso Humanitas, puoi consultare le seguenti unità operat...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (163 chars):
    {"predicted_label": "info_medico", "confidence": 0.9, "motivation": "L'utente chiede informazioni sui medici specializzati in gastroenterologia presso Humanitas"}

📊 Parsed Response:
   predicted_label: info_medico
   confidence: 0.9
   motivation: L'utente chiede informazioni sui medici specializzati in gastroenterologia presso Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni sui medici specializzati in gastroenterologia presso Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 880f12cd8a9ca920769f71bf440a4f5d classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 105
   📊 Token totali: 533
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 533 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 105
   📊 Token conversazione finale: 105
   📊 Token totali: 533
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 371 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2774 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:43.235635
====================================================================================================
📋 Session ID: classify_1756466203
⏱️  Processing Time: 0.888s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (371 chars):
   [UTENTE] come posso contattare la struttura del Dottor Carlo Castoro per la conferma di un appuntamento ? [ASSISTENTE] Per ottenere informazioni specifiche sul Dottor Carlo Castoro e sulla struttur...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (164 chars):
    {"predicted_label": "info_prenotazione", "confidence": 0.9, "motivation": "Domanda su come contattare per conferma di un appuntamento con il Dottor Carlo Castoro"}

📊 Parsed Response:
   predicted_label: info_prenotazione
   confidence: 0.9
   motivation: Domanda su come contattare per conferma di un appuntamento con il Dottor Carlo Castoro
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come contattare per conferma di un appuntamento con il Dottor Carlo Castoro
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 8bf990eba6830f9587452d2ef5b349cf classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 207
   📊 Token totali: 655
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 655 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 207
   📊 Token conversazione finale: 207
   📊 Token totali: 655
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 741 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2773 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:44.270320
====================================================================================================
📋 Session ID: classify_1756466204
⏱️  Processing Time: 0.929s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (741 chars):
   [UTENTE] Vorrei richiedere la cartella online [ASSISTENTE] Puoi richiedere la cartella clinica online tramite l'area referti di [Humanitas con te](https://www.humanitasconte.it). Se hai bisogno di ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (168 chars):
    {"predicted_label": "info_ritiro_referto_cartella_clinica", "confidence": 0.9, "motivation": "Richiesta di informazioni sulla richiesta della cartella clinica online"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto_cartella_clinica
   confidence: 0.9
   motivation: Richiesta di informazioni sulla richiesta della cartella clinica online
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta di informazioni sulla richiesta della cartella clinica online
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 681d4afc1e0e843fa5b35ff5ce0b9999 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 170
   📊 Token totali: 598
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 598 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 170
   📊 Token conversazione finale: 170
   📊 Token totali: 598
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 599 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2731 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:45.350866
====================================================================================================
📋 Session ID: classify_1756466205
⏱️  Processing Time: 0.975s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (599 chars):
   [UTENTE] Buon giorno sono Oriana corradino in data 30 luglio ho fatto la spirometria a torino nel vostro centro mi doveva arrivare il referto via mail ma non mi è arrivato  [ASSISTENTE] Se non hai ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (203 chars):
    {"predicted_label": "problema_amministrativo", "confidence": 0.8, "motivation": "L'utente ha ricevuto un referto ma non lo ha ancora ricevuto via email, quindi si tratta di un problema amministrativo."}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: L'utente ha ricevuto un referto ma non lo ha ancora ricevuto via email, quindi si tratta di un problema amministrativo.
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   L'utente ha ricevuto un referto ma non lo ha ancora ricevuto via email, quindi si tratta di un problema amministrativo.
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione bdb04270dbcec6ec7d43a8c78a1edc22 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 257
   📊 Token totali: 706
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 706 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 257
   📊 Token conversazione finale: 257
   📊 Token totali: 706
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 848 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2763 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:46.195011
====================================================================================================
📋 Session ID: classify_1756466206
⏱️  Processing Time: 0.738s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (848 chars):
   [UTENTE] io circa Anna mia cosa fare [ASSISTENTE] Potresti spiegarmi meglio la tua richiesta? Così posso aiutarti nel modo più adeguato. [UTENTE] Buongiorno Giulia  [ASSISTENTE] Buongiorno! Come po...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (131 chars):
    {"predicted_label": "info_aiuto", "confidence": 0.8, "motivation": "L'utente ha chiesto informazioni su come ricevere assistenza"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: L'utente ha chiesto informazioni su come ricevere assistenza
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   L'utente ha chiesto informazioni su come ricevere assistenza
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 437f07ded15971033a82bf41d20041ff classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 231
   📊 Token totali: 679
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 679 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 231
   📊 Token conversazione finale: 231
   📊 Token totali: 679
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 787 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2751 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:47.340652
====================================================================================================
📋 Session ID: classify_1756466207
⏱️  Processing Time: 1.041s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (787 chars):
   [UTENTE] Sto aspettando che qualcuno mi contatti con URGENZA per poter scaricare gli esami di laboratorio fatti a Torino in Humaniyas Cellini pet Luciana Sanna e Leandro Difino. Sono urgentissimo e...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (189 chars):
    {"predicted_label": "info_ritiro_esami", "confidence": 0.9, "motivation": "Domanda su come scaricare gli esami di laboratorio fatti a Torino in un'unità specifica dell'ospedale Humanitas"}

📊 Parsed Response:
   predicted_label: info_ritiro_esami
   confidence: 0.9
   motivation: Domanda su come scaricare gli esami di laboratorio fatti a Torino in un'unità specifica dell'ospedale Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come scaricare gli esami di laboratorio fatti a Torino in un'unità specifica dell'ospedale Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 2542996825cf2262442ba8028f52d2af classificata tramite LLM diretto (classificazione=unknown)
   📈 Progresso LLM: 50/166
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 242
   📊 Token totali: 690
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 690 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 242
   📊 Token conversazione finale: 242
   📊 Token totali: 690
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 845 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2852 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:48.534138
====================================================================================================
📋 Session ID: classify_1756466208
⏱️  Processing Time: 1.089s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (845 chars):
   [UTENTE] Vorrei sapere la tariffa agevolata con mètaSalute di rmn aperta rachide cervicale senza contrasto humanitas Rozzano  [ASSISTENTE] Non ho trovato informazioni specifiche sulla tariffa agevo...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (241 chars):
    {"predicted_label": "info_tariffa", "confidence": 0.7, "motivation": "L'utente ha chiesto informazioni sulla tariffa agevolata con mètaSalute per la risonanza magnetica aperta del rachide cervicale senza contrasto presso Humanitas Rozzano"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.49999999999999994
   motivation: L'utente ha chiesto informazioni sulla tariffa agevolata con mètaSalute per la risonanza magnetica aperta del rachide cervicale senza contrasto presso Humanitas Rozzano
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.500
   [█████████░░░░░░░░░░░] 50.0%

🧠 Reasoning/Motivation:
   L'utente ha chiesto informazioni sulla tariffa agevolata con mètaSalute per la risonanza magnetica aperta del rachide cervicale senza contrasto presso Humanitas Rozzano
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione afd4014c5ca4c54e07c2de2688922d18 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 158
   📊 Token totali: 586
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 586 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 158
   📊 Token conversazione finale: 158
   📊 Token totali: 586
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 521 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2816 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:49.485064
====================================================================================================
📋 Session ID: classify_1756466209
⏱️  Processing Time: 0.845s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (521 chars):
   [UTENTE] Buon giorno, sto cercando di capire se il vs istituto fornisce anche la medicina nucleare ed in particolare Cintigrafia cerebrale [ASSISTENTE] Sì, l'Istituto Clinico Humanitas offre serviz...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (132 chars):
    {"predicted_label": "info_medicina_nucleare", "confidence": 0.9, "motivation": "Richiesta di informazioni sulla medicina nucleare"}

📊 Parsed Response:
   predicted_label: info_medicina_nucleare
   confidence: 0.9
   motivation: Richiesta di informazioni sulla medicina nucleare
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta di informazioni sulla medicina nucleare
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 6512d16919369ef5bd4dac2c199f7010 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 173
   📊 Token totali: 601
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 601 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 173
   📊 Token conversazione finale: 173
   📊 Token totali: 601
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 618 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2770 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:50.330985
====================================================================================================
📋 Session ID: classify_1756466210
⏱️  Processing Time: 0.740s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (618 chars):
   [UTENTE] Salve volevo chiedere se eseguite la radiografia colonna completa sotto carico con metodo eos [ASSISTENTE] Sì, Humanitas esegue la radiografia della colonna vertebrale completa, utile per ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (112 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "Domanda su un esame diagnostico specifico"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: Domanda su un esame diagnostico specifico
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su un esame diagnostico specifico
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione ce1f4d3ffa6b071d1ab717c7872d253a classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 172
   📊 Token totali: 620
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 620 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 172
   📊 Token conversazione finale: 172
   📊 Token totali: 620
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 583 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2854 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:51.209408
====================================================================================================
📋 Session ID: classify_1756466211
⏱️  Processing Time: 0.773s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (583 chars):
   [UTENTE] Buongiorno,  vorrei sapere se fate la mammografia in 3d [ASSISTENTE] Sì, presso Humanitas è possibile effettuare la mammografia in Tomosintesi, una tecnica avanzata che consente una valuta...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (107 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "Domanda su un esame medico specifico"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: Domanda su un esame medico specifico
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su un esame medico specifico
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione fe179b6339df101273ac93bc3435d1a6 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 68
   📊 Token totali: 517
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 517 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 68
   📊 Token conversazione finale: 68
   📊 Token totali: 517
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 227 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2780 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:52.243072
====================================================================================================
📋 Session ID: classify_1756466212
⏱️  Processing Time: 0.929s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (227 chars):
   [UTENTE] Voglio parlare con un operatore  [ASSISTENTE] Puoi contattare il servizio centralino di Humanitas al numero 02 822 41 per parlare con un operatore umano. Se hai bisogno di ulteriori inform...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (159 chars):
    {"predicted_label": "info_contatti", "confidence": 0.9, "motivation": "L'utente chiede di contattare un operatore umano del servizio centralino di Humanitas"}

📊 Parsed Response:
   predicted_label: info_contatti
   confidence: 0.9
   motivation: L'utente chiede di contattare un operatore umano del servizio centralino di Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede di contattare un operatore umano del servizio centralino di Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 58dcea97d71b6960da7e90df6b17bb0c classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 56
   📊 Token totali: 504
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 504 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 56
   📊 Token conversazione finale: 56
   📊 Token totali: 504
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 179 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2751 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:53.167225
====================================================================================================
📋 Session ID: classify_1756466213
⏱️  Processing Time: 0.818s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (179 chars):
   [UTENTE] Mi serce io numero del centralino grazie  [ASSISTENTE] Il numero del centralino di Humanitas è 02 8224 1. Se hai bisogno di ulteriori informazioni, sono qui per aiutarti!

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (127 chars):
    {"predicted_label": "info_contatto", "confidence": 0.9, "motivation": "L'utente chiede il numero del centralino di Humanitas"}

📊 Parsed Response:
   predicted_label: info_contatto
   confidence: 0.9
   motivation: L'utente chiede il numero del centralino di Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede il numero del centralino di Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 3635a11a107d03df46aba779fb4d3f3c classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 87
   📊 Token totali: 515
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 515 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 87
   📊 Token conversazione finale: 87
   📊 Token totali: 515
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 299 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2779 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:54.067934
====================================================================================================
📋 Session ID: classify_1756466214
⏱️  Processing Time: 0.796s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (299 chars):
   [UTENTE] Numero di telefono ritiro referti [ASSISTENTE] Il numero di telefono specifico per il ritiro referti non è indicato. Ti consiglio di contattare il centralino di Humanitas al numero 02 8224...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (114 chars):
    {"predicted_label": "info_ritiro_referto", "confidence": 0.9, "motivation": "Domanda su come ritirare i referti"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto
   confidence: 0.9
   motivation: Domanda su come ritirare i referti
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come ritirare i referti
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 1e9a8529a34b030126ab8ab1e771b5fc classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 88
   📊 Token totali: 516
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 516 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 88
   📊 Token conversazione finale: 88
   📊 Token totali: 516
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 292 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2772 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:54.941523
====================================================================================================
📋 Session ID: classify_1756466214
⏱️  Processing Time: 0.766s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (292 chars):
   [UTENTE] Ho una televisita ma il medico non c'è  [ASSISTENTE] Mi dispiace per l'inconveniente. Ti consiglio di contattare il centralino di Humanitas al numero 02 822 41 per segnalare il problema e ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (139 chars):
    {"predicted_label": "problema_accesso_visita", "confidence": 0.9, "motivation": "L'utente ha segnalato un problema con una visita medica"}

📊 Parsed Response:
   predicted_label: problema_accesso_visita
   confidence: 0.9
   motivation: L'utente ha segnalato un problema con una visita medica
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente ha segnalato un problema con una visita medica
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione a1ba7c5135dd160b2685280c3e38634c classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 157
   📊 Token totali: 606
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 606 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 157
   📊 Token conversazione finale: 157
   📊 Token totali: 606
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 517 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2878 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:55.923099
====================================================================================================
📋 Session ID: classify_1756466215
⏱️  Processing Time: 0.876s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (517 chars):
   [UTENTE] devo richiedere una cartella clinica [ASSISTENTE] Puoi richiedere il rilascio delle cartelle cliniche dei ricoveri svolti presso l'Istituto Clinico Humanitas online dall’area referti di [H...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (130 chars):
    {"predicted_label": "ricerca_cartella_clinica", "confidence": 0.9, "motivation": "Richiesta di rilascio delle cartelle cliniche"}

📊 Parsed Response:
   predicted_label: ricerca_cartella_clinica
   confidence: 0.9
   motivation: Richiesta di rilascio delle cartelle cliniche
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta di rilascio delle cartelle cliniche
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione ee20cf335f29e8d397ac6070f4f1569e classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 106
   📊 Token totali: 554
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 554 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 106
   📊 Token conversazione finale: 106
   📊 Token totali: 554
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 368 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2819 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:56.987287
====================================================================================================
📋 Session ID: classify_1756466216
⏱️  Processing Time: 0.956s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (368 chars):
   [UTENTE] Ho bisogno la cartella clinica di un deceduto  [ASSISTENTE] Per richiedere la cartella clinica di una persona deceduta, è necessario seguire una procedura specifica. Ti consiglio di consul...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (158 chars):
    {"predicted_label": "info_ritiro_referto_cartella_clinica", "confidence": 0.9, "motivation": "L'utente richiede la cartella clinica di una persona deceduta"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto_cartella_clinica
   confidence: 0.9
   motivation: L'utente richiede la cartella clinica di una persona deceduta
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente richiede la cartella clinica di una persona deceduta
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 5458db5557b93ade31b4ce36f80732cb classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 124
   📊 Token totali: 572
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 572 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 124
   📊 Token conversazione finale: 124
   📊 Token totali: 572
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 447 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2782 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:57.902501
====================================================================================================
📋 Session ID: classify_1756466217
⏱️  Processing Time: 0.810s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (447 chars):
   [UTENTE] Richiesta preparati istologici  [ASSISTENTE] Per quanto riguarda i preparati istologici, è importante sapere che i referti istologici con esito positivo non possono essere delegati per il ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (128 chars):
    {"predicted_label": "info_preparati_istologici", "confidence": 0.9, "motivation": "Domanda sui preparati istologici richiesti"}

📊 Parsed Response:
   predicted_label: info_preparati_istologici
   confidence: 0.9
   motivation: Domanda sui preparati istologici richiesti
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda sui preparati istologici richiesti
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 4dcacdbbe4bc66b785aa20f98c67981a classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 175
   📊 Token totali: 603
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 603 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 175
   📊 Token conversazione finale: 175
   📊 Token totali: 603
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 580 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2613 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:16:58.997514
====================================================================================================
📋 Session ID: classify_1756466218
⏱️  Processing Time: 0.989s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (580 chars):
   [UTENTE] cartella clinica persona deceduta [ASSISTENTE] Per richiedere la cartella clinica di una persona deceduta, è necessario esercitare i diritti previsti dall'art. 2-terdecies del Codice in ma...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (192 chars):
    {"predicted_label": "info_ritiro_referto_cartella_clinica", "confidence": 0.9, "motivation": "Richiesta informazioni sulla procedura per ritirare la cartella clinica di una persona deceduta"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto_cartella_clinica
   confidence: 0.9
   motivation: Richiesta informazioni sulla procedura per ritirare la cartella clinica di una persona deceduta
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta informazioni sulla procedura per ritirare la cartella clinica di una persona deceduta
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 3f3c2e85a21279ca6e6dcd8204b43cb4 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 590
   📊 Token totali: 1038
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 1038 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 590
   📊 Token conversazione finale: 590
   📊 Token totali: 1038
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 2022 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2766 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:00.006656
====================================================================================================
📋 Session ID: classify_1756466220
⏱️  Processing Time: 0.903s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (2022 chars):
   [UTENTE] Buongiorno sto cercando una cartella  clinica [ASSISTENTE] Per richiedere una cartella clinica, puoi farlo online tramite l’area referti di [Humanitas con te](https://www.humanitasconte.it...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (151 chars):
    {"predicted_label": "info_ritiro_referto_cartella_clinica", "confidence": 0.9, "motivation": "Domanda su come richiedere una cartella clinica online"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto_cartella_clinica
   confidence: 0.9
   motivation: Domanda su come richiedere una cartella clinica online
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come richiedere una cartella clinica online
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 8e6a188964cee438a18e98e4a36b19d4 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 353
   📊 Token totali: 801
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 801 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 353
   📊 Token conversazione finale: 353
   📊 Token totali: 801
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1143 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2836 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:00.986880
====================================================================================================
📋 Session ID: classify_1756466220
⏱️  Processing Time: 0.874s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1143 chars):
   [UTENTE] Buongiorno, scrivo perché non ho ritirato un referto che avrei dovuto ritirare entro circa 15 gennaio 2025 [ASSISTENTE] Se non hai ritirato il referto entro i 30 giorni dalla data indicata...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (160 chars):
    {"predicted_label": "info_ritiro_referto", "confidence": 0.9, "motivation": "Domanda su come ritirare un referto non ancora ritirato entro il tempo stabilito"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto
   confidence: 0.9
   motivation: Domanda su come ritirare un referto non ancora ritirato entro il tempo stabilito
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come ritirare un referto non ancora ritirato entro il tempo stabilito
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 4829a9000e4e07e73aa596ac2fe222bd classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 262
   📊 Token totali: 710
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 710 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 262
   📊 Token conversazione finale: 262
   📊 Token totali: 710
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 926 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2682 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:01.948092
====================================================================================================
📋 Session ID: classify_1756466221
⏱️  Processing Time: 0.853s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (926 chars):
   [UTENTE] Sono stata ricoverata dal 29 06 al 02 07 2025 ma la cartella clinica non è ancora disponibile . Come.posso sapere quando potrò scaricarla? [ASSISTENTE] La copia digitale della cartella cli...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (159 chars):
    {"predicted_label": "info_ritiro_referto_cartella_clinica", "confidence": 0.9, "motivation": "Domanda su come ottenere la cartella clinica dopo una ricovero"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto_cartella_clinica
   confidence: 0.9
   motivation: Domanda su come ottenere la cartella clinica dopo una ricovero
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come ottenere la cartella clinica dopo una ricovero
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 3f613cc0add0ba362c47ea52094c1408 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 191
   📊 Token totali: 619
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 619 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 191
   📊 Token conversazione finale: 191
   📊 Token totali: 619
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 641 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2728 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:02.998688
====================================================================================================
📋 Session ID: classify_1756466222
⏱️  Processing Time: 0.943s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (641 chars):
   [UTENTE] Avrei bisogno di avere referto RMN encefalo fatta tra ottobre e dicembre 2020 [ASSISTENTE] I referti relativi a esami effettuati prima del 2018 non sono consultabili online. Per ottenere i...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (151 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "Richiesta di informazioni su un esame RMN effettuato tra ottobre e dicembre 2020"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: Richiesta di informazioni su un esame RMN effettuato tra ottobre e dicembre 2020
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta di informazioni su un esame RMN effettuato tra ottobre e dicembre 2020
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 95d26de177974faef8ed04f27ac70c6d classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 218
   📊 Token totali: 646
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 646 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 218
   📊 Token conversazione finale: 218
   📊 Token totali: 646
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 739 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2741 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:03.965596
====================================================================================================
📋 Session ID: classify_1756466223
⏱️  Processing Time: 0.861s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (739 chars):
   [UTENTE] buonasera, ho un'intervento prenotato ma vorrei maggiori informazioni [ASSISTENTE] Buonasera! Potresti specificare se il tuo intervento è stato prenotato tramite il Servizio Sanitario Nazi...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (148 chars):
    {"predicted_label": "info_prenotazione", "confidence": 0.9, "motivation": "L'utente ha prenotato un intervento e richiede informazioni su di esso"}

📊 Parsed Response:
   predicted_label: info_prenotazione
   confidence: 0.9
   motivation: L'utente ha prenotato un intervento e richiede informazioni su di esso
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente ha prenotato un intervento e richiede informazioni su di esso
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 09ca9fcba0c4c70d9499687d76c00da3 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 279
   📊 Token totali: 707
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 707 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 279
   📊 Token conversazione finale: 279
   📊 Token totali: 707
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 904 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2750 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:04.940804
====================================================================================================
📋 Session ID: classify_1756466224
⏱️  Processing Time: 0.871s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (904 chars):
   [UTENTE] come si può fare la chirurgia refrattiva? [ASSISTENTE] La chirurgia refrattiva può essere effettuata con diverse tecniche, tra cui il laser a eccimeri e il laser a femtosecondi. Questi tra...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (136 chars):
    {"predicted_label": "info_chirurgia_refrattiva", "confidence": 0.9, "motivation": "Domanda su come effettuare la chirurgia refrattiva"}

📊 Parsed Response:
   predicted_label: info_chirurgia_refrattiva
   confidence: 0.9
   motivation: Domanda su come effettuare la chirurgia refrattiva
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come effettuare la chirurgia refrattiva
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 2e492a83704f46c45a8cb4640f96f349 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 275
   📊 Token totali: 723
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 723 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 275
   📊 Token conversazione finale: 275
   📊 Token totali: 723
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 881 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2836 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:05.904024
====================================================================================================
📋 Session ID: classify_1756466225
⏱️  Processing Time: 0.857s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (881 chars):
   [UTENTE] VORREI SAPERE SE IN hUMANITAS EFFETTUATE LE INFILTRAZIONI ECO/RADIOGUIDATE DELLA SACROILIACA DESTRA CON ANESTETICO E COTRTISONE [ASSISTENTE] In Humanitas, è possibile effettuare infiltrazi...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (129 chars):
    {"predicted_label": "info_terapia", "confidence": 0.9, "motivation": "Domanda su una terapia specifica effettuata in Humanitas"}

📊 Parsed Response:
   predicted_label: info_terapia
   confidence: 0.9
   motivation: Domanda su una terapia specifica effettuata in Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su una terapia specifica effettuata in Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione df983cacc0c4ea5eb6ef3f42d18b7d1f classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 195
   📊 Token totali: 623
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 623 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 195
   📊 Token conversazione finale: 195
   📊 Token totali: 623
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 678 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2724 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:06.881474
====================================================================================================
📋 Session ID: classify_1756466226
⏱️  Processing Time: 0.871s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (678 chars):
   [UTENTE] Sono assicurato con QUAS avere in previsione una convenzione diretta? [ASSISTENTE] L'Istituto Clinico Humanitas è convenzionato con molteplici enti che gestiscono polizze salute e casse mu...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (144 chars):
    {"predicted_label": "info_convenzione", "confidence": 0.9, "motivation": "Domanda su una convenzione diretta con l'Istituto Clinico Humanitas"}

📊 Parsed Response:
   predicted_label: info_convenzione
   confidence: 0.9
   motivation: Domanda su una convenzione diretta con l'Istituto Clinico Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su una convenzione diretta con l'Istituto Clinico Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 9e54685bad0596182b03d1ae095084d8 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 74
   📊 Token totali: 523
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 523 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 74
   📊 Token conversazione finale: 74
   📊 Token totali: 523
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 243 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2825 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:07.930349
====================================================================================================
📋 Session ID: classify_1756466227
⏱️  Processing Time: 0.944s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (243 chars):
   [UTENTE] Salve vorrei desideri due appuntamenti.  [ASSISTENTE] Certamente! Potresti specificare per quali visite o esami desideri prenotare gli appuntamenti? Inoltre, vuoi prenotare tramite il Serv...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (154 chars):
    {"predicted_label": "prenotazione_appuntamento", "confidence": 0.9, "motivation": "L'utente ha chiesto di prenotare due appuntamenti per visite o esami"}

📊 Parsed Response:
   predicted_label: prenotazione_appuntamento
   confidence: 0.9
   motivation: L'utente ha chiesto di prenotare due appuntamenti per visite o esami
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente ha chiesto di prenotare due appuntamenti per visite o esami
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione eb2ca36ca2f1c8b5fe13faf74d5e3692 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 262
   📊 Token totali: 690
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 690 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 262
   📊 Token conversazione finale: 262
   📊 Token totali: 690
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 886 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2743 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:09.091472
====================================================================================================
📋 Session ID: classify_1756466229
⏱️  Processing Time: 1.052s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (886 chars):
   [UTENTE] Avrei bisogno di una cartella clinica  [ASSISTENTE] Puoi richiedere la cartella clinica dei ricoveri svolti presso l'Istituto Clinico Humanitas in diversi modi:

1. **Copia digitale**: Puo...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (184 chars):
    {"predicted_label": "info_ritiro_referto_cartella_clinica", "confidence": 0.9, "motivation": "L'utente richiede una cartella clinica dei ricoveri presso l'Istituto Clinico Humanitas"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto_cartella_clinica
   confidence: 0.9
   motivation: L'utente richiede una cartella clinica dei ricoveri presso l'Istituto Clinico Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente richiede una cartella clinica dei ricoveri presso l'Istituto Clinico Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 3aa520569eed0b5cfa800280fc129da4 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 841
   📊 Token totali: 1289
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 1289 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 841
   📊 Token conversazione finale: 841
   📊 Token totali: 1289
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 2744 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2857 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:10.318482
====================================================================================================
📋 Session ID: classify_1756466230
⏱️  Processing Time: 1.121s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (2744 chars):
   [UTENTE] Buon pomeriggio [ASSISTENTE] Buon pomeriggio! Come posso esserti utile? [UTENTE] Vorrei sapere come poter richiedere la cartella clinica di mio padre inerente al suo ricovero al centro di ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (209 chars):
    {"predicted_label": "info_ritiro_referto_cartella_clinica", "confidence": 0.9, "motivation": "Domanda su come richiedere la cartella clinica di un paziente inerente a un ricovero al centro di riabilitazione"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto_cartella_clinica
   confidence: 0.9
   motivation: Domanda su come richiedere la cartella clinica di un paziente inerente a un ricovero al centro di riabilitazione
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come richiedere la cartella clinica di un paziente inerente a un ricovero al centro di riabilitazione
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🔧 Creazione MongoClassificationReader per cliente: humanitas
🤖 LLM DIRECT CLASSIFICATION: Sessione e4c0a8f3dc98cc31ec36ce8060dff391 classificata tramite LLM diretto (classificazione=unknown)
✅ MongoClassificationReader humanitas creato con collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
✅ Connesso a MongoDB database: classificazioni
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 453
   📊 Token totali: 901
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 901 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 453
   📊 Token conversazione finale: 453
   📊 Token totali: 901
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1507 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2579 chars (debug_prompt=False)
🔍 Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:11.172965
====================================================================================================
📋 Session ID: classify_1756466231
⏱️  Processing Time: 0.743s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1507 chars):
   [UTENTE] Buon giorno Giulia. [ASSISTENTE] Buongiorno! Come posso esserti utile oggi? 😊 [UTENTE] Buon giorno vorrei ricevere a casa x via posta la cartella clinica del mio. Intervento eseguito il 19...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (120 chars):
    {"predicted_label": "saluto", "confidence": 0.9, "motivation": "Domanda di saluto non riferita a un intento specifico"}

📊 Parsed Response:
   predicted_label: saluto
   confidence: 0.9
   motivation: Domanda di saluto non riferita a un intento specifico
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda di saluto non riferita a un intento specifico
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 971037ef14ecfaff479c543d83b3a592 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 152
   📊 Token totali: 580
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 580 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 152
   📊 Token conversazione finale: 152
   📊 Token totali: 580
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 526 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2748 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:12.428781
====================================================================================================
📋 Session ID: classify_1756466232
⏱️  Processing Time: 1.151s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (526 chars):
   [UTENTE] Buongiorno, ho erroneamente annullato una richiesta di cartella clinica, quanto tempo passa per effettuare nuova richiesta? [ASSISTENTE] Puoi effettuare una nuova richiesta di cartella cli...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (232 chars):
    {"predicted_label": "info_ritiro_referto_cartella_clinica", "confidence": 0.9, "motivation": "L'utente ha richiesto informazioni su come effettuare una nuova richiesta di cartella clinica dopo averne annullato una precedentemente"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto_cartella_clinica
   confidence: 0.9
   motivation: L'utente ha richiesto informazioni su come effettuare una nuova richiesta di cartella clinica dopo averne annullato una precedentemente
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente ha richiesto informazioni su come effettuare una nuova richiesta di cartella clinica dopo averne annullato una precedentemente
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 0395ae4ff369e2db62fdf96eeb8af1b2 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 375
   📊 Token totali: 824
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 824 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 375
   📊 Token conversazione finale: 375
   📊 Token totali: 824
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1296 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2810 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:13.406471
====================================================================================================
📋 Session ID: classify_1756466233
⏱️  Processing Time: 0.873s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1296 chars):
   [UTENTE] Come ritirare il referto di mia figlia minorenne? [ASSISTENTE] Per ritirare il referto di tua figlia minorenne, è necessario seguire queste indicazioni:

1. **Ritiro da parte del genitore ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [78 more lines] ...
     Line 82: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (139 chars):
    {"predicted_label": "info_ritiro_referto", "confidence": 0.9, "motivation": "Domanda su come ritirare il referto di una figlia minorenne"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto
   confidence: 0.9
   motivation: Domanda su come ritirare il referto di una figlia minorenne
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come ritirare il referto di una figlia minorenne
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 77d183bd3ba6e3f3380e2384c48e28a4 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 202
   📊 Token totali: 630
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 630 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 202
   📊 Token conversazione finale: 202
   📊 Token totali: 630
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 721 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2732 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:14.267734
====================================================================================================
📋 Session ID: classify_1756466234
⏱️  Processing Time: 0.755s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (721 chars):
   [UTENTE] Non riesco a registrarmi con il codice fiscale  [ASSISTENTE] Se non riesci a registrarti utilizzando il codice fiscale, ti consiglio di verificare che i dati inseriti siano corretti. Assic...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (130 chars):
    {"predicted_label": "problema_accesso_portale", "confidence": 0.8, "motivation": "Problema tecnico di accesso al portale online"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Problema tecnico di accesso al portale online
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Problema tecnico di accesso al portale online
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 2fd0e4ae095b98ab42d617aa78f6b8fc classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 452
   💬 Token conversazione: 190
   📊 Token totali: 642
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 642 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 452
   📊 Token conversazione originale: 190
   📊 Token conversazione finale: 190
   📊 Token totali: 642
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 692 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2897 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:15.337995
====================================================================================================
📋 Session ID: classify_1756466235
⏱️  Processing Time: 0.963s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (692 chars):
   [UTENTE] Buongiorno, sto cercando di prenotare un RX gastrointestinale superiore per mio figlio, ma dopo aver selezionato la data al momento di confermare la prenotazione il sistema va in errore [A...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (159 chars):
    {"predicted_label": "prenotazione_RX", "confidence": 0.9, "motivation": "Richiesta di prenotare un RX gastrointestinale superiore per il figlio del paziente"}

📊 Parsed Response:
   predicted_label: prenotazione_rx
   confidence: 0.9
   motivation: Richiesta di prenotare un RX gastrointestinale superiore per il figlio del paziente
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta di prenotare un RX gastrointestinale superiore per il figlio del paziente
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 4a2c96f66be7d5db6d5babf072483150 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 226
   📊 Token totali: 654
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 654 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 226
   📊 Token conversazione finale: 226
   📊 Token totali: 654
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 784 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2563 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:16.165049
====================================================================================================
📋 Session ID: classify_1756466236
⏱️  Processing Time: 0.721s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (784 chars):
   [UTENTE] Buongiorno. In fase di registrazione, è stato abbinato automaticamente il mio codice fiscale PRTMTN97H60F205S alla mail sbagliata e quindi non riesco a procedere con l'iscrizione. La mail ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (96 chars):
    {"predicted_label": "aiuto", "confidence": 0.9, "motivation": "L'utente ha chiesto assistenza"}

📊 Parsed Response:
   predicted_label: aiuto
   confidence: 0.9
   motivation: L'utente ha chiesto assistenza
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente ha chiesto assistenza
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 2297a1e9265fb3e617fab3bc3dc4db05 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 194
   📊 Token totali: 622
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 622 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 194
   📊 Token conversazione finale: 194
   📊 Token totali: 622
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 692 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2772 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:16.843214
====================================================================================================
📋 Session ID: classify_1756466236
⏱️  Processing Time: 0.574s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (692 chars):
   [UTENTE] Ciao Giulia, avrei bisogno di un contatto per poter chiedere delucidazioni su un codice di un’impegnativa relativa a uno spermiogramma [ASSISTENTE] Per problematiche relative a codici o ID...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (111 chars):
    {"predicted_label": "info_esame", "confidence": 0.8, "motivation": "Domanda su un codice di un esame clinico"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda su un codice di un esame clinico
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda su un codice di un esame clinico
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 54ec7b4e58a6c3e0e7cb6bc7de1616eb classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 180
   📊 Token totali: 608
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 608 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 180
   📊 Token conversazione finale: 180
   📊 Token totali: 608
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 654 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2764 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:17.867166
====================================================================================================
📋 Session ID: classify_1756466237
⏱️  Processing Time: 0.918s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (654 chars):
   [UTENTE] Ho più di 100 anni: come posso registrarmi per il ritiro dei referti? il sistema mi blocca perchè dice che sono minorenne, guardando il mio codice fiscale  [ASSISTENTE] Per risolvere il pr...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (170 chars):
    {"predicted_label": "problema_accesso_portale", "confidence": 0.9, "motivation": "Domanda su come risolvere un problema di accesso al portale per il ritiro dei referti"}

📊 Parsed Response:
   predicted_label: problema_accesso_portale
   confidence: 0.9
   motivation: Domanda su come risolvere un problema di accesso al portale per il ritiro dei referti
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come risolvere un problema di accesso al portale per il ritiro dei referti
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione ee4a3f963fa70a91b0d5e980f39477f1 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 255
   📊 Token totali: 703
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 703 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 255
   📊 Token conversazione finale: 255
   📊 Token totali: 703
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 805 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2855 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:18.922536
====================================================================================================
📋 Session ID: classify_1756466238
⏱️  Processing Time: 0.949s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (805 chars):
   [UTENTE] salve vorrei sapere come fare per un ricovero in solvenza [ASSISTENTE] Per prenotare un ricovero in regime privato (solvenza) presso Humanitas, puoi contattare l'Ufficio Ricoveri Privati c...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (157 chars):
    {"predicted_label": "info_ricovero", "confidence": 0.9, "motivation": "Domanda su come prenotare un ricovero in regime privato (solvenza) presso Humanitas"}

📊 Parsed Response:
   predicted_label: info_ricovero
   confidence: 0.9
   motivation: Domanda su come prenotare un ricovero in regime privato (solvenza) presso Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come prenotare un ricovero in regime privato (solvenza) presso Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 07d8e38a9405dcd6e27aa01e114ebac3 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 155
   📊 Token totali: 604
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 604 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 155
   📊 Token conversazione finale: 155
   📊 Token totali: 604
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 493 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2733 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:19.934462
====================================================================================================
📋 Session ID: classify_1756466239
⏱️  Processing Time: 0.906s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (493 chars):
   [UTENTE] mi potresti dare il numero di telefono della chirurgia della mano per una visita [ASSISTENTE] Puoi prenotare una visita per la chirurgia della mano chiamando il numero 02.82242358, attivo ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (147 chars):
    {"predicted_label": "prenotazione_chirurgia", "confidence": 0.9, "motivation": "Domanda su come prenotare una visita per la chirurgia della mano"}

📊 Parsed Response:
   predicted_label: prenotazione_chirurgia
   confidence: 0.9
   motivation: Domanda su come prenotare una visita per la chirurgia della mano
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come prenotare una visita per la chirurgia della mano
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 3c460cff69da2e9baf16437b346752cf classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 130
   📊 Token totali: 558
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 558 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 130
   📊 Token conversazione finale: 130
   📊 Token totali: 558
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 393 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2732 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:20.885201
====================================================================================================
📋 Session ID: classify_1756466240
⏱️  Processing Time: 0.846s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (393 chars):
   [UTENTE] Buongiorno vorrei modificare un appuntamento telefonicamente [ASSISTENTE] Per modificare un appuntamento telefonicamente presso l'Istituto Clinico Humanitas, puoi contattare il numero 02 8...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (131 chars):
    {"predicted_label": "modifica_appuntamento", "confidence": 0.9, "motivation": "L'utente ha chiesto di modificare un appuntamento"}

📊 Parsed Response:
   predicted_label: modifica_appuntamento
   confidence: 0.9
   motivation: L'utente ha chiesto di modificare un appuntamento
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente ha chiesto di modificare un appuntamento
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 625b172465feb159c22f8c25b2cf40c1 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 179
   📊 Token totali: 607
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 607 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 179
   📊 Token conversazione finale: 179
   📊 Token totali: 607
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 549 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2618 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:21.801358
====================================================================================================
📋 Session ID: classify_1756466241
⏱️  Processing Time: 0.812s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (549 chars):
   [UTENTE] Buongiorno sono Samuele Mulargia e son in vostro paziente. Ho fatto un intervento in regime privato e mi servirebbe la fattura della spesa affrontata  [ASSISTENTE] Per ottenere la fattura ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (139 chars):
    {"predicted_label": "info_paziente", "confidence": 0.9, "motivation": "Utente si identifica come paziente e offre di aiutare l'operatore"}

📊 Parsed Response:
   predicted_label: info_paziente
   confidence: 0.9
   motivation: Utente si identifica come paziente e offre di aiutare l'operatore
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Utente si identifica come paziente e offre di aiutare l'operatore
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 15fdbb98b2b553b465f945431b21a05d classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 159
   📊 Token totali: 587
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 587 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 159
   📊 Token conversazione finale: 159
   📊 Token totali: 587
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 574 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2698 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:22.635645
====================================================================================================
📋 Session ID: classify_1756466242
⏱️  Processing Time: 0.730s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (574 chars):
   [UTENTE] Non mi arriva la mail per reimpostare la password  [ASSISTENTE] Se non ricevi la mail per reimpostare la password su [Humanitas con te](https://www.humanitasconte.it), ti consiglio di cont...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (145 chars):
    {"predicted_label": "problema_accesso_portale", "confidence": 0.8, "motivation": "Domanda su come ricevere la mail per reimpostare la password"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda su come ricevere la mail per reimpostare la password
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda su come ricevere la mail per reimpostare la password
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione b314a796098d5a4c4e07985c1a749f8d classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 205
   📊 Token totali: 633
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 633 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 205
   📊 Token conversazione finale: 205
   📊 Token totali: 633
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 728 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2541 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:23.529101
====================================================================================================
📋 Session ID: classify_1756466243
⏱️  Processing Time: 0.789s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (728 chars):
   [UTENTE] Non riesco a scaricare il referto . Ho anche  cambiato browser. Ma non si carica mai. Ho segnalato all'assistenza il problema ma nessuno mi ha contattato.  È dal 17 che sto provando sia su...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (128 chars):
    {"predicted_label": "problema_scarico_referto", "confidence": 0.9, "motivation": "L'utente ha problemi a scaricare il referto"}

📊 Parsed Response:
   predicted_label: problema_scarico_referto
   confidence: 0.9
   motivation: L'utente ha problemi a scaricare il referto
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente ha problemi a scaricare il referto
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione e0824d33448be844497f19096468a9e5 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 454
   💬 Token conversazione: 289
   📊 Token totali: 743
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 743 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 454
   📊 Token conversazione originale: 289
   📊 Token conversazione finale: 289
   📊 Token totali: 743
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 889 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2709 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:24.576512
====================================================================================================
📋 Session ID: classify_1756466244
⏱️  Processing Time: 0.943s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (889 chars):
   [UTENTE] NON RIESCO AD ACCEDERE PER VEDERE I MIEI REFERTI ONLINE. INSERENDO IL MIO CODICE FISCALE (FRGVTR59A22F205U) MI DICE CHE SONO GIA' REGISTRATO MA NON RIESCO A RECUPERARE LA PASSWORD. UN PAIO...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (161 chars):
    {"predicted_label": "problema_accesso_portale", "confidence": 0.9, "motivation": "Problema tecnico di accesso al portale online è chiarissimo e inequivocabile"}

📊 Parsed Response:
   predicted_label: problema_accesso_portale
   confidence: 0.9
   motivation: Problema tecnico di accesso al portale online è chiarissimo e inequivocabile
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Problema tecnico di accesso al portale online è chiarissimo e inequivocabile
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 9dad9db3ff581fcd8938a9d8412a4412 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 228
   📊 Token totali: 677
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 677 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 228
   📊 Token conversazione finale: 228
   📊 Token totali: 677
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 831 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2876 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:25.576634
====================================================================================================
📋 Session ID: classify_1756466245
⏱️  Processing Time: 0.896s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (831 chars):
   [UTENTE] salve, io risulto già registrato presso il vostro portale, ma non ricordo la email con la quale mi ero registrato anni fa e che ora non ho più, quindi per scaricare i nuovi esami che ho fa...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (135 chars):
    {"predicted_label": "cambio_anagrafica", "confidence": 0.9, "motivation": "Domanda su come cambiare l'email nella propria anagrafica"}

📊 Parsed Response:
   predicted_label: cambio_anagrafica
   confidence: 0.9
   motivation: Domanda su come cambiare l'email nella propria anagrafica
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come cambiare l'email nella propria anagrafica
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione bdc17cfeb478e19f0a055ebbf14313ec classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 236
   📊 Token totali: 664
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 664 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 236
   📊 Token conversazione finale: 236
   📊 Token totali: 664
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 786 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2655 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:26.618791
====================================================================================================
📋 Session ID: classify_1756466246
⏱️  Processing Time: 0.937s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (786 chars):
   [UTENTE] Buon giorno Giulia,
non riesco a registrarmi in quanto è stato inserito il mio numero di telefono errato. Quello corretto è : + 39 344 122 1902 
codice fiscale NNNSRA99C44M052U 
IANNONE SA...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (189 chars):
    {"predicted_label": "problema_accesso_portale", "confidence": 0.8, "motivation": "Domanda su un problema di accesso al portale online dovuto all'inserimento errato del numero di telefono"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda su un problema di accesso al portale online dovuto all'inserimento errato del numero di telefono
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda su un problema di accesso al portale online dovuto all'inserimento errato del numero di telefono
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione a2e7512836de94a985b02b662d1ddad0 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 149
   📊 Token totali: 598
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 598 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 149
   📊 Token conversazione finale: 149
   📊 Token totali: 598
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 539 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2866 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:27.539605
====================================================================================================
📋 Session ID: classify_1756466247
⏱️  Processing Time: 0.816s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (539 chars):
   [UTENTE] Chi devo contattare perché non mi fa ad accedere ai referti  [ASSISTENTE] Se hai problemi ad accedere ai referti, ti consiglio di contattare il servizio di assistenza dedicata compilando i...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (150 chars):
    {"predicted_label": "info_contatti", "confidence": 0.8, "motivation": "Domanda sui contatti per risolvere un problema tecnico di accesso ai referti"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda sui contatti per risolvere un problema tecnico di accesso ai referti
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda sui contatti per risolvere un problema tecnico di accesso ai referti
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 5f6998ca8eb489d90cc1cb35e471fa57 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 348
   📊 Token totali: 796
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 796 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 348
   📊 Token conversazione finale: 348
   📊 Token totali: 796
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1176 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2845 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:28.465155
====================================================================================================
📋 Session ID: classify_1756466248
⏱️  Processing Time: 0.820s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1176 chars):
   [UTENTE] indirizzo email  [ASSISTENTE] Potresti specificare per quale reparto, servizio o area desideri l'indirizzo email? Così posso aiutarti meglio! [UTENTE] servizio clienti [ASSISTENTE] Per con...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (125 chars):
    {"predicted_label": "info_contatti", "confidence": 0.9, "motivation": "Domanda sui contatti del servizio clienti richiesto"}

📊 Parsed Response:
   predicted_label: info_contatti
   confidence: 0.9
   motivation: Domanda sui contatti del servizio clienti richiesto
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda sui contatti del servizio clienti richiesto
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione d9febae1c66d2ea2975ad27c9f3bfd2d classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 162
   📊 Token totali: 590
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 590 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 162
   📊 Token conversazione finale: 162
   📊 Token totali: 590
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 581 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2787 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:29.397677
====================================================================================================
📋 Session ID: classify_1756466249
⏱️  Processing Time: 0.828s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (581 chars):
   [UTENTE] ho prenotato una televisita per mercoledi 30 luglio, ma non ho ancora ricevuto indicazioni di come effettuarla [ASSISTENTE] Per ricevere indicazioni su come effettuare la televisita, ti co...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (127 chars):
    {"predicted_label": "info_televisita", "confidence": 0.9, "motivation": "Domanda su come effettuare una televisita prenotata"}

📊 Parsed Response:
   predicted_label: info_televisita
   confidence: 0.9
   motivation: Domanda su come effettuare una televisita prenotata
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come effettuare una televisita prenotata
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione d23dce8730320e6298c9f922d40b6a91 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 269
   📊 Token totali: 697
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 697 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 269
   📊 Token conversazione finale: 269
   📊 Token totali: 697
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 964 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2724 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:30.406226
====================================================================================================
📋 Session ID: classify_1756466250
⏱️  Processing Time: 0.904s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (964 chars):
   [UTENTE] Mi serve il numero verde di Humanitas [ASSISTENTE] Il numero verde di Humanitas per prenotazioni tramite il Servizio Sanitario Nazionale (SSN) è 800 638 638 (da rete fissa). Se chiami da r...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (179 chars):
    {"predicted_label": "info_prenotazione", "confidence": 0.9, "motivation": "Richiesta di informazioni sulla prenotazione tramite il numero verde del Servizio Sanitario Nazionale"}

📊 Parsed Response:
   predicted_label: info_prenotazione
   confidence: 0.9
   motivation: Richiesta di informazioni sulla prenotazione tramite il numero verde del Servizio Sanitario Nazionale
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta di informazioni sulla prenotazione tramite il numero verde del Servizio Sanitario Nazionale
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 860ec579669227a3ffbe3b92c98c16a2 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 207
   📊 Token totali: 656
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 656 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 207
   📊 Token conversazione finale: 207
   📊 Token totali: 656
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 645 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2823 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:31.393832
====================================================================================================
📋 Session ID: classify_1756466251
⏱️  Processing Time: 0.883s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (645 chars):
   [UTENTE] come posso prenotare visita con assicurazione? [ASSISTENTE] Per prenotare una visita con assicurazione presso l'Istituto Clinico Humanitas, puoi utilizzare i seguenti canali di prenotazion...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (141 chars):
    {"predicted_label": "prenotazione_assicurazione", "confidence": 0.9, "motivation": "Domanda su come prenotare una visita con assicurazione"}

📊 Parsed Response:
   predicted_label: prenotazione_assicurazione
   confidence: 0.9
   motivation: Domanda su come prenotare una visita con assicurazione
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come prenotare una visita con assicurazione
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 6c33251780abfc3eecf1461d406c6c01 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 303
   📊 Token totali: 752
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 752 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 303
   📊 Token conversazione finale: 303
   📊 Token totali: 752
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 997 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2703 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:32.243586
====================================================================================================
📋 Session ID: classify_1756466252
⏱️  Processing Time: 0.746s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (997 chars):
   [UTENTE] PARCH TEST [ASSISTENTE] Il Patch Test è un esame allergologico utilizzato per diagnosticare dermatiti da contatto. Si applicano cerotti contenenti allergeni sulla schiena del paziente per ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (115 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "Richiesta di informazioni su un esame medico"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: Richiesta di informazioni su un esame medico
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta di informazioni su un esame medico
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione c6800ef736789cf78ea6ab861d6dfa59 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 159
   📊 Token totali: 607
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 607 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 159
   📊 Token conversazione finale: 159
   📊 Token totali: 607
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 548 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2843 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:33.312507
====================================================================================================
📋 Session ID: classify_1756466253
⏱️  Processing Time: 0.965s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (548 chars):
   [UTENTE] Buongiorno dovrei prenotare una ecografia alla spalla sx alla Cellini di Torino  [ASSISTENTE] Per prenotare un'ecografia alla spalla sinistra presso Humanitas Cellini di Torino, puoi conta...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (172 chars):
    {"predicted_label": "info_prenotazione", "confidence": 0.9, "motivation": "Domanda su come prenotare un'ecografia alla spalla sinistra presso Humanitas Cellini di Torino"}

📊 Parsed Response:
   predicted_label: info_prenotazione
   confidence: 0.9
   motivation: Domanda su come prenotare un'ecografia alla spalla sinistra presso Humanitas Cellini di Torino
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come prenotare un'ecografia alla spalla sinistra presso Humanitas Cellini di Torino
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 64eded28c97e0d7d9fe27ecef113c9fb classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 202
   📊 Token totali: 651
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 651 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 202
   📊 Token conversazione finale: 202
   📊 Token totali: 651
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 630 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2761 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:34.363101
====================================================================================================
📋 Session ID: classify_1756466254
⏱️  Processing Time: 0.946s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (630 chars):
   [UTENTE] Ciao Giulia, ho necessità di prenotare in regime privato una Colangio rm con mezzo di contrasto nei vostri centri di Bergamo o Milano o Monza. [ASSISTENTE] Per prenotare una Colangio RM co...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (162 chars):
    {"predicted_label": "prenotazione_esame", "confidence": 0.9, "motivation": "L'utente ha espresso la necessità di prenotare un esame specifico in regime privato"}

📊 Parsed Response:
   predicted_label: prenotazione_esame
   confidence: 0.9
   motivation: L'utente ha espresso la necessità di prenotare un esame specifico in regime privato
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente ha espresso la necessità di prenotare un esame specifico in regime privato
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 4becc56acac69067e57a2f6fa88c21e2 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 487
   📊 Token totali: 935
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 935 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 487
   📊 Token conversazione finale: 487
   📊 Token totali: 935
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1512 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2836 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:35.569815
====================================================================================================
📋 Session ID: classify_1756466255
⏱️  Processing Time: 1.102s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1512 chars):
   [UTENTE] Ho bisogno di prenotare una visita con il sistema sanitario regolare  [ASSISTENTE] Per prenotare una visita o un esame tramite il Servizio Sanitario Nazionale (SSN) presso Humanitas, puoi ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [78 more lines] ...
     Line 82: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (204 chars):
    {"predicted_label": "prenotazione", "confidence": 0.9, "motivation": "L'utente ha espresso il desiderio di prenotare una visita o un esame tramite il Servizio Sanitario Nazionale (SSN) presso Humanitas"}

📊 Parsed Response:
   predicted_label: prenotazione
   confidence: 0.9
   motivation: L'utente ha espresso il desiderio di prenotare una visita o un esame tramite il Servizio Sanitario Nazionale (SSN) presso Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente ha espresso il desiderio di prenotare una visita o un esame tramite il Servizio Sanitario Nazionale (SSN) presso Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 65c084e8b4e262713ee4085a530f25d9 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 147
   📊 Token totali: 596
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 596 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 147
   📊 Token conversazione finale: 147
   📊 Token totali: 596
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 499 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2831 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:36.840533
====================================================================================================
📋 Session ID: classify_1756466256
⏱️  Processing Time: 1.167s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (499 chars):
   [UTENTE] Possibile prenotare RX rachide dorsale morfodinamica via murat tramite ssn? [ASSISTENTE] Per prenotare un RX rachide dorsale morfodinamica presso la sede di Via Murat tramite il Servizio S...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (211 chars):
    {"predicted_label": "prenotazione_RX", "confidence": 0.9, "motivation": "Domanda su come prenotare un RX rachide dorsale morfodinamica presso la sede di Via Murat tramite il Servizio Sanitario Nazionale (SSN)"}

📊 Parsed Response:
   predicted_label: prenotazione_rx
   confidence: 0.9
   motivation: Domanda su come prenotare un RX rachide dorsale morfodinamica presso la sede di Via Murat tramite il Servizio Sanitario Nazionale (SSN)
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come prenotare un RX rachide dorsale morfodinamica presso la sede di Via Murat tramite il Servizio Sanitario Nazionale (SSN)
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione dffdfb30b5b25aeaa1a97d767c5fa296 classificata tramite LLM diretto (classificazione=unknown)
   📈 Progresso LLM: 100/166
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 177
   📊 Token totali: 626
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 626 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 177
   📊 Token conversazione finale: 177
   📊 Token totali: 626
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 600 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2774 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:37.702027
====================================================================================================
📋 Session ID: classify_1756466257
⏱️  Processing Time: 0.757s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (600 chars):
   [UTENTE] Posso fare una visita endocrinologica con il sistema sanitario nazionale? [ASSISTENTE] Sì, è possibile effettuare una visita endocrinologica tramite il Servizio Sanitario Nazionale (SSN) p...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (116 chars):
    {"predicted_label": "info_visita", "confidence": 0.9, "motivation": "Domanda su come effettuare una visita medica"}

📊 Parsed Response:
   predicted_label: info_visita
   confidence: 0.9
   motivation: Domanda su come effettuare una visita medica
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come effettuare una visita medica
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 14e443a5f48aa5f5597e959642958639 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 299
   📊 Token totali: 747
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 747 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 299
   📊 Token conversazione finale: 299
   📊 Token totali: 747
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 915 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2849 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:38.947437
====================================================================================================
📋 Session ID: classify_1756466258
⏱️  Processing Time: 1.142s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (915 chars):
   [UTENTE] Buongiorno, [ASSISTENTE] Buongiorno! Come posso esserti utile oggi? [UTENTE] Dovendo eseguire 10 sedute di rieducazione motoria alluce piede dx in SSN a fronte di intervento eseguito c/o H...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (210 chars):
    {"predicted_label": "info_rieducazione_motoria", "confidence": 0.9, "motivation": "Domanda su possibilità di eseguire 10 sedute di rieducazione motoria alluce piede dx al centro ospedaliero Humanitas Rozzano"}

📊 Parsed Response:
   predicted_label: info_rieducazione_motoria
   confidence: 0.9
   motivation: Domanda su possibilità di eseguire 10 sedute di rieducazione motoria alluce piede dx al centro ospedaliero Humanitas Rozzano
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su possibilità di eseguire 10 sedute di rieducazione motoria alluce piede dx al centro ospedaliero Humanitas Rozzano
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 40c6d5011caf092527fc288d8de50b78 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 388
   📊 Token totali: 837
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 837 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 388
   📊 Token conversazione finale: 388
   📊 Token totali: 837
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1206 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2756 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:39.955509
====================================================================================================
📋 Session ID: classify_1756466259
⏱️  Processing Time: 0.904s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1206 chars):
   [UTENTE] Visita strabologica [ASSISTENTE] La visita strabologica è parte delle procedure oculistiche e può includere una valutazione della funzionalità visiva e della motilità oculare. Per maggiori...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (152 chars):
    {"predicted_label": "info_prenotazione", "confidence": 0.9, "motivation": "L'utente chiede informazioni sulla prenotazione di una visita strabologica"}

📊 Parsed Response:
   predicted_label: info_prenotazione
   confidence: 0.9
   motivation: L'utente chiede informazioni sulla prenotazione di una visita strabologica
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni sulla prenotazione di una visita strabologica
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione f6fbbaad5a312f4e5f5325467d6d0841 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 454
   💬 Token conversazione: 562
   📊 Token totali: 1016
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 1016 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 454
   📊 Token conversazione originale: 562
   📊 Token conversazione finale: 562
   📊 Token totali: 1016
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1965 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2866 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:40.911272
====================================================================================================
📋 Session ID: classify_1756466260
⏱️  Processing Time: 0.851s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1965 chars):
   [UTENTE] Non riesco a fare lòa registrazione [ASSISTENTE] Per aiutarti con la registrazione, potresti specificare se stai cercando di registrarti a [Humanitas con te](https://www.humanitasconte.it)...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (132 chars):
    {"predicted_label": "registrazione_humanitas", "confidence": 0.9, "motivation": "Domanda riguardante la registrazione a Humanitas"}

📊 Parsed Response:
   predicted_label: registrazione_humanitas
   confidence: 0.9
   motivation: Domanda riguardante la registrazione a Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda riguardante la registrazione a Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 41d2c1108c1dc4ec8b79a92c1e261246 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 118
   📊 Token totali: 546
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 546 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 118
   📊 Token conversazione finale: 118
   📊 Token totali: 546
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 412 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2662 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:42.060975
====================================================================================================
📋 Session ID: classify_1756466262
⏱️  Processing Time: 1.044s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (412 chars):
   [UTENTE] Come calcellarsi dal sito [ASSISTENTE] Per cancellarsi dal sito Humanitas, è necessario esercitare il diritto di revoca del consenso al trattamento dei dati personali. Puoi farlo compiland...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (196 chars):
    {"predicted_label": "info_revoca_consenso", "confidence": 0.9, "motivation": "L'utente chiede informazioni su come esercitare il diritto di revoca del consenso al trattamento dei dati personali"}

📊 Parsed Response:
   predicted_label: info_revoca_consenso
   confidence: 0.9
   motivation: L'utente chiede informazioni su come esercitare il diritto di revoca del consenso al trattamento dei dati personali
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni su come esercitare il diritto di revoca del consenso al trattamento dei dati personali
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 9e84f316cbc611ae34a033a395658ba7 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 454
   💬 Token conversazione: 384
   📊 Token totali: 838
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 838 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 454
   📊 Token conversazione originale: 384
   📊 Token conversazione finale: 384
   📊 Token totali: 838
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1305 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2809 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:42.947447
====================================================================================================
📋 Session ID: classify_1756466262
⏱️  Processing Time: 0.782s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1305 chars):
   [UTENTE] Non riesco a impostare la ricezione di notifiche sull’area referti  [ASSISTENTE] Per impostare la ricezione di notifiche sull’area referti di [Humanitas con te](https://www.humanitasconte....

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (139 chars):
    {"predicted_label": "impostazione_notifiche", "confidence": 0.8, "motivation": "Domanda su come impostare le notifiche sull'area referti"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda su come impostare le notifiche sull'area referti
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda su come impostare le notifiche sull'area referti
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 92ca00fd7292bdc037db846b706c8b7f classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 174
   📊 Token totali: 623
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 623 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 174
   📊 Token conversazione finale: 174
   📊 Token totali: 623
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 607 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2682 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:43.898094
====================================================================================================
📋 Session ID: classify_1756466263
⏱️  Processing Time: 0.845s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (607 chars):
   [UTENTE] Devo registrarmi oer la prima volta [ASSISTENTE] Per registrarti per la prima volta su [Humanitas con te](https://www.humanitasconte.it), puoi seguire questi passaggi:

1. Accedi al sito [...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (149 chars):
    {"predicted_label": "registrazione_portale", "confidence": 0.9, "motivation": "Domanda su come registrarsi al portale Humanitas per la prima volta"}

📊 Parsed Response:
   predicted_label: registrazione_portale
   confidence: 0.9
   motivation: Domanda su come registrarsi al portale Humanitas per la prima volta
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come registrarsi al portale Humanitas per la prima volta
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 9a429544a663e9b7b242d510cce0d42b classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 447
   💬 Token conversazione: 2132
   📊 Token totali: 2579
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 2579 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 447
   📊 Token conversazione originale: 2132
   📊 Token conversazione finale: 2132
   📊 Token totali: 2579
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 7225 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2806 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:44.958836
====================================================================================================
📋 Session ID: classify_1756466264
⏱️  Processing Time: 0.955s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (7225 chars):
   [UTENTE] è giusto prenotare come prima visita dermatologica la visita specialistica dermatologica [ASSISTENTE] Sì, è corretto prenotare una visita specialistica dermatologica come prima visita derm...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (171 chars):
    {"predicted_label": "prenotazione_specialistica", "confidence": 0.9, "motivation": "La richiesta è di prenotare una visita specialistica dermatologica come prima visita"}

📊 Parsed Response:
   predicted_label: prenotazione_specialistica
   confidence: 0.9
   motivation: La richiesta è di prenotare una visita specialistica dermatologica come prima visita
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   La richiesta è di prenotare una visita specialistica dermatologica come prima visita
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 84df953d8033cf4b00d8a60e20d2a5b2 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 147
   📊 Token totali: 575
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 575 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 147
   📊 Token conversazione finale: 147
   📊 Token totali: 575
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 501 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2661 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:46.100998
====================================================================================================
📋 Session ID: classify_1756466266
⏱️  Processing Time: 1.037s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (501 chars):
   [UTENTE] Che tipo di preparazione per visita proctologica [ASSISTENTE] Per la visita proctologica non è richiesta alcuna preparazione specifica. È consigliabile portare con sé eventuali esami effet...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (208 chars):
    {"predicted_label": "info_preparazione_visita", "confidence": 0.9, "motivation": "L'utente chiede informazioni sulla preparazione per una visita proctologica e non è richiesta alcuna specifica preparazione"}

📊 Parsed Response:
   predicted_label: info_preparazione_visita
   confidence: 0.9
   motivation: L'utente chiede informazioni sulla preparazione per una visita proctologica e non è richiesta alcuna specifica preparazione
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni sulla preparazione per una visita proctologica e non è richiesta alcuna specifica preparazione
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 99f47c0266917ed542846a39de17c1fc classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 164
   📊 Token totali: 612
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 612 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 164
   📊 Token conversazione finale: 164
   📊 Token totali: 612
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 593 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2853 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:47.431437
====================================================================================================
📋 Session ID: classify_1756466267
⏱️  Processing Time: 1.226s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (593 chars):
   [UTENTE] Cosa si intende per impegnativa per il ricovero documentazione clinica riguardante patologie cardiache [ASSISTENTE] L'impegnativa per il ricovero è un documento rilasciato dal medico curan...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (248 chars):
    {"predicted_label": "info_ricovero", "confidence": 0.9, "motivation": "L'utente chiede informazioni su un documento rilasciato dal medico curante o da uno specialista che attesta la necessità di un ricovero ospedaliero per il trattamento o la..."}

📊 Parsed Response:
   predicted_label: info_ricovero
   confidence: 0.9
   motivation: L'utente chiede informazioni su un documento rilasciato dal medico curante o da uno specialista che attesta la necessità di un ricovero ospedaliero per il trattamento o la...
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni su un documento rilasciato dal medico curante o da uno specialista che attesta la necessità di un ricovero ospedaliero per il trattamento o la...
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione f7b8653ff5e30ae6b6f3d790f2d8a81c classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 103
   📊 Token totali: 552
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 552 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 103
   📊 Token conversazione finale: 103
   📊 Token totali: 552
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 333 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2876 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:48.724812
====================================================================================================
📋 Session ID: classify_1756466268
⏱️  Processing Time: 1.189s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (333 chars):
   [UTENTE] è obbligatorio portare la prescrizione del medico di base per effettuare i raggi x alla mano sinistra ? [ASSISTENTE] Sì, è obbligatorio avere la prescrizione del medico di base per effettu...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (213 chars):
    {"predicted_label": "prenotazione_raggi_x", "confidence": 0.9, "motivation": "L'utente chiede se è obbligatorio portare la prescrizione del medico di base per effettuare i raggi X e l'assistente conferma che sì"}

📊 Parsed Response:
   predicted_label: prenotazione_raggi_x
   confidence: 0.9
   motivation: L'utente chiede se è obbligatorio portare la prescrizione del medico di base per effettuare i raggi X e l'assistente conferma che sì
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede se è obbligatorio portare la prescrizione del medico di base per effettuare i raggi X e l'assistente conferma che sì
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 45440004ee590e3df9def7cac5dca162 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 302
   📊 Token totali: 751
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 751 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 302
   📊 Token conversazione finale: 302
   📊 Token totali: 751
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1092 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2769 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:49.745562
====================================================================================================
📋 Session ID: classify_1756466269
⏱️  Processing Time: 0.917s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1092 chars):
   [UTENTE] vorrei avere un primo colloquio per inseminazione assistita [ASSISTENTE] Sì, in Humanitas è possibile seguire percorsi di fecondazione assistita presso il Fertility Center. Il centro offre...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (180 chars):
    {"predicted_label": "info_fertility_center", "confidence": 0.9, "motivation": "L'utente ha chiesto informazioni sul percorso di fecondazione assistita presso il Fertility Center"}

📊 Parsed Response:
   predicted_label: info_fertility_center
   confidence: 0.9
   motivation: L'utente ha chiesto informazioni sul percorso di fecondazione assistita presso il Fertility Center
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente ha chiesto informazioni sul percorso di fecondazione assistita presso il Fertility Center
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione eea2d61d66a2c2af620e74b2d6ba91ed classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 119
   📊 Token totali: 547
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 547 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 119
   📊 Token conversazione finale: 119
   📊 Token totali: 547
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 446 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2702 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:50.795732
====================================================================================================
📋 Session ID: classify_1756466270
⏱️  Processing Time: 0.946s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (446 chars):
   [UTENTE] Quando chiude la seminologia ad agosto? [ASSISTENTE] Non ho trovato informazioni specifiche sulla chiusura della seminologia ad agosto nei documenti forniti. Ti consiglio di contattare dir...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (202 chars):
    {"predicted_label": "info_esame", "confidence": 0.8, "motivation": "Domanda su quando si chiude una specifica attività o esame (seminologia) non trovando informazioni specifiche nei documenti forniti"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda su quando si chiude una specifica attività o esame (seminologia) non trovando informazioni specifiche nei documenti forniti
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda su quando si chiude una specifica attività o esame (seminologia) non trovando informazioni specifiche nei documenti forniti
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione e920102521862718bc49cef83ad8b62f classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 396
   📊 Token totali: 824
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 824 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 396
   📊 Token conversazione finale: 396
   📊 Token totali: 824
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1212 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2678 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:52.159249
====================================================================================================
📋 Session ID: classify_1756466272
⏱️  Processing Time: 1.258s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1212 chars):
   [UTENTE] PMA quali prestazioni? [ASSISTENTE] Le prestazioni di Procreazione Medicalmente Assistita (PMA) offerte presso Humanitas includono:

1. **Tecniche di primo livello**: Inseminazione intraut...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (280 chars):
    {"predicted_label": "info_fertility_center", "confidence": 0.9, "motivation": "L'utente chiede informazioni sulle prestazioni di Procreazione Medicalmente Assistita (PMA) offerte presso Humanitas e l'assistente risponde con un elenco delle specialità che offrono tale servizio."}

📊 Parsed Response:
   predicted_label: info_fertility_center
   confidence: 0.9
   motivation: L'utente chiede informazioni sulle prestazioni di Procreazione Medicalmente Assistita (PMA) offerte presso Humanitas e l'assistente risponde con un elenco delle specialità che offrono tale servizio.
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni sulle prestazioni di Procreazione Medicalmente Assistita (PMA) offerte presso Humanitas e l'assistente risponde con un elenco delle specialità che offrono tale servizio.
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 1e09f31daf3ca497cd60fc9c75ef8932 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 697
   📊 Token totali: 1145
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 1145 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 697
   📊 Token conversazione finale: 697
   📊 Token totali: 1145
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 2276 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2792 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:53.141512
====================================================================================================
📋 Session ID: classify_1756466273
⏱️  Processing Time: 0.878s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (2276 chars):
   [UTENTE] ciao! ho bisogno di informazioni sulla crioconservazione degli ovociti [ASSISTENTE] La crioconservazione degli ovociti è una tecnica che consente di preservare la fertilità congelando gli ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (151 chars):
    {"predicted_label": "info_crioconservazione_ovociti", "confidence": 0.9, "motivation": "Richiesta informazioni sulla crioconservazione degli ovociti"}

📊 Parsed Response:
   predicted_label: info_crioconservazione_ovociti
   confidence: 0.9
   motivation: Richiesta informazioni sulla crioconservazione degli ovociti
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta informazioni sulla crioconservazione degli ovociti
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 9f976dc70d86cd1b739c433c7c852c55 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 447
   💬 Token conversazione: 221
   📊 Token totali: 668
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 668 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 447
   📊 Token conversazione originale: 221
   📊 Token conversazione finale: 221
   📊 Token totali: 668
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 771 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2737 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:54.007474
====================================================================================================
📋 Session ID: classify_1756466274
⏱️  Processing Time: 0.762s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (771 chars):
   [UTENTE] Ho bisogno di sapere il mio codice ID Humanitas con te [ASSISTENTE] Per recuperare l’ID di [Humanitas con te](https://www.humanitasconte.it), ti consiglio di controllare tra i documenti fo...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (112 chars):
    {"predicted_label": "info_id", "confidence": 0.9, "motivation": "Richiesta di informazioni su un ID specifico"}

📊 Parsed Response:
   predicted_label: info_id
   confidence: 0.9
   motivation: Richiesta di informazioni su un ID specifico
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta di informazioni su un ID specifico
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 5ec8430f050cb759cbb95311e5cd361a classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 197
   📊 Token totali: 625
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 625 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 197
   📊 Token conversazione finale: 197
   📊 Token totali: 625
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 735 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2817 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:55.069046
====================================================================================================
📋 Session ID: classify_1756466275
⏱️  Processing Time: 0.958s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (735 chars):
   [UTENTE] Dove trovo il pin personale per la forma electronics dei consensus? [ASSISTENTE] Il PIN personale per accedere alla forma elettronica dei consensi o altre funzionalità si trova generalment...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (172 chars):
    {"predicted_label": "info_pin_personale", "confidence": 0.9, "motivation": "Richiesta informazioni su dove trovare il PIN personale per la forma elettronica dei consensi"}

📊 Parsed Response:
   predicted_label: info_pin_personale
   confidence: 0.9
   motivation: Richiesta informazioni su dove trovare il PIN personale per la forma elettronica dei consensi
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta informazioni su dove trovare il PIN personale per la forma elettronica dei consensi
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione ec84b8a3b7f5880154514f8bf0b60088 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 274
   📊 Token totali: 723
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 723 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 274
   📊 Token conversazione finale: 274
   📊 Token totali: 723
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 988 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2861 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:56.113864
====================================================================================================
📋 Session ID: classify_1756466276
⏱️  Processing Time: 0.940s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (988 chars):
   [UTENTE] ho bisogno di recuperare il mio ID Huawei [ASSISTENTE] Non posso aiutarti con il recupero dell'ID Huawei, in quanto mi occupo esclusivamente di informazioni relative all'Istituto Clinico H...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (175 chars):
    {"predicted_label": "info_ritiro_ID", "confidence": 0.7, "motivation": "Domanda su come recuperare l'ID Huawei, ma non è un servizio offerto dall'Istituto Clinico Humanitas"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.49999999999999994
   motivation: Domanda su come recuperare l'ID Huawei, ma non è un servizio offerto dall'Istituto Clinico Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.500
   [█████████░░░░░░░░░░░] 50.0%

🧠 Reasoning/Motivation:
   Domanda su come recuperare l'ID Huawei, ma non è un servizio offerto dall'Istituto Clinico Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione d25f2544882542290bc1b1de05965b4d classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 447
   💬 Token conversazione: 196
   📊 Token totali: 643
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 643 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 447
   📊 Token conversazione originale: 196
   📊 Token conversazione finale: 196
   📊 Token totali: 643
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 716 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2836 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:57.293200
====================================================================================================
📋 Session ID: classify_1756466277
⏱️  Processing Time: 1.075s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (716 chars):
   [UTENTE] Dove trovo il mio id humanitas per entrare nell app humanitas con te per consultare la mia cartella clinica?  [ASSISTENTE] Per recuperare l’ID Humanitas con te, controlla tra i documenti f...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (207 chars):
    {"predicted_label": "info_ritiro_referto_cartella_clinica", "confidence": 0.9, "motivation": "Domanda su come recuperare l'ID Humanitas per accedere all'app con il tecnico e consultare la cartella clinica"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto_cartella_clinica
   confidence: 0.9
   motivation: Domanda su come recuperare l'ID Humanitas per accedere all'app con il tecnico e consultare la cartella clinica
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come recuperare l'ID Humanitas per accedere all'app con il tecnico e consultare la cartella clinica
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione c370013db9dcc6e9fc9e714a59dfe59d classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 441
   📊 Token totali: 889
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 889 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 441
   📊 Token conversazione finale: 441
   📊 Token totali: 889
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1513 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2862 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:58.314775
====================================================================================================
📋 Session ID: classify_1756466278
⏱️  Processing Time: 0.918s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1513 chars):
   [UTENTE] Buongiorno, ho bisogno di recuperare il mio codice ID Humanitas con te per visualizzare il referto di un esame [ASSISTENTE] Per recuperare l’ID Humanitas con te, ti consiglio di controllar...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (166 chars):
    {"predicted_label": "info_ritiro_referto", "confidence": 0.9, "motivation": "Domanda su come recuperare il codice ID Humanitas per visualizzare un referto di esame"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto
   confidence: 0.9
   motivation: Domanda su come recuperare il codice ID Humanitas per visualizzare un referto di esame
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come recuperare il codice ID Humanitas per visualizzare un referto di esame
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione fb89dcb4ed12f38b08870e24ae3a4d6c classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 219
   📊 Token totali: 667
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 667 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 219
   📊 Token conversazione finale: 219
   📊 Token totali: 667
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 746 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2763 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:17:59.283780
====================================================================================================
📋 Session ID: classify_1756466279
⏱️  Processing Time: 0.865s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (746 chars):
   [UTENTE] Vorrei eseguire il pannello linfocitario mit [ASSISTENTE] Non ho trovato informazioni specifiche sul pannello linfocitario mit nei documenti forniti. Ti consiglio di contattare direttament...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (145 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "Domanda specifica su un esame di laboratorio, il pannello linfocitario mit"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: Domanda specifica su un esame di laboratorio, il pannello linfocitario mit
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda specifica su un esame di laboratorio, il pannello linfocitario mit
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione dfe4b795457e473d21833549a6e35634 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 202
   📊 Token totali: 630
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 630 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 202
   📊 Token conversazione finale: 202
   📊 Token totali: 630
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 587 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2652 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:00.239714
====================================================================================================
📋 Session ID: classify_1756466280
⏱️  Processing Time: 0.852s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (587 chars):
   [UTENTE] E colordoppler [ASSISTENTE] L'ecocolordoppler è una metodica non invasiva che permette di visualizzare i principali vasi sanguigni e studiarne il flusso ematico. È utile per monitorare pat...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (130 chars):
    {"predicted_label": "info_ecocolordoppler", "confidence": 0.9, "motivation": "L'utente chiede informazioni sull'ecocolordoppler"}

📊 Parsed Response:
   predicted_label: info_ecocolordoppler
   confidence: 0.9
   motivation: L'utente chiede informazioni sull'ecocolordoppler
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni sull'ecocolordoppler
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 5eafebf8756bfdb64f2c087c3332429b classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 165
   📊 Token totali: 613
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 613 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 165
   📊 Token conversazione finale: 165
   📊 Token totali: 613
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 511 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2791 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:01.305440
====================================================================================================
📋 Session ID: classify_1756466281
⏱️  Processing Time: 0.962s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (511 chars):
   [UTENTE] Vorrei sapere se fate l'esame "ab anti covid", grazie [ASSISTENTE] Sì, Humanitas esegue l'esame per la ricerca degli anticorpi anti SARS-CoV-2 (proteina trimerica) IgG. Puoi consultare le ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (156 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "L'utente chiede informazioni sull'esame 'ab anti covid', che è un esame di tipo esame"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: L'utente chiede informazioni sull'esame 'ab anti covid', che è un esame di tipo esame
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni sull'esame 'ab anti covid', che è un esame di tipo esame
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione ebe092b7dc8273d4350bab0c1c11e754 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 195
   📊 Token totali: 623
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 623 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 195
   📊 Token conversazione finale: 195
   📊 Token totali: 623
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 632 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2814 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:02.219405
====================================================================================================
📋 Session ID: classify_1756466282
⏱️  Processing Time: 0.809s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (632 chars):
   [UTENTE] Buongiorno, durante la visita proctologica viene eseguita anche l'anoscopia? [ASSISTENTE] Durante la visita proctologica, il medico può decidere di eseguire un'anoscopia se lo ritiene oppo...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (116 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "La domanda riguarda un esame medico specifico"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: La domanda riguarda un esame medico specifico
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   La domanda riguarda un esame medico specifico
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione aea468d466a643dc7463222fb7c45dae classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 211
   📊 Token totali: 659
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 659 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 211
   📊 Token conversazione finale: 211
   📊 Token totali: 659
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 751 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2851 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:03.262508
====================================================================================================
📋 Session ID: classify_1756466283
⏱️  Processing Time: 0.938s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (751 chars):
   [UTENTE] ho bisogno di sapere praticamente quant'è il costo check-up completo per una donna sopra i 50 anni che ho visto che viene fatto al Humanitas [ASSISTENTE] Il CheckLab Donna Over 50 è un per...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (157 chars):
    {"predicted_label": "info_checkup", "confidence": 0.9, "motivation": "Richiesta di informazioni sui costi del check-up specifico per donne sopra i 50 anni"}

📊 Parsed Response:
   predicted_label: info_checkup
   confidence: 0.9
   motivation: Richiesta di informazioni sui costi del check-up specifico per donne sopra i 50 anni
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta di informazioni sui costi del check-up specifico per donne sopra i 50 anni
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione b659f77b1097d69028e8b74a6a35e8c0 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 1568
   📊 Token totali: 2016
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 2016 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 1568
   📊 Token conversazione finale: 1568
   📊 Token totali: 2016
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 4796 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2827 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:04.193952
====================================================================================================
📋 Session ID: classify_1756466284
⏱️  Processing Time: 0.826s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (4796 chars):
   [UTENTE] voreri avere le norme di preparazione per una risonanza al ginocchio [ASSISTENTE] Puoi consultare le norme di preparazione per la risonanza magnetica al ginocchio (con o senza contrasto) t...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (136 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "Domanda su come prepararsi per un esame di risonanza al ginocchio"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: Domanda su come prepararsi per un esame di risonanza al ginocchio
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come prepararsi per un esame di risonanza al ginocchio
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 24aba746ecff13e30673e932ba4becaf classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 198
   📊 Token totali: 646
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 646 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 198
   📊 Token conversazione finale: 198
   📊 Token totali: 646
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 641 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2707 chars (debug_prompt=False)
🔧 Creazione MongoClassificationReader per cliente: humanitas
✅ MongoClassificationReader humanitas creato con collection: humanitas_015007d9-d413-11ef-86a5-96000228e7fe
✅ Connesso a MongoDB database: classificazioni
🔍 Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:05.085511
====================================================================================================
📋 Session ID: classify_1756466285
⏱️  Processing Time: 0.785s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (641 chars):
   [UTENTE] Buonasera,vorrei avere informazioni riguardo esame Pet al gallio.Grazie  [ASSISTENTE] L'esame PET con traccianti recettoriali al Gallio (68Ga-DOTATOC) è utilizzato principalmente per la di...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (121 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "L'utente chiede informazioni su un esame specifico"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: L'utente chiede informazioni su un esame specifico
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni su un esame specifico
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 98662d69ca8acd4d1a815bb9dcb91a07 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 125
   📊 Token totali: 553
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 553 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 125
   📊 Token conversazione finale: 125
   📊 Token totali: 553
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 378 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2748 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:06.154812
====================================================================================================
📋 Session ID: classify_1756466286
⏱️  Processing Time: 0.963s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (378 chars):
   [UTENTE] Ricerca proteine nelle urine nelle 24 orr [ASSISTENTE] Per la raccolta delle urine delle 24 ore, puoi consultare le norme di preparazione al seguente [link](https://www.humanitas.it/wp-con...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (164 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "L'utente chiede informazioni su come effettuare un esame di proteine nelle urine delle 24 ore"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: L'utente chiede informazioni su come effettuare un esame di proteine nelle urine delle 24 ore
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni su come effettuare un esame di proteine nelle urine delle 24 ore
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione b337410a23ebc759a922f7e1aca34af5 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 244
   📊 Token totali: 672
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 672 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 244
   📊 Token conversazione finale: 244
   📊 Token totali: 672
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 850 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2751 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:07.146545
====================================================================================================
📋 Session ID: classify_1756466287
⏱️  Processing Time: 0.886s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (850 chars):
   [UTENTE] Come ci si prepara per l'eco color doppler [ASSISTENTE] Puoi trovare le norme di preparazione per l'eco color doppler al seguente [link](https://www.humanitas.it/wp-content/uploads/2025/01...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (154 chars):
    {"predicted_label": "info_eco_color_doppler", "confidence": 0.9, "motivation": "L'utente chiede informazioni sulla preparazione per l'eco color doppler"}

📊 Parsed Response:
   predicted_label: info_eco_color_doppler
   confidence: 0.9
   motivation: L'utente chiede informazioni sulla preparazione per l'eco color doppler
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni sulla preparazione per l'eco color doppler
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 775ddd853471ce144bff70ef718ce26a classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 121
   📊 Token totali: 549
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 549 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 121
   📊 Token conversazione finale: 121
   📊 Token totali: 549
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 353 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2703 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:08.132632
====================================================================================================
📋 Session ID: classify_1756466288
⏱️  Processing Time: 0.881s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (353 chars):
   [UTENTE] NORME PREPARAZIONE TC COLON [ASSISTENTE] Puoi trovare le norme di preparazione per la Colonscopia virtuale – TAC Addome inferiore con e senza contrasto al seguente [link](https://www.human...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (162 chars):
    {"predicted_label": "info_preparazione_TC_colon", "confidence": 0.9, "motivation": "L'utente chiede informazioni sulla preparazione per la colonscopia virtuale"}

📊 Parsed Response:
   predicted_label: info_preparazione_tc_colon
   confidence: 0.9
   motivation: L'utente chiede informazioni sulla preparazione per la colonscopia virtuale
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni sulla preparazione per la colonscopia virtuale
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione dd96df884bfbb3b8d2e8a8cbe9187ff2 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 176
   📊 Token totali: 625
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 625 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 176
   📊 Token conversazione finale: 176
   📊 Token totali: 625
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 644 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2875 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:09.128243
====================================================================================================
📋 Session ID: classify_1756466289
⏱️  Processing Time: 0.891s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (644 chars):
   [UTENTE] Devo modificare il numero di cellulare  [ASSISTENTE] Per modificare il numero di cellulare associato al tuo account o ai tuoi dati presso Humanitas, ti consiglio di accedere al portale [Hu...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (137 chars):
    {"predicted_label": "cambio_anagrafica", "confidence": 0.9, "motivation": "Domanda su come modificare il numero di cellulare richiesto"}

📊 Parsed Response:
   predicted_label: cambio_anagrafica
   confidence: 0.9
   motivation: Domanda su come modificare il numero di cellulare richiesto
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come modificare il numero di cellulare richiesto
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione d7db4d98215dd878f73246f9963ea65b classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 452
   💬 Token conversazione: 93
   📊 Token totali: 545
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 545 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 452
   📊 Token conversazione originale: 93
   📊 Token conversazione finale: 93
   📊 Token totali: 545
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 322 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2811 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:10.593423
====================================================================================================
📋 Session ID: classify_1756466290
⏱️  Processing Time: 1.361s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (322 chars):
   [UTENTE] Hanno sbagliato il mio numero di telefono  [ASSISTENTE] Se il tuo numero di telefono è stato registrato in modo errato, ti consiglio di contattare direttamente il servizio di assistenza o ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (277 chars):
    {"predicted_label": "correzione_anagrafica", "confidence": 0.9, "motivation": "L'utente ha richiesto di correggere un errore nella sua anagrafica (numero di telefono) e viene invitato a contattare il servizio di assistenza o il reparto con cui aveva avuto contatti per farlo"}

📊 Parsed Response:
   predicted_label: correzione_anagrafica
   confidence: 0.9
   motivation: L'utente ha richiesto di correggere un errore nella sua anagrafica (numero di telefono) e viene invitato a contattare il servizio di assistenza o il reparto con cui aveva avuto contatti per farlo
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente ha richiesto di correggere un errore nella sua anagrafica (numero di telefono) e viene invitato a contattare il servizio di assistenza o il reparto con cui aveva avuto contatti per farlo
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 80a29c235341a523ff7128801a228f4e classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 149
   📊 Token totali: 577
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 577 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 149
   📊 Token conversazione finale: 149
   📊 Token totali: 577
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 530 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2677 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:11.733516
====================================================================================================
📋 Session ID: classify_1756466291
⏱️  Processing Time: 1.036s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (530 chars):
   [UTENTE] Come faccio a modificare il mio numero di cellulare sul App area personale  [ASSISTENTE] Per modificare il numero di cellulare nell'App "Humanitas con te", accedi alla tua area personale. ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (195 chars):
    {"predicted_label": "info_modifica_numero_cellulare", "confidence": 0.9, "motivation": "L'utente chiede informazioni su come modificare il proprio numero di cellulare nell'App Humanitas con te"}

📊 Parsed Response:
   predicted_label: info_modifica_numero_cellulare
   confidence: 0.9
   motivation: L'utente chiede informazioni su come modificare il proprio numero di cellulare nell'App Humanitas con te
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni su come modificare il proprio numero di cellulare nell'App Humanitas con te
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 7b26d1ea244055476bf8a1c69dbd417b classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 316
   📊 Token totali: 765
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 765 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 316
   📊 Token conversazione finale: 316
   📊 Token totali: 765
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1118 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2876 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:12.737649
====================================================================================================
📋 Session ID: classify_1756466292
⏱️  Processing Time: 0.900s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1118 chars):
   [UTENTE] Buona sera Giulia  [ASSISTENTE] Buona sera! Come posso esserti utile? 😊 [UTENTE] Allora, devo entrare nella sezione referti, però non posso più entrare, perché non ho più il vecchio numero...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (170 chars):
    {"predicted_label": "problema_accesso_portale", "confidence": 0.8, "motivation": "Domanda su difficoltà di accesso al portale con richiesta di cambio numero telefonico"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda su difficoltà di accesso al portale con richiesta di cambio numero telefonico
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda su difficoltà di accesso al portale con richiesta di cambio numero telefonico
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 75cf2c1e361ed7ab550fc9e2f17bd5d4 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 371
   📊 Token totali: 819
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 819 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 371
   📊 Token conversazione finale: 371
   📊 Token totali: 819
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1201 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2637 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:13.695478
====================================================================================================
📋 Session ID: classify_1756466293
⏱️  Processing Time: 0.853s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1201 chars):
   [UTENTE] Ciao Giulia, avrei bisogno di inviare via e-mail dei documenti alla dottoressa torracca..mi puoi aiutare? [ASSISTENTE] Per inviare documenti alla dottoressa Torracca, ti consiglio di verif...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (125 chars):
    {"predicted_label": "invio_documenti", "confidence": 0.9, "motivation": "L'utente richiede l'invio di documenti via e-mail"}

📊 Parsed Response:
   predicted_label: invio_documenti
   confidence: 0.9
   motivation: L'utente richiede l'invio di documenti via e-mail
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente richiede l'invio di documenti via e-mail
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 0df5a763c83efa8e8be4cbe4101baef3 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 454
   💬 Token conversazione: 113
   📊 Token totali: 567
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 567 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 454
   📊 Token conversazione originale: 113
   📊 Token conversazione finale: 113
   📊 Token totali: 567
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 385 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2904 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:14.823887
====================================================================================================
📋 Session ID: classify_1756466294
⏱️  Processing Time: 1.025s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (385 chars):
   [UTENTE] Buongiorno, segnalo questo errore nel vostro sito WEB
"Centro di Ficerca" nelle indicazioni/info sulla struttura [ASSISTENTE] Grazie mille per aver segnalato l'errore "Centro di Ficerca" s...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (167 chars):
    {"predicted_label": "problema_accesso_portale", "confidence": 0.9, "motivation": "L'utente segnala un errore nel sito web, che è una richiesta di accesso al portale"}

📊 Parsed Response:
   predicted_label: problema_accesso_portale
   confidence: 0.9
   motivation: L'utente segnala un errore nel sito web, che è una richiesta di accesso al portale
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente segnala un errore nel sito web, che è una richiesta di accesso al portale
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 1fc70b6b61ce38c08ef758ea103a8bad classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 83
   📊 Token totali: 531
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 531 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 83
   📊 Token conversazione finale: 83
   📊 Token totali: 531
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 293 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2803 chars (debug_prompt=False)
🔧 Creazione MongoClassificationReader per cliente: alleanza
✅ MongoClassificationReader alleanza creato con collection: alleanza_a0fd7600-f4f7-11ef-9315-96000228e7fe
✅ Connesso a MongoDB database: classificazioni

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:15.881257
====================================================================================================
📋 Session ID: classify_1756466295
⏱️  Processing Time: 0.953s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (293 chars):
   [UTENTE] Vorrei eliminare e mail di Brevi Rita [ASSISTENTE] Non ho la possibilità di gestire o eliminare email o dati personali. Ti consiglio di contattare direttamente il servizio di supporto o l'...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (181 chars):
    {"predicted_label": "cambio_anagrafica", "confidence": 0.8, "motivation": "L'utente ha chiesto di eliminare un'email, che è una richiesta di cambio delle informazioni anagrafiche"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: L'utente ha chiesto di eliminare un'email, che è una richiesta di cambio delle informazioni anagrafiche
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   L'utente ha chiesto di eliminare un'email, che è una richiesta di cambio delle informazioni anagrafiche
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🔍 Review Queue recuperate 0 sessioni (representatives: True, propagated: True, outliers: True)
🤖 LLM DIRECT CLASSIFICATION: Sessione 5cd1f7f6e25ff4fff08483a851c220d2 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 174
   📊 Token totali: 622
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 622 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 174
   📊 Token conversazione finale: 174
   📊 Token totali: 622
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 608 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2765 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:16.703712
====================================================================================================
📋 Session ID: classify_1756466296
⏱️  Processing Time: 0.716s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (608 chars):
   [UTENTE] vorrei sapere se vendete stampelle canadesi [ASSISTENTE] Non ho informazioni specifiche sulla vendita di stampelle canadesi presso Humanitas. Ti consiglio di contattare direttamente il cen...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (130 chars):
    {"predicted_label": "info_prodotti", "confidence": 0.7, "motivation": "Domanda sui prodotti venduti presso l'ospedale Humanitas"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.49999999999999994
   motivation: Domanda sui prodotti venduti presso l'ospedale Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.500
   [█████████░░░░░░░░░░░] 50.0%

🧠 Reasoning/Motivation:
   Domanda sui prodotti venduti presso l'ospedale Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione f8e7d7f69ecdad5f8112ede558bca998 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 81
   📊 Token totali: 509
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 509 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 81
   📊 Token conversazione finale: 81
   📊 Token totali: 509
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 309 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2765 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:17.637271
====================================================================================================
📋 Session ID: classify_1756466297
⏱️  Processing Time: 0.829s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (309 chars):
   [UTENTE] sto cercando il numero di telefono della dottoressa Federica Carlea [ASSISTENTE] Non ho trovato informazioni specifiche sul numero di telefono della dottoressa Federica Carlea. Ti consigli...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (127 chars):
    {"predicted_label": "info_contatti", "confidence": 0.9, "motivation": "Domanda sui contatti della dottoressa Federica Carlea"}

📊 Parsed Response:
   predicted_label: info_contatti
   confidence: 0.9
   motivation: Domanda sui contatti della dottoressa Federica Carlea
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda sui contatti della dottoressa Federica Carlea
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione bcb6e3c5d7f0d11dca926aed5a534c34 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 289
   📊 Token totali: 737
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 737 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 289
   📊 Token conversazione finale: 289
   📊 Token totali: 737
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 940 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2831 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:18.632924
====================================================================================================
📋 Session ID: classify_1756466298
⏱️  Processing Time: 0.889s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (940 chars):
   [UTENTE] Buongiorno Giulia sn in lista d'attesa x un intervento di otorinolaringoiatria ma nn ho ricevuto più notizie  [ASSISTENTE] Se sei in lista d'attesa per un intervento, Humanitas ti contatte...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (145 chars):
    {"predicted_label": "info_ricovero", "confidence": 0.9, "motivation": "Domanda su quando e come sarà programmato il ricovero per un intervento"}

📊 Parsed Response:
   predicted_label: info_ricovero
   confidence: 0.9
   motivation: Domanda su quando e come sarà programmato il ricovero per un intervento
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su quando e come sarà programmato il ricovero per un intervento
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione d482d6b8f7c0631ae9cb6af9674323c2 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 92
   📊 Token totali: 520
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 520 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 92
   📊 Token conversazione finale: 92
   📊 Token totali: 520
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 286 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2760 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:19.576236
====================================================================================================
📋 Session ID: classify_1756466299
⏱️  Processing Time: 0.838s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (286 chars):
   [UTENTE] come posso chiamare caposala centro oetopedico [ASSISTENTE] Per contattare il caposala o il personale del Centro Ortopedico (Ortho Center) di Humanitas, puoi utilizzare il numero di telefo...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (129 chars):
    {"predicted_label": "info_contatti", "confidence": 0.9, "motivation": "Domanda sui contatti del Centro Ortopedico di Humanitas"}

📊 Parsed Response:
   predicted_label: info_contatti
   confidence: 0.9
   motivation: Domanda sui contatti del Centro Ortopedico di Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda sui contatti del Centro Ortopedico di Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione f1c027c2d70e785afae3a0f24357ab90 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 62
   📊 Token totali: 511
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 511 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 62
   📊 Token conversazione finale: 62
   📊 Token totali: 511
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 201 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2708 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:20.535068
====================================================================================================
📋 Session ID: classify_1756466300
⏱️  Processing Time: 0.852s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (201 chars):
   [UTENTE] devo parlare con la farmacia Voglio un po' diretto [ASSISTENTE] Ti consiglio di contattare il centralino al numero 02 82 24 1 per ottenere assistenza e informazioni dettagliate sulla farma...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (171 chars):
    {"predicted_label": "info_contatti", "confidence": 0.8, "motivation": "L'utente chiede di contattare il centralino per ottenere assistenza e informazioni sulla farmacia"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: L'utente chiede di contattare il centralino per ottenere assistenza e informazioni sulla farmacia
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   L'utente chiede di contattare il centralino per ottenere assistenza e informazioni sulla farmacia
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 37a62c94665cc224320a62b5a9f990d2 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 134
   📊 Token totali: 562
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 562 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 134
   📊 Token conversazione finale: 134
   📊 Token totali: 562
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 435 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2776 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:21.569360
====================================================================================================
📋 Session ID: classify_1756466301
⏱️  Processing Time: 0.929s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (435 chars):
   [UTENTE] Nr telefono x contattare palazzina 2 piano d3 [ASSISTENTE] Potresti specificare quale reparto o servizio desideri contattare nella palazzina 2, piano D3? In questo modo posso aiutarti a tr...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (160 chars):
    {"predicted_label": "info_contatti", "confidence": 0.9, "motivation": "Domanda sui contatti per un determinato reparto o servizio nella palazzina 2, piano D3"}

📊 Parsed Response:
   predicted_label: info_contatti
   confidence: 0.9
   motivation: Domanda sui contatti per un determinato reparto o servizio nella palazzina 2, piano D3
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda sui contatti per un determinato reparto o servizio nella palazzina 2, piano D3
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 1e2c991c97eb119de0d72f26a9b3d704 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 206
   📊 Token totali: 634
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 634 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 206
   📊 Token conversazione finale: 206
   📊 Token totali: 634
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 719 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2811 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:22.571870
====================================================================================================
📋 Session ID: classify_1756466302
⏱️  Processing Time: 0.897s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (719 chars):
   [UTENTE] Mi hanno contattato per eseguire una TAC con e senza mezzo di contrasto total body e encefalo e mi hanno detto di portare impegnativa del medico curante,ma essendo in Piemonte cambiano i c...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (167 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "Domanda su un esame medico richiesto con codici di prestazione cambiati tra Piemonte e Lombardia"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: Domanda su un esame medico richiesto con codici di prestazione cambiati tra Piemonte e Lombardia
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su un esame medico richiesto con codici di prestazione cambiati tra Piemonte e Lombardia
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 72538165c569a665b684b8aa9338228f classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 218
   📊 Token totali: 646
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 646 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 218
   📊 Token conversazione finale: 218
   📊 Token totali: 646
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 772 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2674 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:23.430465
====================================================================================================
📋 Session ID: classify_1756466303
⏱️  Processing Time: 0.753s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (772 chars):
   [UTENTE] Non riesco a entrare in Humanitas con te [ASSISTENTE] Se non riesci ad accedere a [Humanitas con te](https://www.humanitasconte.it), ti consiglio di verificare di aver inserito correttamen...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (117 chars):
    {"predicted_label": "problema_accesso", "confidence": 0.9, "motivation": "Difficoltà di login al portale Humanitas"}

📊 Parsed Response:
   predicted_label: problema_accesso
   confidence: 0.9
   motivation: Difficoltà di login al portale Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Difficoltà di login al portale Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione df83d0f914ff37df70d454af9bd18217 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 454
   💬 Token conversazione: 386
   📊 Token totali: 840
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 840 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 454
   📊 Token conversazione originale: 386
   📊 Token conversazione finale: 386
   📊 Token totali: 840
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1331 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2885 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:24.437761
====================================================================================================
📋 Session ID: classify_1756466304
⏱️  Processing Time: 0.901s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1331 chars):
   [UTENTE] Non riesco a scaricare i referti del prelievo di di ieri [ASSISTENTE] Per aiutarti meglio, potresti dirmi se hai già verificato che il referto sia disponibile online? Inoltre, potresti spe...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (146 chars):
    {"predicted_label": "problema_accesso_portale", "confidence": 0.9, "motivation": "Domanda su un problema di accesso al portale Humanitas con te"}

📊 Parsed Response:
   predicted_label: problema_accesso_portale
   confidence: 0.9
   motivation: Domanda su un problema di accesso al portale Humanitas con te
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su un problema di accesso al portale Humanitas con te
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 874b11ec176f522118ad8bbda2327557 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 614
   📊 Token totali: 1062
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 1062 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 614
   📊 Token conversazione finale: 614
   📊 Token totali: 1062
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 2090 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2794 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:25.503889
====================================================================================================
📋 Session ID: classify_1756466305
⏱️  Processing Time: 0.961s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (2090 chars):
   [UTENTE] Buongiorno,ho problemi con la registrazione sull app per i referti online e nonostante ho inserito il mio codice fiscale non mi fa procedere .Come posso fare? [ASSISTENTE] Per risolvere il...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (169 chars):
    {"predicted_label": "problema_registrazione_portale", "confidence": 0.9, "motivation": "Domanda riguardante problemi nella registrazione sull'app per i referti online"}

📊 Parsed Response:
   predicted_label: problema_registrazione_portale
   confidence: 0.9
   motivation: Domanda riguardante problemi nella registrazione sull'app per i referti online
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda riguardante problemi nella registrazione sull'app per i referti online
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 0b386d926824b95055bb1aa49c40f511 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 454
   💬 Token conversazione: 252
   📊 Token totali: 706
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 706 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 454
   📊 Token conversazione originale: 252
   📊 Token conversazione finale: 252
   📊 Token totali: 706
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 863 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2906 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:26.836688
====================================================================================================
📋 Session ID: classify_1756466306
⏱️  Processing Time: 1.228s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (863 chars):
   [UTENTE] DEVO SCARICARE I REFERTI ACCURSIO ROBERTO  CODICE FISCALE CCRRRT59H02E573E  NON RIESCO A REGISTRARMI CON QUESTO CODICE FISCALE [ASSISTENTE] Per scaricare i referti tramite il portale [Huma...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (270 chars):
    {"predicted_label": "info_ritiro_referto_cartella_clinica", "confidence": 0.8, "motivation": "Domanda su come scaricare i referti richiede l'accesso al portale Humanitas con te e il codice fiscale fornito è necessario per identificare la cartella clinica del paziente"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda su come scaricare i referti richiede l'accesso al portale Humanitas con te e il codice fiscale fornito è necessario per identificare la cartella clinica del paziente
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda su come scaricare i referti richiede l'accesso al portale Humanitas con te e il codice fiscale fornito è necessario per identificare la cartella clinica del paziente
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione c638a5b6d4546dd719a04c9d86a1dff4 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 454
   💬 Token conversazione: 345
   📊 Token totali: 799
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 799 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 454
   📊 Token conversazione originale: 345
   📊 Token conversazione finale: 345
   📊 Token totali: 799
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1202 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2725 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:27.825958
====================================================================================================
📋 Session ID: classify_1756466307
⏱️  Processing Time: 0.884s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1202 chars):
   [UTENTE] Non riesco a trovare un referto . Dice che è caricato su programma ARIeS.  [ASSISTENTE] Per consultare il referto tramite il programma ARIeS, è necessario registrarsi al portale [Humanitas...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (193 chars):
    {"predicted_label": "info_ricerca_report", "confidence": 0.8, "motivation": "Domanda su come trovare un referto indicando nome, cognome, codice fiscale e motivo della richiesta di assistenza"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda su come trovare un referto indicando nome, cognome, codice fiscale e motivo della richiesta di assistenza
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda su come trovare un referto indicando nome, cognome, codice fiscale e motivo della richiesta di assistenza
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione cd9a2eefff211630621a6e69e82c9c5d classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 269
   📊 Token totali: 697
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 697 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 269
   📊 Token conversazione finale: 269
   📊 Token totali: 697
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 954 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2716 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:28.806739
====================================================================================================
📋 Session ID: classify_1756466308
⏱️  Processing Time: 0.876s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (954 chars):
   [UTENTE] non riesco ad accedere a miei referti [ASSISTENTE] Se non riesci ad accedere ai tuoi referti, ti consiglio di verificare quanto segue:

1. Assicurati di essere registrato a [Humanitas con ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [77 more lines] ...
     Line 81: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (170 chars):
    {"predicted_label": "problema_accesso_portale", "confidence": 0.8, "motivation": "Domanda su come accedere ai propri referti, che richiede un accesso al portale online"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda su come accedere ai propri referti, che richiede un accesso al portale online
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda su come accedere ai propri referti, che richiede un accesso al portale online
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione b509f5411d19715cbc0081e5f61f2494 classificata tramite LLM diretto (classificazione=unknown)
   📈 Progresso LLM: 150/166
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 283
   📊 Token totali: 711
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 711 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 283
   📊 Token conversazione finale: 283
   📊 Token totali: 711
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 986 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2791 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:29.838116
====================================================================================================
📋 Session ID: classify_1756466309
⏱️  Processing Time: 0.925s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (986 chars):
   [UTENTE] p [ASSISTENTE] Potresti darmi qualche dettaglio in più su come posso aiutarti? Sono qui per rispondere alle tue domande! [UTENTE] Impossibile accedere all'allegato conferma mia visita per ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (165 chars):
    {"predicted_label": "problema_accesso_allegati", "confidence": 0.9, "motivation": "Domanda su come accedere ad un allegato della visita di ecografia transerettale"}

📊 Parsed Response:
   predicted_label: problema_accesso_allegati
   confidence: 0.9
   motivation: Domanda su come accedere ad un allegato della visita di ecografia transerettale
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come accedere ad un allegato della visita di ecografia transerettale
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 8d818708dc983a5a33db1d5c67a63adc classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 452
   💬 Token conversazione: 595
   📊 Token totali: 1047
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 1047 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 452
   📊 Token conversazione originale: 595
   📊 Token conversazione finale: 595
   📊 Token totali: 1047
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 2113 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2805 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:30.765288
====================================================================================================
📋 Session ID: classify_1756466310
⏱️  Processing Time: 0.821s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (2113 chars):
   [UTENTE] Ho effettuato un esame di laboratorio al centro Humanitas cellini il 27/07/2025. Mi hanno consegnato il foglio per il ritiro referto con su scritto che sarebbe stato disponibile dal 12/08 ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (119 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "Domanda sui risultati di un esame di laboratorio"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: Domanda sui risultati di un esame di laboratorio
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda sui risultati di un esame di laboratorio
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione e01b9a94584be18bf844cffee0446986 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 454
   💬 Token conversazione: 372
   📊 Token totali: 826
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 826 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 454
   📊 Token conversazione originale: 372
   📊 Token conversazione finale: 372
   📊 Token totali: 826
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1236 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2706 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:31.866696
====================================================================================================
📋 Session ID: classify_1756466311
⏱️  Processing Time: 0.996s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1236 chars):
   [UTENTE] Buongiorno Giulia, sono già registrata ad Humanitas.it ed ho già App, ma non riesco più af [ASSISTENTE] Sembra che tu stia riscontrando un problema con l'accesso o l'utilizzo dell'app Huma...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (206 chars):
    {"predicted_label": "info_registrazione", "confidence": 0.8, "motivation": "L'utente si è già registrato ad Humanitas e chiede ulteriore supporto, quindi la domanda può essere riferita alla registrazione"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: L'utente si è già registrato ad Humanitas e chiede ulteriore supporto, quindi la domanda può essere riferita alla registrazione
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   L'utente si è già registrato ad Humanitas e chiede ulteriore supporto, quindi la domanda può essere riferita alla registrazione
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 968dd21a7e9643528493a4271c8c40c7 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 510
   📊 Token totali: 958
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 958 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 510
   📊 Token conversazione finale: 510
   📊 Token totali: 958
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1755 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2677 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:32.816634
====================================================================================================
📋 Session ID: classify_1756466312
⏱️  Processing Time: 0.844s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1755 chars):
   [UTENTE] Non riesco ad accedere ai referti. Il sistema è bloccato. [ASSISTENTE] Ti chiedo scusa, adesso non posso risponderti perché impegnata in un aggiornamento.
Puoi riprovare più tardi? Grazie....

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (136 chars):
    {"predicted_label": "problema_accesso_portale", "confidence": 0.9, "motivation": "Domanda su un problema di accesso al portale online"}

📊 Parsed Response:
   predicted_label: problema_accesso_portale
   confidence: 0.9
   motivation: Domanda su un problema di accesso al portale online
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su un problema di accesso al portale online
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 10f27252a6b4d20996adc3b6a9d2168a classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 235
   📊 Token totali: 684
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 684 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 235
   📊 Token conversazione finale: 235
   📊 Token totali: 684
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 825 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2769 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:33.917432
====================================================================================================
📋 Session ID: classify_1756466313
⏱️  Processing Time: 0.995s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (825 chars):
   [UTENTE] Ciao ho perso il mio ID per ritirare cartella clinica  [ASSISTENTE] Per recuperare l’ID necessario per accedere a [Humanitas con te](https://www.humanitasconte.it) e ritirare la tua cartel...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (179 chars):
    {"predicted_label": "info_ritiro_referto_cartella_clinica", "confidence": 0.9, "motivation": "Richiesta di informazioni su come recuperare l'ID per ritirare la cartella clinica"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto_cartella_clinica
   confidence: 0.9
   motivation: Richiesta di informazioni su come recuperare l'ID per ritirare la cartella clinica
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta di informazioni su come recuperare l'ID per ritirare la cartella clinica
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 82580dd0ef350a92549fe9dd0965ad16 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 447
   💬 Token conversazione: 205
   📊 Token totali: 652
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 652 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 447
   📊 Token conversazione originale: 205
   📊 Token conversazione finale: 205
   📊 Token totali: 652
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 711 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2652 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:34.807574
====================================================================================================
📋 Session ID: classify_1756466314
⏱️  Processing Time: 0.784s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (711 chars):
   [UTENTE] Vorrei il referto della risonanza fatta il 25 06 2025. Via Cellini Ti Porcelli Vilma [ASSISTENTE] Per ottenere il referto della risonanza, puoi accedere al portale [Humanitas con te](https...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [76 more lines] ...
     Line 80: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (118 chars):
    {"predicted_label": "info_esame", "confidence": 0.9, "motivation": "Richiesta di informazioni su un esame specifico"}

📊 Parsed Response:
   predicted_label: info_esame
   confidence: 0.9
   motivation: Richiesta di informazioni su un esame specifico
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Richiesta di informazioni su un esame specifico
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 98c9a5eb179c84c5e6add022e6415c1f classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 529
   📊 Token totali: 957
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 957 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 529
   📊 Token conversazione finale: 529
   📊 Token totali: 957
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1881 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2621 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:36.083356
====================================================================================================
📋 Session ID: classify_1756466316
⏱️  Processing Time: 1.168s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1881 chars):
   [UTENTE] come faccio a veder su humanitas con te la mia cartella clinica? [ASSISTENTE] Per visualizzare la tua cartella clinica su [Humanitas con te](https://www.humanitasconte.it), devi accedere a...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [73 more lines] ...
     Line 77: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (219 chars):
    {"predicted_label": "info_ritiro_referto_cartella_clinica", "confidence": 0.9, "motivation": "L'utente chiede di visualizzare la sua cartella clinica su Humanitas e l'aiuto richiesto è quello di sapere come ritirarla"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto_cartella_clinica
   confidence: 0.9
   motivation: L'utente chiede di visualizzare la sua cartella clinica su Humanitas e l'aiuto richiesto è quello di sapere come ritirarla
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede di visualizzare la sua cartella clinica su Humanitas e l'aiuto richiesto è quello di sapere come ritirarla
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 23d103120352f5d0f0a9d88487bb7625 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 411
   📊 Token totali: 859
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 859 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 411
   📊 Token conversazione finale: 411
   📊 Token totali: 859
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1452 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2862 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:37.094440
====================================================================================================
📋 Session ID: classify_1756466317
⏱️  Processing Time: 0.906s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1452 chars):
   [UTENTE] Non ho ancora ricevuto la mia cartella clinica  richiesta il 16 maggio 2025 con spedizione  [ASSISTENTE] Per verificare lo stato della spedizione della tua cartella clinica, ho bisogno di ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (150 chars):
    {"predicted_label": "info_ritiro_referto_cartella_clinica", "confidence": 0.9, "motivation": "Domanda su quando e dove ricevere la cartella clinica"}

📊 Parsed Response:
   predicted_label: info_ritiro_referto_cartella_clinica
   confidence: 0.9
   motivation: Domanda su quando e dove ricevere la cartella clinica
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su quando e dove ricevere la cartella clinica
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 0e5d67420988db61559af76273e1af69 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 454
   💬 Token conversazione: 236
   📊 Token totali: 690
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 690 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 454
   📊 Token conversazione originale: 236
   📊 Token conversazione finale: 236
   📊 Token totali: 690
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 764 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2709 chars (debug_prompt=False)

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:37.962892
====================================================================================================
📋 Session ID: classify_1756466317
⏱️  Processing Time: 0.764s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (764 chars):
   [UTENTE] Non riesco a registrarmi su humanitas con te [ASSISTENTE] Per registrarti su [Humanitas con te](https://www.humanitasconte.it), segui questi passaggi:

1. Collegati al sito [Humanitas con ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (140 chars):
    {"predicted_label": "problema_registrazione_portale", "confidence": 0.8, "motivation": "Domanda su come registrarsi sul portale Humanitas"}

📊 Parsed Response:
   predicted_label: altro
   confidence: 0.6000000000000001
   motivation: Domanda su come registrarsi sul portale Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.600
   [████████████░░░░░░░░] 60.0%

🧠 Reasoning/Motivation:
   Domanda su come registrarsi sul portale Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 8a6ca01a6282509c195728935666e250 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 430
   📊 Token totali: 878
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 878 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 430
   📊 Token conversazione finale: 430
   📊 Token totali: 878
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1423 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2727 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:38.880421
====================================================================================================
📋 Session ID: classify_1756466318
⏱️  Processing Time: 0.811s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1423 chars):
   [UTENTE] Ciao Giulia, come posso registrarmi al vostro portale? [ASSISTENTE] Per registrarti al portale [Humanitas con te](https://www.humanitasconte.it), devi essere maggiorenne e avere a disposiz...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (130 chars):
    {"predicted_label": "registrazione_portale", "confidence": 0.9, "motivation": "Domanda su come registrarsi al portale Humanitas"}

📊 Parsed Response:
   predicted_label: registrazione_portale
   confidence: 0.9
   motivation: Domanda su come registrarsi al portale Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Domanda su come registrarsi al portale Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 58b0b8d7c0a74d01c8dc249b39f6d835 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 454
   💬 Token conversazione: 368
   📊 Token totali: 822
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 822 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 454
   📊 Token conversazione originale: 368
   📊 Token conversazione finale: 368
   📊 Token totali: 822
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 1178 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2782 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:39.843150
====================================================================================================
📋 Session ID: classify_1756466319
⏱️  Processing Time: 0.855s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (1178 chars):
   [UTENTE] Non riesco ad accedere ne registrarmi al servizio  [ASSISTENTE] Se riscontri problemi con la registrazione o l'accesso al portale [Humanitas con te](https://www.humanitasconte.it), ti cons...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (132 chars):
    {"predicted_label": "problema_accesso_portale", "confidence": 0.9, "motivation": "Difficoltà di login al portale Humanitas con te"}

📊 Parsed Response:
   predicted_label: problema_accesso_portale
   confidence: 0.9
   motivation: Difficoltà di login al portale Humanitas con te
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   Difficoltà di login al portale Humanitas con te
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 040d19bc04bc0edb2207fe1e51bda5f3 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 428
   💬 Token conversazione: 247
   📊 Token totali: 675
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 675 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 428
   📊 Token conversazione originale: 247
   📊 Token conversazione finale: 247
   📊 Token totali: 675
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 846 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2692 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:40.861329
====================================================================================================
📋 Session ID: classify_1756466320
⏱️  Processing Time: 0.914s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (846 chars):
   [UTENTE] Come mi registro per scaricare la cartella clinica [ASSISTENTE] Per registrarti e scaricare la cartella clinica, segui questi passaggi:

1. Collegati al portale [Humanitas con te](https://...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [75 more lines] ...
     Line 79: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (153 chars):
    {"predicted_label": "info_registrazione_portale", "confidence": 0.9, "motivation": "L'utente chiede come registrarsi per scaricare la cartella clinica"}

📊 Parsed Response:
   predicted_label: info_registrazione_portale
   confidence: 0.9
   motivation: L'utente chiede come registrarsi per scaricare la cartella clinica
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede come registrarsi per scaricare la cartella clinica
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione 5fc082077ce4ac1530fca2c218c9e301 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 449
   💬 Token conversazione: 180
   📊 Token totali: 629
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 629 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 449
   📊 Token conversazione originale: 180
   📊 Token conversazione finale: 180
   📊 Token totali: 629
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 606 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2764 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:41.942282
====================================================================================================
📋 Session ID: classify_1756466321
⏱️  Processing Time: 0.976s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (606 chars):
   [UTENTE] Come avere lo sconto aereo con humanitas [ASSISTENTE] Per ottenere uno sconto sui viaggi aerei con Humanitas, puoi prenotare tramite l'ufficio viaggi dedicato. Ti consiglio di utilizzare i...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
📤 OUTPUT SECTION
--------------------------------------------------
🔍 Raw Response (154 chars):
    {"predicted_label": "info_sconto_aereo", "confidence": 0.9, "motivation": "L'utente chiede informazioni su come ottenere uno sconto aereo con Humanitas"}

📊 Parsed Response:
   predicted_label: info_sconto_aereo
   confidence: 0.9
   motivation: L'utente chiede informazioni su come ottenere uno sconto aereo con Humanitas
----------------------------------------------------------------------------------------------------
📈 ANALYSIS SECTION
--------------------------------------------------
🎯 Confidence Score: 0.900
   [██████████████████░░] 90.0%

🧠 Reasoning/Motivation:
   L'utente chiede informazioni su come ottenere uno sconto aereo con Humanitas
----------------------------------------------------------------------------------------------------
🔍 CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: humanitas
----------------------------------------------------------------------------------------------------
✅ LLM DEBUG COMPLETED
====================================================================================================

🤖 LLM DIRECT CLASSIFICATION: Sessione cf675f73ca3f991793d3343827b2e5e0 classificata tramite LLM diretto (classificazione=unknown)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
🤖 System prompt caricato per tenant 015007d9-d413-11ef-86a5-96000228e7fe (debug_prompt=False)

🔍 TOKENIZZAZIONE PREVENTIVA LLM CLASSIFICATION
============================================================
🤖 ELABORAZIONE CONVERSAZIONE PER LLM
   🆔 Session ID: llm_conversation
   📝 Token prompt: 448
   💬 Token conversazione: 92
   📊 Token totali: 540
   🎯 Limite massimo: 8000
   ✅ Conversazione OK: 540 ≤ 8000
✅ Tokenizzazione LLM completata:
   📊 Token prompt base: 448
   📊 Token conversazione originale: 92
   📊 Token conversazione finale: 92
   📊 Token totali: 540
   📊 Limite configurato: 8000
   ✅ Conversazione entro i limiti, nessun troncamento
============================================================
👤 User prompt generato per conversazione 297 chars (debug_prompt=False)
🚀 Prompt finale generato per LLM mistral:7b - 2785 chars (debug_prompt=False)
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
📋 Recuperati 0 tag dal database TAGS per tenant 015007d9-d413-11ef-86a5-96000228e7fe
Connessione al database TAG chiusa

====================================================================================================
🤖 LLM DEBUG - CLASSIFICATION | 2025-08-29T11:18:42.972884
====================================================================================================
📋 Session ID: classify_1756466322
⏱️  Processing Time: 0.924s
----------------------------------------------------------------------------------------------------
📥 INPUT SECTION
--------------------------------------------------
💬 Original Text (297 chars):
   [UTENTE] sto provando a chiamare l'ufficio prenotazione viaggi ma non mi risponde nessuno [ASSISTENTE] Per contattare l'ufficio viaggi di Humanitas, ti consiglio di inviare una richiesta via email ...

🎯 Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [74 more lines] ...
     Line 78: <|assistant|>

⚙️  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
