 * Serving Flask app 'server'
 * Debug mode: on
Recuperati 20 tenant dalla tabella TAG.tenants
Recuperati 20 tenant dalla tabella TAG.tenants
Connesso a MongoDB database: classificazioni
ğŸ¯ TRAINING SUPERVISIONATO - Cliente: alleanza
ğŸ“‹ Parametri utente semplificati:
  ï¿½ Max sessioni review: 500
  ğŸ¯ Soglia confidenza: 0.7
  ğŸ”„ Forza review: False
  âš–ï¸  Soglia disagreement: 0.3
ğŸ”§ Inizializzazione pipeline per cliente: alleanza (con lock)
ğŸ”§ Inizializzazione embedder condiviso (con lock)...
ğŸš€ Inizializzazione LaBSE embedder su device: cuda
ğŸ“¥ Caricamento modello sentence-transformers/LaBSE...
ğŸš€ Caricamento diretto su GPU...
âœ… Modello caricato con successo!
ğŸ“Š Dimensione embedding: 768
ğŸ”§ Device: cuda
ğŸ® GPU: NVIDIA A10G
ğŸ’¾ GPU Memory: 23.7 GB
ğŸ“ˆ GPU Memory utilizzata: 1.89 GB
ï¿½ Primo parametro su device: cuda:0
ğŸ§ª Test del modello LaBSE...
ğŸ” Encoding 3 testi su device cuda...
âœ… Embedding generati: shape (3, 768)
âœ… Test modello completato con successo!
   Shape: (3, 768)
   Norme: [0.99999994 1.         1.        ]
   Device: cuda
ğŸ¯ Modello pronto per l'uso!
âœ… Embedder condiviso inizializzato
ğŸš€ Inizializzazione pipeline...
   ğŸ¯ Confidence threshold: 0.7
   ğŸ¤– Auto mode: True
   ğŸ”„ Auto retrain: False
ğŸ”„ Utilizzo embedder condiviso per evitare CUDA out of memory
ğŸ”§ HDBSCANClusterer inizializzato con parametri:
   min_cluster_size: 3
   min_samples: 2
   metric: cosine
   cluster_selection_epsilon: 0.05
ğŸ§  Inizializzazione memoria semantica...
ğŸ§  SemanticMemoryManager inizializzato
  ğŸ¯ Soglia riutilizzo etichette: 0.8
  ğŸ” Soglia similaritÃ  semantica: 0.8
  ğŸ’¾ Cache path: semantic_cache/alleanza_a0fd7600_memory
ğŸ”— Inizializzazione ensemble classifier avanzato...
ğŸ” ML Ensemble Debugger inizializzato e ATTIVO
   ğŸ“ Debug file: ./debug_logs/ml_debug.log
ğŸ” ML Ensemble Debugger attivato
ğŸ”§ Tentativo di inizializzazione IntelligentClassifier...
ğŸ§  GPU Memory prima di LLM: 1.8GB/22.1GB (free: 20.3GB)
âœ… Memoria GPU sufficiente, inizializzazione LLM...
ğŸ¯ Uso modello default: mistral:7b
ğŸ” LLM Debugger inizializzato e ATTIVO
   ğŸ“ Debug file: ./debug_logs/llm_debug.log
   ğŸ¨ Visual formatting: True
ğŸ” LLM Debugger attivato per IntelligentClassifier
ğŸ—„ï¸ MySQL connector inizializzato per TAG.tags
ğŸ—„ï¸ MongoDB connector inizializzato
ğŸ¯ BERTopic provider inizializzato per sistema di fallback intelligente
âš ï¸ Nessuna etichetta trovata in TAG.tags - Prima esecuzione
ğŸ¤– LLM classifier creato automaticamente nell'ensemble
ğŸ’¡ Possibile fine-tuning per alleanza
ğŸ”— Advanced Ensemble Classifier inizializzato
   ğŸ§  LLM weight: 0.60
   ğŸ¤– ML weight: 0.40
   ğŸ¯ Confidence threshold: 0.7
   ğŸ”„ Adaptive weights: True
   ğŸ‘¤ Disaccordi gestiti da QualityGateEngine
ğŸ“¥ Caricamento ultimo modello per alleanza: alleanza_a0fd7600_classifier_20250822_232108
ğŸ“¥ Caricamento ensemble model...
âœ… ML ensemble caricato
âœ… Configurazione caricata
ğŸ”— Ensemble model caricato da models/alleanza_a0fd7600_classifier_20250822_232108
âœ… Modello caricato con successo

ğŸ” VERIFICA BERTOPIC LOADING:
   ğŸ“‹ BERTopic enabled: True
   ğŸ“‹ BERTopic available: True
   ğŸ“ Provider directory: models/alleanza_a0fd7600_classifier_20250822_232108_bertopic
   ğŸ“ Directory exists: False
âš ï¸ Directory BERTopic provider non trovata: models/alleanza_a0fd7600_classifier_20250822_232108_bertopic
â¸ï¸ Riaddestramento automatico disabilitato (modalitÃ  supervisione/API)
   ğŸ’¡ Per abilitare, usare auto_retrain=True nell'inizializzazione
âœ… Classificatore LLM disponibile nell'ensemble
ğŸ‘¤ Inizializzazione trainer interattivo...
ğŸš€ Inizializzazione LaBSE embedder su device: cuda
ğŸ“¥ Caricamento modello sentence-transformers/LaBSE...
ğŸš€ Caricamento diretto su GPU...
âœ… Modello caricato con successo!
ğŸ“Š Dimensione embedding: 768
ğŸ”§ Device: cuda
ğŸ® GPU: NVIDIA A10G
ğŸ’¾ GPU Memory: 23.7 GB
ğŸ“ˆ GPU Memory utilizzata: 3.78 GB
ï¿½ Primo parametro su device: cuda:0
ğŸ§ª Test del modello LaBSE...
ğŸ” Encoding 3 testi su device cuda...
âœ… Embedding generati: shape (3, 768)
âœ… Test modello completato con successo!
   Shape: (3, 768)
   Norme: [0.99999994 1.         1.        ]
   Device: cuda
ğŸ¯ Modello pronto per l'uso!
ğŸ§  Inizializzazione dedupplicatore intelligente...
ğŸ”„ Caricamento memoria semantica dal database...
Connessione al database TAG stabilita con successo
ğŸ“­ Nessuna classificazione trovata nel database
ğŸ“­ Inizializzata memoria semantica vuota
Connessione al database TAG chiusa
âœ… Memoria semantica caricata: 0 campioni, 0 tag
âœ… Pipeline inizializzata!
âœ… Pipeline alleanza inizializzata
ğŸš€ TRAINING SUPERVISIONATO CON DATASET COMPLETO
  ğŸ“Š Estrazione: TUTTE le discussioni dal database
  ğŸ§© Clustering: Su tutto il dataset disponibile
  ğŸ‘¤ Review umana: Max 500 sessioni rappresentative
ğŸ“ TRAINING SUPERVISIONATO AVANZATO
ï¿½ NUOVA LOGICA:
  ğŸ”„ Estrazione: TUTTE le discussioni dal database
  ğŸ§© Clustering: Su tutto il dataset completo
  ğŸ‘¤ Review umana: Massimo 500 sessioni rappresentative
--------------------------------------------------
ğŸ“Š FASE 1: ESTRAZIONE COMPLETA DATASET
ğŸ“Š Estrazione sessioni per alleanza...
ğŸ”„ MODALITÃ€ ESTRAZIONE COMPLETA ATTIVATA
ï¿½ Ignorando limite sessioni - estrazione di TUTTO il dataset
ï¿½ğŸ” Parametri: giorni_indietro=7, limit_originale=None, limit_effettivo=None
ğŸ“Š ModalitÃ  estrazione: COMPLETA
ğŸ”„ Chiamata aggregator.estrai_sessioni_aggregate...
ğŸ“Š Estrazione sessioni aggregate dal schema 'alleanza'...
ğŸ” Esecuzione query per leggere conversazioni dal schema 'alleanza'...
Connessione al database MySQL stabilita con successo
âœ… Query eseguita con successo! Trovate 239 righe
âœ… Trovate 239 righe da aggregare
âœ… Aggregate 34 sessioni uniche
ğŸ”„ Saltati 68 messaggi di benvenuto (primi 2 per sessione)
ğŸ”„ Sessioni vuote (solo benvenuto): 16
ğŸ“¥ Sessioni grezze estratte: 34
ğŸ” Filtraggio sessioni vuote/irrilevanti...
ğŸ” Filtraggio sessioni vuote/irrilevanti...
âœ… Filtro completato:
  ğŸ“Š Sessioni originali: 34
  âŒ Sessioni scartate: 16
  âœ… Sessioni valide: 18
âœ… ESTRAZIONE COMPLETA: 18 sessioni totali dal database
ğŸ¯ Tutte le discussioni disponibili sono state estratte per clustering completo
âœ… Dataset completo: 18 sessioni totali

ğŸ“Š FASE 2: CLUSTERING COMPLETO
ğŸ§© Clustering intelligente di 18 sessioni...
ğŸ” Encoding 18 testi...
ğŸ” Encoding 18 testi su device cuda...
âœ… Embedding generati: shape (18, 768)
âœ… Embedding generati: shape (18, 768)

ğŸ“Š FASE 2A: TRAINING BERTOPIC ANTICIPATO

ğŸš€ TRAINING BERTOPIC ANTICIPATO (NUOVO FLUSSO OTTIMIZZATO):
   ğŸ“Š Dataset completo: 18 sessioni
   ğŸ“Š Embeddings shape: (18, 768)
   ğŸ¯ Addestramento su TUTTO il dataset per features ottimali
   ğŸ”¥ Esecuzione bertopic_provider.fit() su dataset completo...
âš ï¸ Errore training SVD: k must be less than or equal to the number of training points. Procedo senza SVD.
   âœ… BERTopic FIT completato in 5.99 secondi
   ğŸ”„ Esecuzione bertopic_provider.transform() per features extraction...
âŒ ERRORE Training BERTopic anticipato: k must be less than or equal to the number of training points
   ğŸ” Traceback: Traceback (most recent call last):
  File "/home/ubuntu/classificazione_discussioni/Pipeline/end_to_end_pipeline.py", line 353, in _addestra_bertopic_anticipato
    tr = bertopic_provider.transform(
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/classificazione_discussioni/Pipeline/../TopicModeling/bertopic_feature_provider.py", line 197, in transform
    topic_ids, probs = self.model.transform(texts, embeddings=embeddings)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/classificazione_discussioni/.venv/lib/python3.12/site-packages/bertopic/_bertopic.py", line 632, in transform
    probabilities = hdbscan_delegator(self.hdbscan_model, "membership_vector", umap_embeddings)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/classificazione_discussioni/.venv/lib/python3.12/site-packages/bertopic/cluster/_utils.py", line 54, in hdbscan_delegator
    probabilities = hdbscan.membership_vector(model, embeddings)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/classificazione_discussioni/.venv/lib/python3.12/site-packages/hdbscan/prediction.py", line 575, in membership_vector
    clusterer.prediction_data_.tree.query(points_to_predict,
  File "sklearn/neighbors/_binary_tree.pxi", line 1180, in sklearn.neighbors._kd_tree.BinaryTree64.query
ValueError: k must be less than or equal to the number of training points

   âš ï¸ BERTopic provider non disponibile, proseguo con sole embeddings

ğŸ“Š FASE 2B: CLUSTERING HDBSCAN
ğŸ§  Usando clustering INTELLIGENTE (LLM + ML senza pattern)
ğŸ§  Clustering intelligente configurato:
   ğŸ¯ Categorie intent suggerite: 12
   ğŸ¤– LLM primario: True
   ğŸ“Š Min confidence: 0.8
   ğŸ“ˆ Min conversations per intent: 2
   ğŸ‘¥ Rappresentanti diversificati: True
   ğŸ”¢ Max rappresentanti per cluster: 5
   ğŸ¤ Strategia consenso: majority
ğŸ§  Avvio clustering intelligente OTTIMIZZATO di 18 conversazioni...
ğŸ“Š Fase 1: Clustering semantico con HDBSCAN...
   ğŸ“ˆ Cluster HDBSCAN trovati: 3
   ğŸ” Outliers: 2
ğŸ‘¥ Fase 2: Selezione rappresentanti per cluster...
   ï¿½ Cluster 0: 3 sessioni, 3 rappresentanti selezionati
   ï¿½ Cluster 1: 7 sessioni, 3 rappresentanti selezionati
   ï¿½ Cluster 2: 6 sessioni, 3 rappresentanti selezionati
ğŸ¤– Fase 3: Analisi LLM di 9 rappresentanti...
ğŸ¤– Analisi LLM di 9 conversazioni...
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
ğŸ¤– LLM DEBUG - CLASSIFICATION | 2025-08-23T03:50:58.197060
====================================================================================================
ğŸ“‹ Session ID: classify_1755921058
â±ï¸  Processing Time: 1.097s
----------------------------------------------------------------------------------------------------
ğŸ“¥ INPUT SECTION
--------------------------------------------------
ğŸ’¬ Original Text (620 chars):
   [UTENTE] sono le 09.30 cosa devo fare ? [ASSISTENTE] Va bene, controllo. [ASSISTENTE] Alle 09:30, devi controllare lo stato dei cassonetti e dei cestini, pulire eventuali reflui e fare una prima pu...

ğŸ¯ Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

âš™ï¸  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
ğŸ“¤ OUTPUT SECTION
--------------------------------------------------
ğŸ” Raw Response (230 chars):
    {"predicted_label": "altro", "confidence": 0.3, "motivation": "L'utente non ha espresso una richiesta operativa o informativa specifica, ma sembra aver fornito un suggerimento generale sull'ordine e la pulizia dell'area tecnica"}

ğŸ“Š Parsed Response:
   predicted_label: altro
   confidence: 0.5
   motivation: L'utente non ha espresso una richiesta operativa o informativa specifica, ma sembra aver fornito un suggerimento generale sull'ordine e la pulizia dell'area tecnica
----------------------------------------------------------------------------------------------------
ğŸ“ˆ ANALYSIS SECTION
--------------------------------------------------
ğŸ¯ Confidence Score: 0.500
   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 50.0%

ğŸ§  Reasoning/Motivation:
   L'utente non ha espresso una richiesta operativa o informativa specifica, ma sembra aver fornito un suggerimento generale sull'ordine e la pulizia dell'area tecnica
----------------------------------------------------------------------------------------------------
ğŸ” CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
âœ… LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
ğŸ¤– LLM DEBUG - CLASSIFICATION | 2025-08-23T03:50:59.239751
====================================================================================================
ğŸ“‹ Session ID: classify_1755921059
â±ï¸  Processing Time: 1.040s
----------------------------------------------------------------------------------------------------
ğŸ“¥ INPUT SECTION
--------------------------------------------------
ğŸ’¬ Original Text (1336 chars):
   [UTENTE] posso fare cannottaggio in porto [ASSISTENTE] Va bene, controllo. [ASSISTENTE] Nel porto Ã¨ vietato effettuare il canottaggio. [UTENTE] dove posso smaltire l'olio esausto?  [ASSISTENTE] Un ...

ğŸ¯ Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

âš™ï¸  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
ğŸ“¤ OUTPUT SECTION
--------------------------------------------------
ğŸ” Raw Response (238 chars):
    {"predicted_label": "altro", "confidence": 0.3, "motivation": "Domanda riguardante il cannotaggio non Ã¨ tra le etichette comuni e la risposta del sistema non sembra essere direttamente correlata a un'operazione o informazioni richieste"}

ğŸ“Š Parsed Response:
   predicted_label: altro
   confidence: 0.5
   motivation: Domanda riguardante il cannotaggio non Ã¨ tra le etichette comuni e la risposta del sistema non sembra essere direttamente correlata a un'operazione o informazioni richieste
----------------------------------------------------------------------------------------------------
ğŸ“ˆ ANALYSIS SECTION
--------------------------------------------------
ğŸ¯ Confidence Score: 0.500
   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 50.0%

ğŸ§  Reasoning/Motivation:
   Domanda riguardante il cannotaggio non Ã¨ tra le etichette comuni e la risposta del sistema non sembra essere direttamente correlata a un'operazione o informazioni richieste
----------------------------------------------------------------------------------------------------
ğŸ” CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
âœ… LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
ğŸ¤– LLM DEBUG - CLASSIFICATION | 2025-08-23T03:50:59.966539
====================================================================================================
ğŸ“‹ Session ID: classify_1755921059
â±ï¸  Processing Time: 0.725s
----------------------------------------------------------------------------------------------------
ğŸ“¥ INPUT SECTION
--------------------------------------------------
ğŸ’¬ Original Text (1766 chars):
   [UTENTE] ho un blackout su una colonnina [ASSISTENTE] Verifico. [ASSISTENTE] Per gestire un blackout su una colonnina, controlla che le colonnine dello stesso pontile siano in funzione. Verifica i ...

ğŸ¯ Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

âš™ï¸  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
ğŸ“¤ OUTPUT SECTION
--------------------------------------------------
ğŸ” Raw Response (124 chars):
    {"predicted_label": "prenotazione_esami", "confidence": 0.7, "motivation": "Richiesta di verifica per un esame di colonna"}

ğŸ“Š Parsed Response:
   predicted_label: altro
   confidence: 0.49999999999999994
   motivation: Richiesta di verifica per un esame di colonna
----------------------------------------------------------------------------------------------------
ğŸ“ˆ ANALYSIS SECTION
--------------------------------------------------
ğŸ¯ Confidence Score: 0.500
   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 50.0%

ğŸ§  Reasoning/Motivation:
   Richiesta di verifica per un esame di colonna
----------------------------------------------------------------------------------------------------
ğŸ” CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
âœ… LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
ğŸ¤– LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:00.932369
====================================================================================================
ğŸ“‹ Session ID: classify_1755921060
â±ï¸  Processing Time: 0.964s
----------------------------------------------------------------------------------------------------
ğŸ“¥ INPUT SECTION
--------------------------------------------------
ğŸ’¬ Original Text (552 chars):
   [UTENTE] se l'Eucreas Ã¨ mancante devo farlo pagare  fuori dpc? [ASSISTENTE] Verifico. [ASSISTENTE] Se l'Eucreas Ã¨ mancante nel canale DPC, il farmacista deve proporre un farmaco equivalente vincito...

ğŸ¯ Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

âš™ï¸  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
ğŸ“¤ OUTPUT SECTION
--------------------------------------------------
ğŸ” Raw Response (188 chars):
    {"predicted_label": "altro", "confidence": 0.3, "motivation": "L'utente chiede se dovrÃ  pagare il farmaco Eucreas fuori dal DPC, richiesta non riconducibile a una delle etichette comuni"}

ğŸ“Š Parsed Response:
   predicted_label: altro
   confidence: 0.5
   motivation: L'utente chiede se dovrÃ  pagare il farmaco Eucreas fuori dal DPC, richiesta non riconducibile a una delle etichette comuni
----------------------------------------------------------------------------------------------------
ğŸ“ˆ ANALYSIS SECTION
--------------------------------------------------
ğŸ¯ Confidence Score: 0.500
   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 50.0%

ğŸ§  Reasoning/Motivation:
   L'utente chiede se dovrÃ  pagare il farmaco Eucreas fuori dal DPC, richiesta non riconducibile a una delle etichette comuni
----------------------------------------------------------------------------------------------------
ğŸ” CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
âœ… LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
ğŸ¤– LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:01.715039
====================================================================================================
ğŸ“‹ Session ID: classify_1755921061
â±ï¸  Processing Time: 0.781s
----------------------------------------------------------------------------------------------------
ğŸ“¥ INPUT SECTION
--------------------------------------------------
ğŸ’¬ Original Text (1035 chars):
   [UTENTE] Controllo piani terapeutici online [ASSISTENTE] Mmmh, ho capito. [ASSISTENTE] Per il controllo dei piani terapeutici online, le farmacie devono utilizzare il sistema SIPSO Web per accedere...

ğŸ¯ Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

âš™ï¸  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
ğŸ“¤ OUTPUT SECTION
--------------------------------------------------
ğŸ” Raw Response (148 chars):
    {"predicted_label": "info_contatti", "confidence": 0.7, "motivation": "Richiesta di informazioni sui costi e remunerazione per le attivitÃ  online"}

ğŸ“Š Parsed Response:
   predicted_label: altro
   confidence: 0.49999999999999994
   motivation: Richiesta di informazioni sui costi e remunerazione per le attivitÃ  online
----------------------------------------------------------------------------------------------------
ğŸ“ˆ ANALYSIS SECTION
--------------------------------------------------
ğŸ¯ Confidence Score: 0.500
   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 50.0%

ğŸ§  Reasoning/Motivation:
   Richiesta di informazioni sui costi e remunerazione per le attivitÃ  online
----------------------------------------------------------------------------------------------------
ğŸ” CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
âœ… LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
ğŸ¤– LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:02.437102
====================================================================================================
ğŸ“‹ Session ID: classify_1755921062
â±ï¸  Processing Time: 0.720s
----------------------------------------------------------------------------------------------------
ğŸ“¥ INPUT SECTION
--------------------------------------------------
ğŸ’¬ Original Text (265 chars):
   [UTENTE] Il seroquel Ã¨ uscito dalla dpc? [ASSISTENTE] Un attimo. [ASSISTENTE] SÃ¬, il Seroquel Ã¨ stato escluso dalla Distribuzione per Conto (DPC) e riclassificato come Classe C nella Regione Lazio....

ğŸ¯ Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [58 more lines] ...
     Line 62: 

âš™ï¸  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
ğŸ“¤ OUTPUT SECTION
--------------------------------------------------
ğŸ” Raw Response (116 chars):
    {"predicted_label": "info_medicinali", "confidence": 0.9, "motivation": "Domanda sulle informazioni su un farmaco"}

ğŸ“Š Parsed Response:
   predicted_label: altro
   confidence: 0.7
   motivation: Domanda sulle informazioni su un farmaco
----------------------------------------------------------------------------------------------------
ğŸ“ˆ ANALYSIS SECTION
--------------------------------------------------
ğŸ¯ Confidence Score: 0.700
   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] 70.0%

ğŸ§  Reasoning/Motivation:
   Domanda sulle informazioni su un farmaco
----------------------------------------------------------------------------------------------------
ğŸ” CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
âœ… LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
ğŸ¤– LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:03.560528
====================================================================================================
ğŸ“‹ Session ID: classify_1755921063
â±ï¸  Processing Time: 1.122s
----------------------------------------------------------------------------------------------------
ğŸ“¥ INPUT SECTION
--------------------------------------------------
ğŸ’¬ Original Text (262 chars):
   [UTENTE] di cosa puoi parlarmi? [ASSISTENTE] Posso aiutarti con informazioni e domande relative ai documenti che hai caricato, rispondere a domande sui servizi di Alleanza, e fornire supporto su qu...

ğŸ¯ Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

âš™ï¸  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
ğŸ“¤ OUTPUT SECTION
--------------------------------------------------
ğŸ” Raw Response (243 chars):
    {"predicted_label": "info_contatti", "confidence": 0.9, "motivation": "L'utente chiede come possa essere assistito e l'assistente fornisce informazioni sui documenti caricati, servizi di Alleanza e supporto su questioni legate alla farmacia"}

ğŸ“Š Parsed Response:
   predicted_label: altro
   confidence: 0.7
   motivation: L'utente chiede come possa essere assistito e l'assistente fornisce informazioni sui documenti caricati, servizi di Alleanza e supporto su questioni legate alla farmacia
----------------------------------------------------------------------------------------------------
ğŸ“ˆ ANALYSIS SECTION
--------------------------------------------------
ğŸ¯ Confidence Score: 0.700
   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] 70.0%

ğŸ§  Reasoning/Motivation:
   L'utente chiede come possa essere assistito e l'assistente fornisce informazioni sui documenti caricati, servizi di Alleanza e supporto su questioni legate alla farmacia
----------------------------------------------------------------------------------------------------
ğŸ” CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
âœ… LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
ğŸ¤– LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:05.323934
====================================================================================================
ğŸ“‹ Session ID: classify_1755921065
â±ï¸  Processing Time: 1.762s
----------------------------------------------------------------------------------------------------
ğŸ“¥ INPUT SECTION
--------------------------------------------------
ğŸ’¬ Original Text (260 chars):
   [UTENTE] furosemide fa interazione con il warfarin sodico  [ASSISTENTE] Non ho trovato informazioni specifiche sull'interazione tra furosemide e warfarin sodico nei documenti forniti. Ti consiglio ...

ğŸ¯ Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [58 more lines] ...
     Line 62: 

âš™ï¸  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
ğŸ“¤ OUTPUT SECTION
--------------------------------------------------
ğŸ” Raw Response (451 chars):
    {"predicted_label": "altro", "confidence": 0.3, "motivation": "L'utente ha chiesto informazioni su un interazione farmacologica specifica tra furosemide e warfarin sodico, richiesta che non rientra nelle etichette comuni di ritiro cartella clinica, prenotazione esami o contatti. Tuttavia, la ris...

ğŸ“Š Parsed Response:
   predicted_label: altro
   confidence: 0.5
   motivation: L'utente ha chiesto informazioni su un interazione farmacologica specifica tra furosemide e warfarin sodico, richiesta che non rientra nelle etichette comuni di ritiro cartella clinica, prenotazione esami o contatti. Tuttavia, la risposta dell'assistente indica una domanda piÃ¹ generale su interazioni farmacologiche, quindi Ã¨ possibile che l'utente abbia anche intenzioni informative.
----------------------------------------------------------------------------------------------------
ğŸ“ˆ ANALYSIS SECTION
--------------------------------------------------
ğŸ¯ Confidence Score: 0.500
   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 50.0%

ğŸ§  Reasoning/Motivation:
   L'utente ha chiesto informazioni su un interazione farmacologica specifica tra furosemide e warfarin sodico, richiesta che non rientra nelle etichette comuni di ritiro cartella clinica, prenotazione esami o contatti. Tuttavia, la risposta dell'assistente indica una domanda piÃ¹ generale su interazioni farmacologiche, quindi Ã¨ possibile che l'utente abbia anche intenzioni informative.
----------------------------------------------------------------------------------------------------
ğŸ” CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
âœ… LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
ğŸ¤– LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:06.154294
====================================================================================================
ğŸ“‹ Session ID: classify_1755921066
â±ï¸  Processing Time: 0.828s
----------------------------------------------------------------------------------------------------
ğŸ“¥ INPUT SECTION
--------------------------------------------------
ğŸ’¬ Original Text (571 chars):
   [UTENTE] cosa dice la distirbuzioen per conto sul seroquel [ASSISTENTE] Non ho trovato informazioni specifiche sulla distribuzione per conto del Seroquel nei documenti forniti. Se hai altre domande...

ğŸ¯ Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

âš™ï¸  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
ğŸ“¤ OUTPUT SECTION
--------------------------------------------------
ğŸ” Raw Response (156 chars):
    {"predicted_label": "info_dati_farmaci", "confidence": 0.6, "motivation": "Domanda sulle informazioni specifiche sulla distribuzione del farmaco Seroquel"}

ğŸ“Š Parsed Response:
   predicted_label: info_dati_farmaci
   confidence: 0.5
   motivation: Domanda sulle informazioni specifiche sulla distribuzione del farmaco Seroquel
----------------------------------------------------------------------------------------------------
ğŸ“ˆ ANALYSIS SECTION
--------------------------------------------------
ğŸ¯ Confidence Score: 0.500
   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 50.0%

ğŸ§  Reasoning/Motivation:
   Domanda sulle informazioni specifiche sulla distribuzione del farmaco Seroquel
----------------------------------------------------------------------------------------------------
ğŸ” CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
âœ… LLM DEBUG COMPLETED
====================================================================================================

   ğŸ“ˆ Progresso LLM: 9/9
ğŸ”„ Fase 4: Analisi consenso e propagazione etichette...
   âœ… Cluster 0: 'altro' (3 sessioni, 3 reps, conf: 0.600, consenso: 1.00)
   âœ… Cluster 1: 'altro' (7 sessioni, 3 reps, conf: 0.667, consenso: 1.00)
   âœ… Cluster 2: 'altro' (6 sessioni, 3 reps, conf: 0.617, consenso: 0.67)
ğŸ” Fase 5: Analisi individuale di 2 outliers...
ğŸ¤– Analisi LLM di 2 conversazioni...
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
ğŸ¤– LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:07.034746
====================================================================================================
ğŸ“‹ Session ID: classify_1755921067
â±ï¸  Processing Time: 0.878s
----------------------------------------------------------------------------------------------------
ğŸ“¥ INPUT SECTION
--------------------------------------------------
ğŸ’¬ Original Text (668 chars):
   [UTENTE] quali moduli sono correlati alla procedura  [ASSISTENTE] Un attimo. [ASSISTENTE] I moduli correlati alla procedura di gestione delle non conformitÃ  includono il Modulo Non ConformitÃ  (M/MN...

ğŸ¯ Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [58 more lines] ...
     Line 62: 

âš™ï¸  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
ğŸ“¤ OUTPUT SECTION
--------------------------------------------------
ğŸ” Raw Response (171 chars):
    {"predicted_label": "procedura_non_conformita", "confidence": 0.9, "motivation": "Domanda riguardante i moduli correlati alla procedura di gestione delle non conformitÃ "}

ğŸ“Š Parsed Response:
   predicted_label: altro
   confidence: 0.7
   motivation: Domanda riguardante i moduli correlati alla procedura di gestione delle non conformitÃ 
----------------------------------------------------------------------------------------------------
ğŸ“ˆ ANALYSIS SECTION
--------------------------------------------------
ğŸ¯ Confidence Score: 0.700
   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] 70.0%

ğŸ§  Reasoning/Motivation:
   Domanda riguardante i moduli correlati alla procedura di gestione delle non conformitÃ 
----------------------------------------------------------------------------------------------------
ğŸ” CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
âœ… LLM DEBUG COMPLETED
====================================================================================================

Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
ğŸ¤– LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:07.756874
====================================================================================================
ğŸ“‹ Session ID: classify_1755921067
â±ï¸  Processing Time: 0.720s
----------------------------------------------------------------------------------------------------
ğŸ“¥ INPUT SECTION
--------------------------------------------------
ğŸ’¬ Original Text (458 chars):
   [UTENTE] la donna incinta puÃ² assumere aciclovir ? [ASSISTENTE] L'uso di aciclovir in gravidanza deve essere considerato solo quando i potenziali benefici superano i rischi non noti. Studi non hann...

ğŸ¯ Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [58 more lines] ...
     Line 62: 

âš™ï¸  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
ğŸ“¤ OUTPUT SECTION
--------------------------------------------------
ğŸ” Raw Response (129 chars):
    {"predicted_label": "info_contatti", "confidence": 0.7, "motivation": "Domanda sulle prescrizioni farmacologiche in gravidanza"}

ğŸ“Š Parsed Response:
   predicted_label: altro
   confidence: 0.49999999999999994
   motivation: Domanda sulle prescrizioni farmacologiche in gravidanza
----------------------------------------------------------------------------------------------------
ğŸ“ˆ ANALYSIS SECTION
--------------------------------------------------
ğŸ¯ Confidence Score: 0.500
   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 50.0%

ğŸ§  Reasoning/Motivation:
   Domanda sulle prescrizioni farmacologiche in gravidanza
----------------------------------------------------------------------------------------------------
ğŸ” CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
âœ… LLM DEBUG COMPLETED
====================================================================================================

   ğŸ“ˆ Progresso LLM: 2/2
âœ… Clustering intelligente OTTIMIZZATO completato:
   ğŸ“Š Cluster finali: 3
   ğŸ” Outliers rimanenti: 2
   ğŸ¤– Chiamate LLM totali: 11 (vs 18 dell'approccio naive)
   âš¡ Efficienza: 38.9% di riduzione chiamate LLM
   ğŸ¯ Confidenza media: 0.628
âœ… Clustering intelligente completato!
  ğŸ“Š Cluster trovati: 3
  ğŸ” Outliers: 2
  ğŸ·ï¸  Etichette suggerite: 3
  ğŸ¯ Confidenza media: 0.00
  ğŸŒŸ Cluster alta confidenza: 0/3
    - Cluster 0: altro (3 conv., conf: 0.00, metodo: llm_ensemble_consensus)
    - Cluster 1: altro (7 conv., conf: 0.00, metodo: llm_ensemble_consensus)
    - Cluster 2: altro (6 conv., conf: 0.00, metodo: llm_ensemble_consensus)
ğŸ§  Avvio dedupplicazione intelligente delle etichette...
ğŸ“Š Analizzando 3 nuove etichette vs 0 esistenti
ğŸ” Fase 1: Analisi semantica con embeddings...
  ğŸ“‹ Cluster 0: nessuna etichetta esistente per confronto
  ğŸ“‹ Cluster 1: nessuna etichetta esistente per confronto
  ğŸ“‹ Cluster 2: nessuna etichetta esistente per confronto
ğŸŒ³ Fase 2: Clustering gerarchico delle etichette esistenti...
  ğŸ“­ Nessuna etichetta esistente per clustering
ğŸ¤– Fase 3: Validazione LLM per casi ambigui...
âš–ï¸  Fase 4: Decisione finale con confidence scoring...
ğŸ“Š Statistiche finali: 0 riusate, 3 nuove
âœ… Dedupplicazione completata: 3 etichette processate
âœ… Clustering completo: 3 cluster, 2 outlier

ğŸ“Š FASE 3: SELEZIONE RAPPRESENTANTI PER REVIEW UMANA
ğŸ” Selezione intelligente rappresentanti per review umana...
ğŸ“Š Analisi cluster:
  ğŸ“‹ Cluster totali: 3
  âœ… Cluster eleggibili: 3
  ğŸš« Cluster troppo piccoli (< 2): 0
ğŸ“Š Calcolo sessioni:
  ğŸ¯ Limite massimo: 500
  ğŸ“ Con 3 reps/cluster: 9
âœ… Possiamo usare configurazione standard (3 reps/cluster)
âœ… Selezione completata:
  ğŸ“‹ Cluster originali: 3
  ğŸ‘¤ Cluster per review: 3
  ğŸ“ Sessioni per review: 9
  ğŸš« Cluster esclusi: 0

ğŸ“Š FASE 4: TRAINING SUPERVISIONATO
ğŸ“ Training del classificatore...
ğŸ“Š Sessioni da processare: 18
ğŸ·ï¸  Etichette suggerite: 3
ğŸ‘¤ ModalitÃ  interattiva: True
ğŸ“ˆ Cluster validi trovati: 3

ğŸ‘¤ MODALITÃ€ INTERATTIVA ABILITATA
ğŸ“Š Trovati 3 cluster da revieware
â­ï¸ Procedendo automaticamente con review interattiva abilitata
ğŸ” Labels dopo review: 3

ğŸ” INIZIO REVIEW INTERATTIVO

================================================================================
ğŸ“‹ REVIEW CLUSTER 0
ğŸ·ï¸  Etichetta suggerita: 'altro'
================================================================================

ğŸ“ CONVERSAZIONI RAPPRESENTATIVE (3 esempi):
------------------------------------------------------------

[1] Sessione: 935e2349-0f2f-4ffc-a520-dbec4d0daf1b
    Conversazione:
    [UTENTE] posso fare cannottaggio in porto [ASSISTENTE] Va bene, controllo. [ASSISTENTE] Nel porto Ã¨ vietato effettuare il canottaggio. [UTENTE] dove posso smaltire l'olio esausto?  [ASSISTENTE] Un secondo che recupero le info. [ASSISTENTE] Nel porto, le miscele di idrocarburi di sentine possono essere smaltite a terra, recapitandole negli appositi luoghi di raccolta. [UTENTE] e in mare non posso buttarli ? [ASSISTENTE] Va bene, controllo. [ASSISTENTE] No, Ã¨ vietato smaltire olio esausto in mare....
------------------------------------------------------------

[2] Sessione: 9741423f-b080-405f-937d-5bd8b8b523a1
    Conversazione:
    [UTENTE] sono le 09.30 cosa devo fare ? [ASSISTENTE] Va bene, controllo. [ASSISTENTE] Alle 09:30, devi controllare lo stato dei cassonetti e dei cestini, pulire eventuali reflui e fare una prima pulizia dello specchio acqueo. [UTENTE] riassumi quali sono i compiti [ASSISTENTE] Mmmh, capisco. [ASSISTENTE] I compiti giornalieri degli ormeggiatori includono: spegnere le luci, controllare le aree comuni, aggiornare il registro transiti, sistemare gli arredi, pulire lo specchio acqueo, eseguire lavor...
------------------------------------------------------------

[3] Sessione: afb89af4-4d1d-46a6-b39e-407013c5cc08
    Conversazione:
    [UTENTE] ho un blackout su una colonnina [ASSISTENTE] Verifico. [ASSISTENTE] Per gestire un blackout su una colonnina, controlla che le colonnine dello stesso pontile siano in funzione. Verifica i magnetotermici all'interno della colonnina e usa il bottone test per controllare la presenza di energia elettrica. Assicurati che tutte le prese siano accese. Se il problema persiste, segnala il guasto nel rapporto di fine turno. [UTENTE] ho verificato tutto ma continua a non funzionare [ASSISTENTE] Ca...
------------------------------------------------------------

ğŸ¤– PROPOSTA LLM:
   Etichetta: 'altro' (confidenza: 0.500)
   Motivazione: Domanda riguardante il cannotaggio non Ã¨ tra le etichette comuni e la risposta del sistema non sembra essere direttamente correlata a un'operazione o informazioni richieste

ğŸ‘¤ DECISIONE:
ğŸ¤– MODALITÃ€ AUTOMATICA ATTIVA
âœ… Usata etichetta clustering: 'altro' (confidenza di default: 0.800)

================================================================================
ğŸ“‹ REVIEW CLUSTER 1
ğŸ·ï¸  Etichetta suggerita: 'altro'
================================================================================

ğŸ“ CONVERSAZIONI RAPPRESENTATIVE (3 esempi):
------------------------------------------------------------

[1] Sessione: 1b8c6808-a49d-49de-84f0-746566dff39f
    Conversazione:
    [UTENTE] Il seroquel Ã¨ uscito dalla dpc? [ASSISTENTE] Un attimo. [ASSISTENTE] SÃ¬, il Seroquel Ã¨ stato escluso dalla Distribuzione per Conto (DPC) e riclassificato come Classe C nella Regione Lazio. Ora Ã¨ sostituibile con l'equivalente vincitore di gara, Quetiapina.
------------------------------------------------------------

[2] Sessione: e9362e7f-302a-4227-992e-282f7ab73cd3
    Conversazione:
    [UTENTE] Controllo piani terapeutici online [ASSISTENTE] Mmmh, ho capito. [ASSISTENTE] Per il controllo dei piani terapeutici online, le farmacie devono utilizzare il sistema SIPSO Web per accedere e gestire i piani terapeutici dei pazienti. Ãˆ importante seguire le procedure stabilite per garantire la corretta gestione e aggiornamento dei dati. [UTENTE] Fatturazione DPC differita al 6 febbraio [ASSISTENTE] Verifico. [ASSISTENTE] La fatturazione DPC per il mese di gennaio Ã¨ stata differita al 6 f...
------------------------------------------------------------

[3] Sessione: cf51db81-a7c0-47b0-a027-a24ed2183389
    Conversazione:
    [UTENTE] vorre i sapere come gestire in DPC l'inderal [ASSISTENTE] Mmmh, capisco. [ASSISTENTE] Per gestire l'Inderal in DPC, Ã¨ necessario utilizzare il farmaco alternativo Sumial 40mg, poichÃ© l'Inderal Ã¨ carente. Le due specialitÃ  sono messe in equivalenza sul portale WEBDPC. Ãˆ consentita l'erogazione di una sola confezione di Sumial per ricetta, e il codice identificativo deve essere apposto sulla ricetta. [UTENTE] ucreas mancante, fuori DPC devo farlo pagare? [ASSISTENTE] Va bene, controllo. [...
------------------------------------------------------------

ğŸ¤– PROPOSTA LLM:
   Etichetta: 'altro' (confidenza: 0.700)
   Motivazione: Domanda sulle informazioni su un farmaco

ğŸ‘¤ DECISIONE:
ğŸ¤– MODALITÃ€ AUTOMATICA ATTIVA
âœ… Usata etichetta clustering: 'altro' (confidenza di default: 0.800)

================================================================================
ğŸ“‹ REVIEW CLUSTER 2
ğŸ·ï¸  Etichetta suggerita: 'altro'
================================================================================

ğŸ“ CONVERSAZIONI RAPPRESENTATIVE (3 esempi):
------------------------------------------------------------

[1] Sessione: 4dc6f6-e09-6b8-ea7-8607c6218
    Conversazione:
    [UTENTE] cosa sai fare [ASSISTENTE] Posso aiutarti a trovare informazioni nei documenti che hai caricato, rispondere a domande sui servizi di Alleanza e fornire supporto su vari argomenti legati alla tua attivitÃ  di farmacista. Fammi sapere come posso assisterti!
------------------------------------------------------------

[2] Sessione: 5659921c-26c0-45e4-be5b-286191ef09cf
    Conversazione:
    [UTENTE] furosemide fa interazione con il warfarin sodico  [ASSISTENTE] Non ho trovato informazioni specifiche sull'interazione tra furosemide e warfarin sodico nei documenti forniti. Ti consiglio di consultare un medico o un farmacista per ulteriori dettagli.
------------------------------------------------------------

[3] Sessione: e81bead1-0663-4310-8ac8-47fcdbcf472b
    Conversazione:
    [UTENTE] cosa dice la distirbuzioen per conto sul seroquel [ASSISTENTE] Non ho trovato informazioni specifiche sulla distribuzione per conto del Seroquel nei documenti forniti. Se hai altre domande o hai bisogno di ulteriori dettagli, fammi sapere! [UTENTE] che informaizoni hai in base di conoscenza? [ASSISTENTE] Non ho informazioni specifiche sulla distribuzione per conto del Seroquel nella mia base di conoscenza. Ti consiglio di consultare documenti ufficiali o contattare direttamente il forni...
------------------------------------------------------------

ğŸ¤– PROPOSTA LLM:
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa
Connessione al database TAG stabilita con successo
Connessione al database TAG chiusa

====================================================================================================
ğŸ¤– LLM DEBUG - CLASSIFICATION | 2025-08-23T03:51:08.878482
====================================================================================================
ğŸ“‹ Session ID: classify_1755921068
â±ï¸  Processing Time: 1.091s
----------------------------------------------------------------------------------------------------
ğŸ“¥ INPUT SECTION
--------------------------------------------------
ğŸ’¬ Original Text (263 chars):
   [UTENTE] cosa sai fare [ASSISTENTE] Posso aiutarti a trovare informazioni nei documenti che hai caricato, rispondere a domande sui servizi di Alleanza e fornire supporto su vari argomenti legati al...

ğŸ¯ Prompt Template:
   
     Line 1: <|system|>
     Line 2: Sei un classificatore esperto per l'ospedale Humanitas con profonda conoscenza del dominio sanitario
     Line 3: 
     ... [59 more lines] ...
     Line 63: 

âš™ï¸  Model Parameters:
   model: mistral:7b
   temperature: 0.1
   max_tokens: 150
   timeout: 300
----------------------------------------------------------------------------------------------------
ğŸ“¤ OUTPUT SECTION
--------------------------------------------------
ğŸ” Raw Response (234 chars):
    {"predicted_label": "info_contatti", "confidence": 0.9, "motivation": "L'utente chiede di essere aiutato a trovare informazioni e il sistema risponde che puÃ² fornire supporto su vari argomenti legati alla sua attivitÃ  di farmacista"}

ğŸ“Š Parsed Response:
   predicted_label: altro
   confidence: 0.7
   motivation: L'utente chiede di essere aiutato a trovare informazioni e il sistema risponde che puÃ² fornire supporto su vari argomenti legati alla sua attivitÃ  di farmacista
----------------------------------------------------------------------------------------------------
ğŸ“ˆ ANALYSIS SECTION
--------------------------------------------------
ğŸ¯ Confidence Score: 0.700
   [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] 70.0%

ğŸ§  Reasoning/Motivation:
   L'utente chiede di essere aiutato a trovare informazioni e il sistema risponde che puÃ² fornire supporto su vari argomenti legati alla sua attivitÃ  di farmacista
----------------------------------------------------------------------------------------------------
ğŸ” CONTEXT & METADATA
--------------------------------------------------
   model_used: mistral:7b
   cache_hit: False
   context_provided: False
   embedding_validation_enabled: True
   client_name: alleanza
----------------------------------------------------------------------------------------------------
âœ… LLM DEBUG COMPLETED
====================================================================================================

   Etichetta: 'altro' (confidenza: 0.700)
   Motivazione: L'utente chiede di essere aiutato a trovare informazioni e il sistema risponde che puÃ² fornire supporto su vari argomenti legati alla sua attivitÃ  di farmacista

ğŸ‘¤ DECISIONE:
ğŸ¤– MODALITÃ€ AUTOMATICA ATTIVA
âœ… Usata etichetta clustering: 'altro' (confidenza di default: 0.800)

âœ… Review interattivo completato
ğŸ” Encoding 18 testi su device cuda...
âœ… Embedding generati: shape (18, 768)
âš ï¸ Insufficienti dati per training ML: 18 campioni, 1 classi
ğŸ”„ Saltando training ML, usando solo LLM per classificazioni future
ğŸ’¾ Salvate informazioni cluster per ottimizzazione futura
--------------------------------------------------
âœ… TRAINING SUPERVISIONATO COMPLETATO!
â±ï¸  Durata: 18.1 secondi
ğŸ“Š Dataset: 18 sessioni totali
ğŸ§© Clustering: 3 cluster su dataset completo
ï¿½ Sessioni selezionate per review: 9
âœ… Training supervisionato completato per alleanza
ğŸ“Š STATISTICHE FINALI:
  ğŸ“ Sessioni riviste: 9/500
  ğŸ§© Cluster inclusi: 3
  ğŸš« Cluster esclusi: 0
ğŸ§¹ Sanitizzazione dati per JSON serialization...
âœ… Dati sanitizzati per JSON
